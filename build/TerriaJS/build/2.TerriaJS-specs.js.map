{"version":3,"sources":["webpack:///./node_modules/terriajs-cesium/Source/Core/CornerType.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositeProperty.js","webpack:///./node_modules/terriajs-cesium/Source/Scene/ColorBlendMode.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositePositionProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/ReferenceProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/ScaledPositionProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PositionPropertyArray.js","webpack:///./node_modules/terriajs-cesium/Source/Core/HermitePolynomialApproximation.js","webpack:///./node_modules/terriajs-cesium/Source/Core/LagrangePolynomialApproximation.js","webpack:///./node_modules/terriajs-cesium/Source/Core/Spherical.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CheckerboardMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositeMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/GridMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineArrowMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineDashMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineOutlineMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PropertyArray.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/Rotation.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/StripeOrientation.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/StripeMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/VelocityVectorProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/VelocityOrientationProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CzmlDataSource.js","webpack:///./node_modules/terriajs-cesium/Source/ThirdParty/Autolinker.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlCamera.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlLookAt.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTour.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTourFlyTo.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTourWait.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlDataSource.js"],"names":["ROUNDED","MITERED","BEVELED","CompositeProperty","this","_eventHelper","_definitionChanged","_intervals","changedEvent","addEventListener","prototype","_intervalsChanged","isConstant","get","isEmpty","definitionChanged","intervals","getValue","time","result","innerProperty","findDataForIntervalContainingDate","equals","other","property","eventHelper","callback","raiseEvent","items","removeAll","length","i","interval","data","indexOf","add","subscribeAll","ColorBlendMode","HIGHLIGHT","REPLACE","MIX","colorBlendMode","colorBlendAmount","clamp","EPSILON4","CompositePositionProperty","referenceFrame","_referenceFrame","FIXED","_composite","_raiseDefinitionChanged","set","value","getValueInReferenceFrame","resolve","that","targetProperty","_targetProperty","targetEntity","_targetEntity","_targetCollection","getById","_targetId","undefined","ReferenceProperty","_onTargetEntityDefinitionChanged","targetPropertyNames","_targetPropertyNames","len","targetCollection","targetId","collectionChanged","_onCollectionChanged","target","resolvedProperty","fromString","referenceString","identifier","values","inIdentifier","isEscaped","token","c","charAt","push","getType","names","otherNames","name","oldValue","collection","added","removed","removeEventListener","ScaledPositionProperty","_value","_removeSubscription","setValue","WGS84","scaleToGeodeticSurface","PositionPropertyArray","Array","x","itemValue","slice","arrayEquals","factorial","calculateCoefficientTerm","zIndices","xTable","derivOrder","termOrder","reservedIndices","reserved","j","splice","HermitePolynomialApproximation","type","degree","inputOrder","defaultValue","Math","max","floor","yTable","yStride","d","s","index","defined","coefficients","l","zIndicesLength","highestNonZeroCoef","nonZeroCoefficients","numerator","zj","zn","tempTerm","coeff","arrayScratch","interpolate","outputOrder","resultLength","r","zIndiceslength","highestNonZero","tmp","dimOne","coefIndex","dimTwo","coefficient","dimTwoMinusOne","fillCoefficientList","loopStop","min","coef","LagrangePolynomialApproximation","diffX","Spherical","clock","cone","magnitude","fromCartesian3","cartesian3","y","z","radialSquared","atan2","sqrt","clone","spherical","normalize","left","right","equalsEpsilon","epsilon","abs","toString","defaultEvenColor","Color","WHITE","defaultOddColor","BLACK","defaultRepeat","Cartesian2","CheckerboardMaterialProperty","options","EMPTY_OBJECT","Event","_evenColor","_evenColorSubscription","_oddColor","_oddColorSubscription","_repeat","_repeatSubscription","evenColor","oddColor","repeat","defineProperties","Property","createPropertyDescriptor","lightColor","getValueOrClonedDefault","darkColor","getValueOrDefault","CompositeMaterialProperty","defaultColor","defaultLineCount","defaultLineOffset","defaultLineThickness","GridMaterialProperty","_color","_colorSubscription","_cellAlpha","_cellAlphaSubscription","_lineCount","_lineCountSubscription","_lineThickness","_lineThicknessSubscription","_lineOffset","_lineOffsetSubscription","color","cellAlpha","lineCount","lineThickness","lineOffset","PolylineArrowMaterialProperty","defaultGapColor","TRANSPARENT","PolylineDashMaterialProperty","_gapColor","_gapColorSubscription","_dashLength","_dashLengthSubscription","_dashPattern","_dashPatternSubscription","gapColor","dashLength","dashPattern","defaultOutlineColor","PolylineOutlineMaterialProperty","_outlineColor","_outlineColorSubscription","_outlineWidth","_outlineWidthSubscription","outlineColor","outlineWidth","PropertyArray","EventHelper","packedLength","pack","array","startingIndex","unpack","convertPackedArrayForInterpolation","packedArray","lastIndex","previousValue","PI","TWO_PI","unpackInterpolationResult","sourceArray","firstIndex","freezeObject","HORIZONTAL","VERTICAL","defaultOrientation","StripeMaterialProperty","_orientation","_orientationSubscription","_offset","_offsetSubscription","orientation","offset","horizontal","VelocityVectorProperty","position","_position","_subscription","_normalize","position1Scratch","Cartesian3","position2Scratch","timeScratch","JulianDate","_getValue","velocityResult","positionResult","ZERO","position1","position2","addSeconds","velocity","subtract","divideByScalar","VelocityOrientationProperty","ellipsoid","_velocityVectorProperty","_ellipsoid","Ellipsoid","positionScratch","velocityScratch","rotationScratch","Matrix3","Transforms","rotationMatrixFromPositionVelocity","Quaternion","fromRotationMatrix","currentId","UnitCartesian3","createReferenceProperty","entityCollection","createSpecializedProperty","packetData","reference","velocityReference","referenceProperty","RuntimeError","JSON","stringify","scratchCartesian","scratchSpherical","scratchCartographic","Cartographic","scratchTimeInterval","TimeInterval","scratchQuaternion","unwrapUriInterval","czmlInterval","sourceUri","uri","getDerivedResource","url","Resource","createIfNeeded","unwrapCartesianInterval","cartesian","cartesianVelocity","unitCartesian","unitSpherical","fromSpherical","convertUnitSphericalToCartesian","convertSphericalToCartesian","cartographicRadians","longitude","latitude","height","cartographicToCartesian","convertCartographicRadiansToCartesian","cartographicDegrees","toRadians","convertCartographicDegreesToCartesian","normalizePackedCartesianArray","normalizePackedQuaternionArray","getPropertyType","Boolean","Number","String","hasOwnProperty","BoundingRectangle","ArcType","ClassificationType","CornerType","HeightReference","HorizontalOrigin","LabelStyle","NearFarScalar","DistanceDisplayCondition","Object","ShadowMode","Rectangle","Uri","VerticalOrigin","unwrapInterval","arcType","boundingRectangle","cartesian2","unwrapUnitCartesianInterval","rgbaf","rgba","byteToFloat","unwrapColorInterval","classificationType","cornerType","heightReference","horizontalOrigin","Image","fromIso8601","date","labelStyle","number","nearFarScalar","distanceDisplayCondition","object","unitQuaternion","unwrapQuaternionInterval","wsen","wsenDegrees","unwrapRectangleInterval","shadowMode","shadows","string","stripeOrientation","verticalOrigin","interpolators","HERMITE","LAGRANGE","LINEAR","LinearApproximation","updateInterpolationSettings","interpolationAlgorithm","interpolationDegree","setInterpolationOptions","forwardExtrapolationType","ExtrapolationType","forwardExtrapolationDuration","backwardExtrapolationType","backwardExtrapolationDuration","iso8601Scratch","iso8601","intervalFromString","intervalString","wrapPropertyInInfiniteInterval","Iso8601","MAXIMUM_INTERVAL","convertPropertyToComposite","composite","addInterval","convertPositionPropertyToComposite","processProperty","propertyName","constrainedInterval","unwrappedInterval","unwrappedIntervalLength","combinedInterval","intersect","isValue","hasInterval","delete","removePropertyData","SampledProperty","removeSamples","TimeIntervalCollectionProperty","removeInterval","intersection","isSampled","needsUnpacking","epoch","packetEpoch","addSamplesPackedArray","ConstantProperty","findInterval","processPacketData","isArray","processPositionProperty","numberOfDerivatives","removePositionPropertyData","SampledPositionProperty","TimeIntervalCollectionPositionProperty","ReferenceFrame","ConstantPositionProperty","processPositionPacketData","processMaterialProperty","existingMaterial","existingInterval","materialData","thisIntervals","start","stop","solidColor","ColorMaterialProperty","grid","image","ImageMaterialProperty","transparent","stripe","polylineOutline","polylineGlow","PolylineGlowMaterialProperty","glowPower","taperPower","polylineArrow","polylineDash","checkerboard","processMaterialPacketData","processReferencesArrayPacketData","references","PropertyArrayType","CompositePropertyArrayType","properties","map","processArrayPacketData","processArray","processPositionArrayPacketData","unpackArray","fromRadiansArrayHeights","fromDegreesArrayHeights","processPositionArray","unpackCartesianArray","unpackCartographicRadiansArray","unpackCartographicDegreesArray","processPositionArrayOfArraysPacketData","referenceArray","tempObj","positions","processNodeTransformations","model","nodeTransformationsData","nodeTransformations","nodeNames","keys","nodeName","nodeTransformationData","PropertyBag","hasProperty","addProperty","nodeTransformation","NodeTransformationProperty","translation","rotation","scale","processArticulations","articulationsData","articulations","key","articulationStageData","PolygonHierarchyProperty","polygon","adaptFollowSurfaceToArcType","followSurface","GEODESIC","NONE","processCzmlPacket","packet","updaterFunctions","dataSource","objectId","id","createGuid","_version","removeById","version","tokens","split","documentPacket","_documentPacket","clockPacket","currentTime","range","step","multiplier","processDocument","entity","getOrCreateEntity","parentId","parent","load","czml","clear","promise","credit","Credit","_credit","fetchJson","resourceCredits","_resourceCredits","credits","DataSource","setLoading","when","_entityCollection","DocumentPacket","CzmlDataSource","_processCzml","raiseChangedEvent","_clock","availability","computeAvailability","MINIMUM_VALUE","startTime","stopTime","totalSeconds","secondsDifference","round","DataSourceClock","clockRange","ClockRange","LOOP_STOP","clockStep","ClockStep","SYSTEM_CLOCK_MULTIPLIER","MAXIMUM_VALUE","updateClock","_name","getFilenameFromUri","getUrlComponent","_changed","loadCzml","otherwise","error","_error","console","log","reject","_isLoading","_loading","EntityCollection","_entityCluster","EntityCluster","_positions","holes","_holes","holePositions","PolygonHierarchy","entities","isLoading","errorEvent","loadingEvent","show","clustering","updaters","billboardData","billboard","BillboardGraphics","pixelOffset","eyeOffset","processAlignedAxis","alignedAxis","sizeInMeters","width","scaleByDistance","translucencyByDistance","pixelOffsetScaleByDistance","imageSubRegion","disableDepthTestDistance","boxData","box","BoxGraphics","dimensions","fill","material","outline","corridorData","corridor","CorridorGraphics","extrudedHeight","extrudedHeightReference","granularity","zIndex","cylinderData","cylinder","CylinderGraphics","topRadius","bottomRadius","numberOfVerticalLines","slices","ellipseData","ellipse","EllipseGraphics","semiMajorAxis","semiMinorAxis","stRotation","ellipsoidData","EllipsoidGraphics","radii","innerRadii","minimumClock","maximumClock","minimumCone","maximumCone","stackPartitions","slicePartitions","subdivisions","labelData","label","LabelGraphics","text","font","style","showBackground","backgroundColor","backgroundPadding","fillColor","modelData","ModelGraphics","gltf","minimumPixelSize","maximumScale","incrementallyLoadTextures","runAnimations","clampAnimations","silhouetteColor","silhouetteSize","nameData","descriptionData","description","pathData","path","PathGraphics","leadTime","trailTime","resolution","pointData","point","PointGraphics","pixelSize","polygonData","PolygonGraphics","processPositionArrayOfArrays","hierarchy","perPositionHeight","closeTop","closeBottom","polylineData","polyline","adapterFunction","PolylineGraphics","depthFailMaterial","clampToGround","CallbackProperty","propertiesData","propertyData","rectangleData","rectangle","RectangleGraphics","coordinates","positionData","viewFromData","viewFrom","wallData","wall","WallGraphics","minimumHeights","maximumHeights","orientationData","TimeIntervalCollection","process","Autolinker","arr","element","remove","fn","throwUnhandledCaseError","theValue","Error","HtmlTag","cfg","tagName","attrs","innerHTML","whitespaceRegex","innerHtml","setTagName","getTagName","setAttr","attrName","attrValue","getAttrs","getAttr","setAttrs","assign","setClass","cssClass","addClass","newClass","classAttr","getClass","classes","newClasses","shift","join","removeClass","removeClasses","idx","hasClass","setInnerHTML","html","setInnerHtml","getInnerHTML","getInnerHtml","toAnchorString","attrsStr","buildAttrsStr","attrsArr","prop","AnchorTagBuilder","newWindow","truncate","className","build","match","createAttrs","processAnchorText","getAnchorText","getAnchorHref","createCssClass","returnClasses","cssClassSuffixes","getCssClassSuffixes","anchorText","doTruncate","truncateLength","truncateLocation","location","truncateLen","ellipsisChars","ellipsisLengthBeforeParsing","ellipsisLength","buildUrl","urlObj","scheme","host","query","fragment","buildSegment","segment","remainingAvailableLength","remainingAvailableLengthHalf","startOffset","ceil","endOffset","end","substr","availableLength","urlSub","parse_url","matchQuery","replace","str","pathAndQuery","truncateSmart","truncateMiddle","substring","ellipsis","truncateEnd","Match","__jsduckDummyDocProp","matchedText","tagBuilder","getMatchedText","setOffset","getOffset","buildTag","extendStatics","b","setPrototypeOf","__proto__","p","__extends","__","constructor","create","__assign","t","n","arguments","call","apply","EmailMatch","_super","_this","email","getEmail","HashtagMatch","serviceName","hashtag","getServiceName","getHashtag","MentionMatch","mention","getMention","PhoneMatch","plusSign","getPhoneNumber","getNumber","UrlMatch","urlMatchType","protocolUrlMatch","protocolRelativeMatch","stripPrefix","www","stripTrailingSlash","decodePercentEncoding","schemePrefixRegex","wwwPrefixRegex","protocolRelativeRegex","protocolPrepended","getUrlMatchType","getUrl","stripProtocolRelativePrefix","stripSchemePrefix","stripWwwPrefix","removeTrailingSlash","removePercentEncoding","preProcessedEntityAnchorText","decodeURIComponent","e","Matcher","letterRe","digitRe","whitespaceRe","quoteRe","controlCharsRe","alphaCharsStr","source","alphaCharsAndMarksStr","decimalNumbersStr","alphaNumericCharsStr","alphaNumericAndMarksCharsStr","ipStr","domainLabelStr","getDomainLabelStr","group","getDomainNameStr","domainNameCharRegex","RegExp","tldRegex","EmailMatcher","localPartCharRegex","strictTldRegex","parseMatches","matches","noCurrentEmailMatch","CurrentEmailMatch","mailtoTransitions","charIdx","state","currentEmailMatch","char","stateNonEmailAddress","stateMailTo","stateLocalPart","stateLocalPartDot","stateAtSign","stateDomainChar","stateDomainHyphen","stateDomainDot","captureMatchIfValidAndReset","beginEmailMatch","test","prevChar","hasMailtoPrefix","resetToNonEmailMatchState","hasDomainDot","newState","emailAddress","emailAddressNormalized","pop","toLowerCase","doesEmailHaveValidTld","UrlMatchValidator","isValid","urlMatch","isValidUriScheme","urlMatchDoesNotHaveProtocolOrDot","urlMatchDoesNotHaveAtLeastOneWordChar","isValidIpAddress","containsMultipleDots","uriSchemeMatch","newRegex","hasFullProtocolRegex","ipRegex","stringBeforeSlash","uriSchemeMatchArr","uriSchemeRegex","uriScheme","hasWordCharAfterProtocolRegex","UrlMatcher","urlSuffixRegex","matcherRegex","wordCharRegExp","_loop_1","matchStr","schemeUrlMatch","wwwUrlMatch","wwwProtocolRelativeMatch","tldProtocolRelativeMatch","this_1","matchHasUnbalancedClosingParen","pos","matchHasInvalidCharAfterTld","foundCommonScheme","find","commonScheme","indexOfSchemeStart","exec","startChar","endChar","numOpenBraces","res","HashtagMatcher","nonWordCharRegex","PhoneMatcher","cleanNumber","before","after","contextClear","testMatch","MentionMatcher","matcherRegexes","parseHtml","_a","onOpenTag","onCloseTag","onText","onComment","onDoctype","noCurrentTag","CurrentTag","currentDataIdx","currentTag","stateData","stateTagOpen","stateEndTagOpen","stateTagName","stateBeforeAttributeName","stateAttributeName","stateAfterAttributeName","stateBeforeAttributeValue","stateAttributeValueDoubleQuoted","stateAttributeValueSingleQuoted","stateAttributeValueUnquoted","stateAfterAttributeValueQuoted","stateSelfClosingStartTag","toUpperCase","resetToDataState","stateCommentStart","stateCommentStartDash","stateComment","stateCommentEndDash","stateCommentEnd","stateCommentEndBang","stateDoctype","startNewTag","isClosing","isOpening","captureTagName","emitTagAndPreviousTextNode","textBeforeTag","startIdx","urls","phone","replaceFn","context","matchers","normalizeUrlsCfg","normalizeStripPrefixCfg","normalizeTruncateCfg","link","textOrHtml","parse","schemeMatches","wwwMatches","tldMatches","dest","src","defaults","POSITIVE_INFINITY","skipTagNames","skipTagsStackCount","textSplit","splitRegex","global","lastIdx","splitAndCapture","currentOffset_1","forEach","splitText","textNodeMatches","parseText","compactMatches","removeUnwantedMatches","sort","a","matchedTextLength","endIdx","removeIdx","m","getMatchers","numMatchers","textMatches","numTextMatches","newHtml","createMatchReturnVal","replaceFnResult","getTagBuilder","matcher","Email","Hashtag","Mention","Phone","Url","factory","headingPitchRoll","headingPitchRange","KmlTour","playlistIndex","playlist","tourStart","tourEnd","entryStart","entryEnd","_activeEntries","cancelAllEntries","activeEntries","entry","playEntry","viewer","cameraOptions","allDone","_playNext","playNext","bind","blocking","play","scene","camera","tour","indx","terminated","addPlaylistEntry","KmlTourFlyTo","duration","flyToMode","view","activeCamera","activeCallback","done","self","getCameraOptions","flyTo","BoundingSphere","flyToBoundingSphere","cancelFlight","complete","easingFunction","EasingFunction","LINEAR_NONE","destination","combine","KmlTourWait","timeout","setTimeout","clearTimeout","parser","MimeTypes","avi","bmp","bz2","chm","css","csv","doc","dvi","eps","flv","gif","gz","htm","ico","jnlp","jpeg","jpg","m3u","m4v","mathml","mid","midi","mov","mp3","mp4","mp4v","mpeg","mpg","odp","ods","odt","ogg","pdf","png","pps","ppt","ps","qt","rdf","rss","rtf","svg","swf","tif","tiff","txt","wav","wma","wmv","xml","zip","detectFromFilename","filename","ext","getExtensionFromUri","DOMParser","autolinker","kmlNamespaces","gxNamespaces","namespaces","kml","gx","atom","kmlgx","concat","featureTypes","Document","Folder","node","processingData","deferredLoading","processFeature","newProcessingData","parentEntity","Placemark","placemark","styleEntity","hasGeometry","childNodes","childNode","item","geometryProcessor","geometryTypes","localName","merge","processPositionGraphics","NetworkLink","networkEntity","sourceResource","uriResolver","queryFirstNode","viewRefreshMode","viewBoundScale","href","queryStringValue","newSourceUri","resolveHref","defaultViewFormat","viewFormat","httpQuery","setQueryParameters","queryToObject","cleanupString","processNetworkLinkQueryString","_camera","_canvas","_lastCameraView","bbox","networkLinkCollection","then","rootElement","newEntities","suspendEvents","newEntity","mergeAvailabilityWithParent","resumeEvents","refreshMode","refreshInterval","queryNumericValue","networkLinkControl","hasNetworkLinkControl","now","networkLinkInfo","cookie","lastUpdated","updating","needsUpdate","cameraUpdateTime","minRefreshPeriod","RefreshMode","expires","diff","oneTimeWarning","_networkLinks","addPromise","GroundOverlay","groundOverlay","geometry","isLatLonQuad","readCoordinates","createDefaultPolygon","latLonBox","west","south","east","north","negativePiToPi","clampToLatitudeRange","rotationRadians","iconNode","getIconHref","w","h","queryColorValue","altitudeMode","PhotoOverlay","processUnsupportedFeature","ScreenOverlay","Tour","queryStringAttribute","playlistNode","entryNode","playlistNodeProcessor","playlistNodeProcessors","kmlTours","DeferredLoading","_dataSource","_deferred","defer","_stack","_promises","_timeoutSet","_used","_started","_timeThreshold","insertNamespaces","firstPart","lastPart","declaration","namespaceMap","xsi","removeDuplicateNamespaces","namespace","startIndex","endIndex","endDeclaration","loadDataUriFromZip","deferred","mimeType","getData","Data64URIWriter","dataUri","embedDataUris","div","elementType","attributeName","baseUri","elements","querySelectorAll","getAttribute","setAttribute","applyBasePath","resource","createEntity","Entity","KmlFeatureData","isExtrudable","gxAltitudeMode","readCoordinate","fromDegrees","digits","parseFloat","isNaN","tuples","textContent","resultIndex","queryNumericAttribute","q","child","namespaceURI","queryNodes","getElementsByTagNameNS","queryChildNodes","resultNode","trim","queryBooleanValue","blob","addNodes","nodes","wait","all","isFirstCall","KmlDataSource","_getTimestamp","_process","_giveUpTime","_nextNode","stack","top","_pop","featureProcessor","colorOptions","maximumRed","red","maximumGreen","green","maximumBlue","blue","parseColorString","isRandom","alpha","parseInt","fromRandom","createDefaultBillboard","createDefaultLabel","LEFT","FILL_AND_OUTLINE","canRefresh","palette","hrefResource","processBillboardIcon","heading","icon","xOffset","yOffset","hotSpotNode","hotSpotX","hotSpotY","hotSpotXUnit","hotSpotYUnit","UNIT_Z","BILLBOARD_SIZE","applyStyle","styleNode","bgColor","textColor","balloonStyle","listItemType","processExternalStyles","styleCollection","fetchXML","styleKml","processStyles","isExternal","styleNodes","styleNodesLength","styleMaps","styleMapsLength","styleMap","pairs","pair","styleUrl","base","promises","styleUrlNodes","getElementsByTagName","styleUrlNodesLength","styleReference","createDropLine","entityPosition","surfacePosition","heightReferenceFromAltitudeMode","CLAMP_TO_GROUND","RELATIVE_TO_GROUND","createPositionPropertyFromAltitudeMode","_pinBuilder","fromColor","YELLOW","_clampToGround","processPathGraphics","processLineStringOrLinearRing","geometryNode","coordinatesNode","extrude","tessellate","canExtrude","polylineGraphics","propertiesLength","createPositionPropertyArrayFromAltitudeMode","addToMultiTrack","times","dropShowProperty","includeEndPoints","addSamples","isStartIncluded","isStopIncluded","scratchDiv","Point","coordinatesString","LineString","LinearRing","Polygon","outerBoundaryIsNode","linearRingNode","innerBoundaryIsNodes","k","Track","coordNodes","angleNodes","timeNodes","MultiTrack","lastStop","lastStopPosition","trackNodes","needDropLine","trackNode","MultiGeometry","childEntity","Model","featureNode","kmlData","placeMark","styleIndex","inlineStyleNode","externalStyle","computeFinalStyle","beginNode","beginDate","endNode","endDate","lessThan","processTimeSpan","whenString","processTimeStamp","visibility","ancestryIsVisible","authorNode","author","linkNode","hreflang","rel","title","address","phoneNumber","snippet","extendedDataNode","dataNodes","dataNode","displayName","extendedData","processExtendedData","background","foreground","isDisplayName","links","toCssColorString","processDescription","processLookAt","processCamera","document","createElement","FlyTo","lookAt","flyto","Wait","SoundCue","processTourUnsupportedNode","AnimatedUpdate","TourControl","lon","lat","altitude","tilt","roll","hpr","HeadingPitchRoll","HeadingPitchRange","PI_OVER_TWO","viewPoint","_unsupportedNode","sFirst","zeroRectangle","scratchCartesian2","scratchCartesian3","canvas","fixLatitude","fixLongitude","queryString","objectToQuery","queryParameters","_mode","SceneMode","MORPHING","centerCartesian","centerCartographic","clientWidth","clientHeight","pickEllipsoid","cartesianToCartographic","center","EPSILON9","newHalfWidth","newHalfHeight","toDegrees","pitch","distance","positionWC","frustum","aspectRatio","horizFov","vertFov","fov","loadKml","documentElement","_DeferredLoading","processFeatureNode","loadKmz","createReader","BlobReader","reader","getEntries","entries","docEntry","docDefer","directory","innerDefer","TextWriter","parseFromString","loadXmlFromZip","close","fetchBlob","DEFAULT","dataToLoad","Blob","magicBlob","size","FileReader","DataView","getUint32","readAsArrayBuffer","isZip","readAsText","readBlobAsText","body","msg","firstChild","nodeValue","innerText","_refresh","PinBuilder","AssociativeArray","direction","directionWC","up","upWC","computeViewRectangle","MAX_VALUE","parentAvailability","childAvailability","refreshEvent","unsupportedNodeEvent","oldName","isMinStart","isMaxStop","Date","setHours","fromDate","changed","entitiesToIgnore","update","networkLinks","cameraViewUpdate","lastCameraView","EPSILON7","newNetworkLinks","networkLink","contains","doUpdate","greaterThan","recurseIgnoreEntities","children","_children","count","newEntityCollection","processedHref","networkLinkEntity","entitiesCopy","entityToRemove","removeChildren","getNetworkLinkUpdateCallback","getTimestamp"],"mappings":"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","file":"2.TerriaJS-specs.js","sourcesContent":["import freezeObject from './freezeObject.js';\n\n    /**\n     * Style options for corners.\n     *\n     * @demo The {@link https://sandcastle.cesium.com/index.html?src=Corridor.html&label=Geometries|Corridor Demo}\n     * demonstrates the three corner types, as used by {@link CorridorGraphics}.\n     *\n     * @exports CornerType\n     */\n    var CornerType = {\n        /**\n         * <img src=\"Images/CornerTypeRounded.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n         *\n         * Corner has a smooth edge.\n         * @type {Number}\n         * @constant\n         */\n        ROUNDED : 0,\n\n        /**\n         * <img src=\"Images/CornerTypeMitered.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n         *\n         * Corner point is the intersection of adjacent edges.\n         * @type {Number}\n         * @constant\n         */\n        MITERED : 1,\n\n        /**\n         * <img src=\"Images/CornerTypeBeveled.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n         *\n         * Corner is clipped.\n         * @type {Number}\n         * @constant\n         */\n        BEVELED : 2\n    };\nexport default freezeObject(CornerType);\n","import defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport EventHelper from '../Core/EventHelper.js';\nimport TimeIntervalCollection from '../Core/TimeIntervalCollection.js';\nimport Property from './Property.js';\n\n    function subscribeAll(property, eventHelper, definitionChanged, intervals) {\n        function callback() {\n            definitionChanged.raiseEvent(property);\n        }\n        var items = [];\n        eventHelper.removeAll();\n        var length = intervals.length;\n        for (var i = 0; i < length; i++) {\n            var interval = intervals.get(i);\n            if (defined(interval.data) && items.indexOf(interval.data) === -1) {\n                eventHelper.add(interval.data.definitionChanged, callback);\n            }\n        }\n    }\n\n    /**\n     * A {@link Property} which is defined by a {@link TimeIntervalCollection}, where the\n     * data property of each {@link TimeInterval} is another Property instance which is\n     * evaluated at the provided time.\n     *\n     * @alias CompositeProperty\n     * @constructor\n     *\n     *\n     * @example\n     * var constantProperty = ...;\n     * var sampledProperty = ...;\n     *\n     * //Create a composite property from two previously defined properties\n     * //where the property is valid on August 1st, 2012 and uses a constant\n     * //property for the first half of the day and a sampled property for the\n     * //remaining half.\n     * var composite = new Cesium.CompositeProperty();\n     * composite.intervals.addInterval(Cesium.TimeInterval.fromIso8601({\n     *     iso8601 : '2012-08-01T00:00:00.00Z/2012-08-01T12:00:00.00Z',\n     *     data : constantProperty\n     * }));\n     * composite.intervals.addInterval(Cesium.TimeInterval.fromIso8601({\n     *     iso8601 : '2012-08-01T12:00:00.00Z/2012-08-02T00:00:00.00Z',\n     *     isStartIncluded : false,\n     *     isStopIncluded : false,\n     *     data : sampledProperty\n     * }));\n     *\n     * @see CompositeMaterialProperty\n     * @see CompositePositionProperty\n     */\n    function CompositeProperty() {\n        this._eventHelper = new EventHelper();\n        this._definitionChanged = new Event();\n        this._intervals = new TimeIntervalCollection();\n        this._intervals.changedEvent.addEventListener(CompositeProperty.prototype._intervalsChanged, this);\n    }\n\n    defineProperties(CompositeProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CompositeProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return this._intervals.isEmpty;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value.\n         * @memberof CompositeProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the interval collection.\n         * @memberof CompositeProperty.prototype\n         *\n         * @type {TimeIntervalCollection}\n         */\n        intervals : {\n            get : function() {\n                return this._intervals;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositeProperty.prototype.getValue = function(time, result) {\n        \n\n        var innerProperty = this._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getValue(time, result);\n        }\n        return undefined;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CompositeProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CompositeProperty && //\n                this._intervals.equals(other._intervals, Property.equals));\n    };\n\n    /**\n     * @private\n     */\n    CompositeProperty.prototype._intervalsChanged = function() {\n        subscribeAll(this, this._eventHelper, this._definitionChanged, this._intervals);\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default CompositeProperty;\n","import freezeObject from '../Core/freezeObject.js';\nimport CesiumMath from '../Core/Math.js';\n\n    /**\n     * Defines different modes for blending between a target color and a primitive's source color.\n     *\n     * HIGHLIGHT multiplies the source color by the target color\n     * REPLACE replaces the source color with the target color\n     * MIX blends the source color and target color together\n     *\n     * @exports ColorBlendMode\n     *\n     * @see Model.colorBlendMode\n     */\n    var ColorBlendMode = {\n        HIGHLIGHT : 0,\n        REPLACE : 1,\n        MIX : 2\n    };\n\n    /**\n     * @private\n     */\n    ColorBlendMode.getColorBlend = function(colorBlendMode, colorBlendAmount) {\n        if (colorBlendMode === ColorBlendMode.HIGHLIGHT) {\n            return 0.0;\n        } else if (colorBlendMode === ColorBlendMode.REPLACE) {\n            return 1.0;\n        } else if (colorBlendMode === ColorBlendMode.MIX) {\n            // The value 0.0 is reserved for highlight, so clamp to just above 0.0.\n            return CesiumMath.clamp(colorBlendAmount, CesiumMath.EPSILON4, 1.0);\n        }\n    };\nexport default freezeObject(ColorBlendMode);\n","import defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport CompositeProperty from './CompositeProperty.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link CompositeProperty} which is also a {@link PositionProperty}.\n     *\n     * @alias CompositePositionProperty\n     * @constructor\n     *\n     * @param {ReferenceFrame} [referenceFrame=ReferenceFrame.FIXED] The reference frame in which the position is defined.\n     */\n    function CompositePositionProperty(referenceFrame) {\n        this._referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n        this._definitionChanged = new Event();\n        this._composite = new CompositeProperty();\n        this._composite.definitionChanged.addEventListener(CompositePositionProperty.prototype._raiseDefinitionChanged, this);\n    }\n\n    defineProperties(CompositePositionProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return this._composite.isConstant;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the interval collection.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {TimeIntervalCollection}\n         */\n        intervals : {\n            get : function() {\n                return this._composite.intervals;\n            }\n        },\n        /**\n         * Gets or sets the reference frame which this position presents itself as.\n         * Each PositionProperty making up this object has it's own reference frame,\n         * so this property merely exposes a \"preferred\" reference frame for clients\n         * to use.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {ReferenceFrame}\n         */\n        referenceFrame : {\n            get : function() {\n                return this._referenceFrame;\n            },\n            set : function(value) {\n                this._referenceFrame = value;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property at the provided time in the fixed frame.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositePositionProperty.prototype.getValue = function(time, result) {\n        return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n    };\n\n    /**\n     * Gets the value of the property at the provided time and in the provided reference frame.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n     * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositePositionProperty.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        \n\n        var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getValueInReferenceFrame(time, referenceFrame, result);\n        }\n        return undefined;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CompositePositionProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CompositePositionProperty && //\n                this._referenceFrame === other._referenceFrame && //\n                this._composite.equals(other._composite, Property.equals));\n    };\n\n    /**\n     * @private\n     */\n    CompositePositionProperty.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default CompositePositionProperty;\n","import defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport Property from './Property.js';\n\n    function resolve(that) {\n        var targetProperty = that._targetProperty;\n\n        if (!defined(targetProperty)) {\n            var targetEntity = that._targetEntity;\n\n            if (!defined(targetEntity)) {\n                targetEntity = that._targetCollection.getById(that._targetId);\n\n                if (!defined(targetEntity)) {\n                    // target entity not found\n                    that._targetEntity = that._targetProperty = undefined;\n                    return;\n                }\n\n                // target entity was found. listen for changes to entity definition\n                targetEntity.definitionChanged.addEventListener(ReferenceProperty.prototype._onTargetEntityDefinitionChanged, that);\n                that._targetEntity = targetEntity;\n            }\n\n            // walk the list of property names and resolve properties\n            var targetPropertyNames = that._targetPropertyNames;\n            targetProperty = that._targetEntity;\n            for (var i = 0, len = targetPropertyNames.length; i < len && defined(targetProperty); ++i) {\n                targetProperty = targetProperty[targetPropertyNames[i]];\n            }\n\n            // target property may or may not be defined, depending on if it was found\n            that._targetProperty = targetProperty;\n        }\n\n        return targetProperty;\n    }\n\n    /**\n     * A {@link Property} which transparently links to another property on a provided object.\n     *\n     * @alias ReferenceProperty\n     * @constructor\n     *\n     * @param {EntityCollection} targetCollection The entity collection which will be used to resolve the reference.\n     * @param {String} targetId The id of the entity which is being referenced.\n     * @param {String[]} targetPropertyNames The names of the property on the target entity which we will use.\n     *\n     * @example\n     * var collection = new Cesium.EntityCollection();\n     *\n     * //Create a new entity and assign a billboard scale.\n     * var object1 = new Cesium.Entity({id:'object1'});\n     * object1.billboard = new Cesium.BillboardGraphics();\n     * object1.billboard.scale = new Cesium.ConstantProperty(2.0);\n     * collection.add(object1);\n     *\n     * //Create a second entity and reference the scale from the first one.\n     * var object2 = new Cesium.Entity({id:'object2'});\n     * object2.model = new Cesium.ModelGraphics();\n     * object2.model.scale = new Cesium.ReferenceProperty(collection, 'object1', ['billboard', 'scale']);\n     * collection.add(object2);\n     *\n     * //Create a third object, but use the fromString helper function.\n     * var object3 = new Cesium.Entity({id:'object3'});\n     * object3.billboard = new Cesium.BillboardGraphics();\n     * object3.billboard.scale = Cesium.ReferenceProperty.fromString(collection, 'object1#billboard.scale');\n     * collection.add(object3);\n     *\n     * //You can refer to an entity with a # or . in id and property names by escaping them.\n     * var object4 = new Cesium.Entity({id:'#object.4'});\n     * object4.billboard = new Cesium.BillboardGraphics();\n     * object4.billboard.scale = new Cesium.ConstantProperty(2.0);\n     * collection.add(object4);\n     *\n     * var object5 = new Cesium.Entity({id:'object5'});\n     * object5.billboard = new Cesium.BillboardGraphics();\n     * object5.billboard.scale = Cesium.ReferenceProperty.fromString(collection, '\\\\#object\\\\.4#billboard.scale');\n     * collection.add(object5);\n     */\n    function ReferenceProperty(targetCollection, targetId, targetPropertyNames) {\n        \n\n        this._targetCollection = targetCollection;\n        this._targetId = targetId;\n        this._targetPropertyNames = targetPropertyNames;\n        this._targetProperty = undefined;\n        this._targetEntity = undefined;\n        this._definitionChanged = new Event();\n\n        targetCollection.collectionChanged.addEventListener(ReferenceProperty.prototype._onCollectionChanged, this);\n    }\n\n    defineProperties(ReferenceProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.\n         * @memberof ReferenceProperty.prototype\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(resolve(this));\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever the referenced property's definition is changed.\n         * @memberof ReferenceProperty.prototype\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the reference frame that the position is defined in.\n         * This property is only valid if the referenced property is a {@link PositionProperty}.\n         * @memberof ReferenceProperty.prototype\n         * @type {ReferenceFrame}\n         * @readonly\n         */\n        referenceFrame : {\n            get : function() {\n                var target = resolve(this);\n                return defined(target) ? target.referenceFrame : undefined;\n            }\n        },\n        /**\n         * Gets the id of the entity being referenced.\n         * @memberof ReferenceProperty.prototype\n         * @type {String}\n         * @readonly\n         */\n        targetId : {\n            get : function() {\n                return this._targetId;\n            }\n        },\n        /**\n         * Gets the collection containing the entity being referenced.\n         * @memberof ReferenceProperty.prototype\n         * @type {EntityCollection}\n         * @readonly\n         */\n        targetCollection : {\n            get : function() {\n                return this._targetCollection;\n            }\n        },\n        /**\n         * Gets the array of property names used to retrieve the referenced property.\n         * @memberof ReferenceProperty.prototype\n         * @type {String[]}\n         * @readonly\n         */\n        targetPropertyNames : {\n            get : function() {\n                return this._targetPropertyNames;\n            }\n        },\n        /**\n         * Gets the resolved instance of the underlying referenced property.\n         * @memberof ReferenceProperty.prototype\n         * @type {Property}\n         * @readonly\n         */\n        resolvedProperty : {\n            get : function() {\n                return resolve(this);\n            }\n        }\n    });\n\n    /**\n     * Creates a new instance given the entity collection that will\n     * be used to resolve it and a string indicating the target entity id and property.\n     * The format of the string is \"objectId#foo.bar\", where # separates the id from\n     * property path and . separates sub-properties.  If the reference identifier or\n     * or any sub-properties contains a # . or \\ they must be escaped.\n     *\n     * @param {EntityCollection} targetCollection\n     * @param {String} referenceString\n     * @returns {ReferenceProperty} A new instance of ReferenceProperty.\n     *\n     * @exception {DeveloperError} invalid referenceString.\n     */\n    ReferenceProperty.fromString = function(targetCollection, referenceString) {\n        \n\n        var identifier;\n        var values = [];\n\n        var inIdentifier = true;\n        var isEscaped = false;\n        var token = '';\n        for (var i = 0; i < referenceString.length; ++i) {\n            var c = referenceString.charAt(i);\n\n            if (isEscaped) {\n                token += c;\n                isEscaped = false;\n            } else if (c === '\\\\') {\n                isEscaped = true;\n            } else if (inIdentifier && c === '#') {\n                identifier = token;\n                inIdentifier = false;\n                token = '';\n            } else if (!inIdentifier && c === '.') {\n                values.push(token);\n                token = '';\n            } else {\n                token += c;\n            }\n        }\n        values.push(token);\n\n        return new ReferenceProperty(targetCollection, identifier, values);\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    ReferenceProperty.prototype.getValue = function(time, result) {\n        var target = resolve(this);\n        return defined(target) ? target.getValue(time, result) : undefined;\n    };\n\n    /**\n     * Gets the value of the property at the provided time and in the provided reference frame.\n     * This method is only valid if the property being referenced is a {@link PositionProperty}.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n     * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    ReferenceProperty.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        var target = resolve(this);\n        return defined(target) ? target.getValueInReferenceFrame(time, referenceFrame, result) : undefined;\n    };\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     * This method is only valid if the property being referenced is a {@link MaterialProperty}.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    ReferenceProperty.prototype.getType = function(time) {\n        var target = resolve(this);\n        return defined(target) ? target.getType(time) : undefined;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    ReferenceProperty.prototype.equals = function(other) {\n        if (this === other) {\n            return true;\n        }\n\n        var names = this._targetPropertyNames;\n        var otherNames = other._targetPropertyNames;\n\n        if (this._targetCollection !== other._targetCollection || //\n            this._targetId !== other._targetId || //\n            names.length !== otherNames.length) {\n            return false;\n        }\n\n        var length = this._targetPropertyNames.length;\n        for (var i = 0; i < length; i++) {\n            if (names[i] !== otherNames[i]) {\n                return false;\n            }\n        }\n\n        return true;\n    };\n\n    ReferenceProperty.prototype._onTargetEntityDefinitionChanged = function(targetEntity, name, value, oldValue) {\n        if (defined(this._targetProperty) && this._targetPropertyNames[0] === name) {\n            this._targetProperty = undefined;\n            this._definitionChanged.raiseEvent(this);\n        }\n    };\n\n    ReferenceProperty.prototype._onCollectionChanged = function(collection, added, removed) {\n        var targetEntity = this._targetEntity;\n        if (defined(targetEntity) && removed.indexOf(targetEntity) !== -1) {\n            targetEntity.definitionChanged.removeEventListener(ReferenceProperty.prototype._onTargetEntityDefinitionChanged, this);\n            this._targetEntity = this._targetProperty = undefined;\n        } else if (!defined(targetEntity)) {\n            targetEntity = resolve(this);\n            if (defined(targetEntity)) {\n                this._definitionChanged.raiseEvent(this);\n            }\n        }\n    };\nexport default ReferenceProperty;\n","import defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport Property from './Property.js';\n\n    /**\n     * This is a temporary class for scaling position properties to the WGS84 surface.\n     * It will go away or be refactored to support data with arbitrary height references.\n     * @private\n     */\n    function ScaledPositionProperty(value) {\n        this._definitionChanged = new Event();\n        this._value = undefined;\n        this._removeSubscription = undefined;\n        this.setValue(value);\n    }\n\n    defineProperties(ScaledPositionProperty.prototype, {\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._value);\n            }\n        },\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        referenceFrame : {\n            get : function() {\n                return defined(this._value) ? this._value.referenceFrame : ReferenceFrame.FIXED;\n            }\n        }\n    });\n\n    ScaledPositionProperty.prototype.getValue = function(time, result) {\n        return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n    };\n\n    ScaledPositionProperty.prototype.setValue = function(value) {\n        if (this._value !== value) {\n            this._value = value;\n\n            if (defined(this._removeSubscription)) {\n                this._removeSubscription();\n                this._removeSubscription = undefined;\n            }\n\n            if (defined(value)) {\n                this._removeSubscription = value.definitionChanged.addEventListener(this._raiseDefinitionChanged, this);\n            }\n            this._definitionChanged.raiseEvent(this);\n        }\n    };\n\n    ScaledPositionProperty.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        \n\n        if (!defined(this._value)) {\n            return undefined;\n        }\n\n        result = this._value.getValueInReferenceFrame(time, referenceFrame, result);\n        return defined(result) ? Ellipsoid.WGS84.scaleToGeodeticSurface(result, result) : undefined;\n    };\n\n    ScaledPositionProperty.prototype.equals = function(other) {\n        return this === other || (other instanceof ScaledPositionProperty && this._value === other._value);\n    };\n\n    ScaledPositionProperty.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default ScaledPositionProperty;\n","import defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport EventHelper from '../Core/EventHelper.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link PositionProperty} whose value is an array whose items are the computed value\n     * of other PositionProperty instances.\n     *\n     * @alias PositionPropertyArray\n     * @constructor\n     *\n     * @param {Property[]} [value] An array of Property instances.\n     * @param {ReferenceFrame} [referenceFrame=ReferenceFrame.FIXED] The reference frame in which the position is defined.\n     */\n    function PositionPropertyArray(value, referenceFrame) {\n        this._value = undefined;\n        this._definitionChanged = new Event();\n        this._eventHelper = new EventHelper();\n        this._referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n        this.setValue(value);\n    }\n\n    defineProperties(PositionPropertyArray.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  This property\n         * is considered constant if all property items in the array are constant.\n         * @memberof PositionPropertyArray.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                var value = this._value;\n                if (!defined(value)) {\n                    return true;\n                }\n\n                var length = value.length;\n                for (var i = 0; i < length; i++) {\n                    if (!Property.isConstant(value[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value or one of the properties in the array also changes.\n         * @memberof PositionPropertyArray.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the reference frame in which the position is defined.\n         * @memberof PositionPropertyArray.prototype\n         * @type {ReferenceFrame}\n         * @default ReferenceFrame.FIXED;\n         */\n        referenceFrame : {\n            get : function() {\n                return this._referenceFrame;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Cartesian3[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3[]} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PositionPropertyArray.prototype.getValue = function(time, result) {\n        return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n    };\n\n    /**\n     * Gets the value of the property at the provided time and in the provided reference frame.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n     * @param {Cartesian3[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3[]} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PositionPropertyArray.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        \n\n        var value = this._value;\n        if (!defined(value)) {\n            return undefined;\n        }\n\n        var length = value.length;\n        if (!defined(result)) {\n            result = new Array(length);\n        }\n        var i = 0;\n        var x = 0;\n        while (i < length) {\n            var property = value[i];\n            var itemValue = property.getValueInReferenceFrame(time, referenceFrame, result[i]);\n            if (defined(itemValue)) {\n                result[x] = itemValue;\n                x++;\n            }\n            i++;\n        }\n        result.length = x;\n        return result;\n    };\n\n    /**\n     * Sets the value of the property.\n     *\n     * @param {Property[]} value An array of Property instances.\n     */\n    PositionPropertyArray.prototype.setValue = function(value) {\n        var eventHelper = this._eventHelper;\n        eventHelper.removeAll();\n\n        if (defined(value)) {\n            this._value = value.slice();\n            var length = value.length;\n            for (var i = 0; i < length; i++) {\n                var property = value[i];\n                if (defined(property)) {\n                    eventHelper.add(property.definitionChanged, PositionPropertyArray.prototype._raiseDefinitionChanged, this);\n                }\n            }\n        } else {\n            this._value = undefined;\n        }\n        this._definitionChanged.raiseEvent(this);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PositionPropertyArray.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PositionPropertyArray && //\n                this._referenceFrame === other._referenceFrame && //\n                Property.arrayEquals(this._value, other._value));\n    };\n\n    PositionPropertyArray.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default PositionPropertyArray;\n","import defaultValue from './defaultValue.js';\nimport defined from './defined.js';\nimport DeveloperError from './DeveloperError.js';\nimport CesiumMath from './Math.js';\n\n    var factorial = CesiumMath.factorial;\n\n    function calculateCoefficientTerm(x, zIndices, xTable, derivOrder, termOrder, reservedIndices) {\n        var result = 0;\n        var reserved;\n        var i;\n        var j;\n\n        if (derivOrder > 0) {\n            for (i = 0; i < termOrder; i++) {\n                reserved = false;\n                for (j = 0; j < reservedIndices.length && !reserved; j++) {\n                    if (i === reservedIndices[j]) {\n                        reserved = true;\n                    }\n                }\n\n                if (!reserved) {\n                    reservedIndices.push(i);\n                    result += calculateCoefficientTerm(x, zIndices, xTable, derivOrder - 1, termOrder, reservedIndices);\n                    reservedIndices.splice(reservedIndices.length - 1, 1);\n                }\n            }\n\n            return result;\n        }\n\n        result = 1;\n        for (i = 0; i < termOrder; i++) {\n            reserved = false;\n            for (j = 0; j < reservedIndices.length && !reserved; j++) {\n                if (i === reservedIndices[j]) {\n                    reserved = true;\n                }\n            }\n\n            if (!reserved) {\n                result *= x - xTable[zIndices[i]];\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * An {@link InterpolationAlgorithm} for performing Hermite interpolation.\n     *\n     * @exports HermitePolynomialApproximation\n     */\n    var HermitePolynomialApproximation = {\n        type : 'Hermite'\n    };\n\n    /**\n     * Given the desired degree, returns the number of data points required for interpolation.\n     *\n     * @param {Number} degree The desired degree of interpolation.\n     * @param {Number} [inputOrder=0]  The order of the inputs (0 means just the data, 1 means the data and its derivative, etc).\n     * @returns {Number} The number of required data points needed for the desired degree of interpolation.\n     * @exception {DeveloperError} degree must be 0 or greater.\n     * @exception {DeveloperError} inputOrder must be 0 or greater.\n     */\n    HermitePolynomialApproximation.getRequiredDataPoints = function(degree, inputOrder) {\n        inputOrder = defaultValue(inputOrder, 0);\n\n        \n\n        return Math.max(Math.floor((degree + 1) / (inputOrder + 1)), 2);\n    };\n\n    /**\n     * Interpolates values using Hermite Polynomial Approximation.\n     *\n     * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n     * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n     * in this array must be in increasing order and the same value must not occur twice in the array.\n     * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n     * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n     * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n     * each independent variable value in xTable.\n     * @param {Number[]} [result] An existing array into which to store the result.\n     * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n     */\n    HermitePolynomialApproximation.interpolateOrderZero = function(x, xTable, yTable, yStride, result) {\n        if (!defined(result)) {\n            result = new Array(yStride);\n        }\n\n        var i;\n        var j;\n        var d;\n        var s;\n        var len;\n        var index;\n        var length = xTable.length;\n        var coefficients = new Array(yStride);\n\n        for (i = 0; i < yStride; i++) {\n            result[i] = 0;\n\n            var l = new Array(length);\n            coefficients[i] = l;\n            for (j = 0; j < length; j++) {\n                l[j] = [];\n            }\n        }\n\n        var zIndicesLength = length, zIndices = new Array(zIndicesLength);\n\n        for (i = 0; i < zIndicesLength; i++) {\n            zIndices[i] = i;\n        }\n\n        var highestNonZeroCoef = length - 1;\n        for (s = 0; s < yStride; s++) {\n            for (j = 0; j < zIndicesLength; j++) {\n                index = zIndices[j] * yStride + s;\n                coefficients[s][0].push(yTable[index]);\n            }\n\n            for (i = 1; i < zIndicesLength; i++) {\n                var nonZeroCoefficients = false;\n                for (j = 0; j < zIndicesLength - i; j++) {\n                    var zj = xTable[zIndices[j]];\n                    var zn = xTable[zIndices[j + i]];\n\n                    var numerator;\n                    if (zn - zj <= 0) {\n                        index = zIndices[j] * yStride + yStride * i + s;\n                        numerator = yTable[index];\n                        coefficients[s][i].push(numerator / factorial(i));\n                    } else {\n                        numerator = (coefficients[s][i - 1][j + 1] - coefficients[s][i - 1][j]);\n                        coefficients[s][i].push(numerator / (zn - zj));\n                    }\n                    nonZeroCoefficients = nonZeroCoefficients || (numerator !== 0);\n                }\n\n                if (!nonZeroCoefficients) {\n                    highestNonZeroCoef = i - 1;\n                }\n            }\n        }\n\n        for (d = 0, len = 0; d <= len; d++) {\n            for (i = d; i <= highestNonZeroCoef; i++) {\n                var tempTerm = calculateCoefficientTerm(x, zIndices, xTable, d, i, []);\n                for (s = 0; s < yStride; s++) {\n                    var coeff = coefficients[s][i][0];\n                    result[s + d * yStride] += coeff * tempTerm;\n                }\n            }\n        }\n\n        return result;\n    };\n\n    var arrayScratch = [];\n\n    /**\n     * Interpolates values using Hermite Polynomial Approximation.\n     *\n     * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n     * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n     * in this array must be in increasing order and the same value must not occur twice in the array.\n     * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n     * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n     * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n     * each independent variable value in xTable.\n     * @param {Number} inputOrder The number of derivatives supplied for input.\n     * @param {Number} outputOrder The number of derivatives desired for output.\n     * @param {Number[]} [result] An existing array into which to store the result.\n     *\n     * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n     */\n    HermitePolynomialApproximation.interpolate = function(x, xTable, yTable, yStride, inputOrder, outputOrder, result) {\n        var resultLength = yStride * (outputOrder + 1);\n        if (!defined(result)) {\n            result = new Array(resultLength);\n        }\n        for (var r = 0; r < resultLength; r++) {\n            result[r] = 0;\n        }\n\n        var length = xTable.length;\n        // The zIndices array holds copies of the addresses of the xTable values\n        // in the range we're looking at. Even though this just holds information already\n        // available in xTable this is a much more convenient format.\n        var zIndices = new Array(length * (inputOrder + 1));\n        var i;\n        for (i = 0; i < length; i++) {\n            for (var j = 0; j < (inputOrder + 1); j++) {\n                zIndices[i * (inputOrder + 1) + j] = i;\n            }\n        }\n\n        var zIndiceslength = zIndices.length;\n        var coefficients = arrayScratch;\n        var highestNonZeroCoef = fillCoefficientList(coefficients, zIndices, xTable, yTable, yStride, inputOrder);\n        var reservedIndices = [];\n\n        var tmp = zIndiceslength * (zIndiceslength + 1) / 2;\n        var loopStop = Math.min(highestNonZeroCoef, outputOrder);\n        for (var d = 0; d <= loopStop; d++) {\n            for (i = d; i <= highestNonZeroCoef; i++) {\n                reservedIndices.length = 0;\n                var tempTerm = calculateCoefficientTerm(x, zIndices, xTable, d, i, reservedIndices);\n                var dimTwo = Math.floor(i * (1 - i) / 2) + (zIndiceslength * i);\n\n                for (var s = 0; s < yStride; s++) {\n                    var dimOne = Math.floor(s * tmp);\n                    var coef = coefficients[dimOne + dimTwo];\n                    result[s + d * yStride] += coef * tempTerm;\n                }\n            }\n        }\n\n        return result;\n    };\n\n    function fillCoefficientList(coefficients, zIndices, xTable, yTable, yStride, inputOrder) {\n        var j;\n        var index;\n        var highestNonZero = -1;\n        var zIndiceslength = zIndices.length;\n        var tmp = zIndiceslength * (zIndiceslength + 1) / 2;\n\n        for (var s = 0; s < yStride; s++) {\n            var dimOne = Math.floor(s * tmp);\n\n            for (j = 0; j < zIndiceslength; j++) {\n                index = zIndices[j] * yStride * (inputOrder + 1) + s;\n                coefficients[dimOne + j] = yTable[index];\n            }\n\n            for (var i = 1; i < zIndiceslength; i++) {\n                var coefIndex = 0;\n                var dimTwo = Math.floor(i * (1 - i) / 2) + (zIndiceslength * i);\n                var nonZeroCoefficients = false;\n\n                for (j = 0; j < zIndiceslength - i; j++) {\n                    var zj = xTable[zIndices[j]];\n                    var zn = xTable[zIndices[j + i]];\n\n                    var numerator;\n                    var coefficient;\n                    if (zn - zj <= 0) {\n                        index = zIndices[j] * yStride * (inputOrder + 1) + yStride * i + s;\n                        numerator = yTable[index];\n                        coefficient = (numerator / CesiumMath.factorial(i));\n                        coefficients[dimOne + dimTwo + coefIndex] = coefficient;\n                        coefIndex++;\n                    } else {\n                        var dimTwoMinusOne = Math.floor((i - 1) * (2 - i) / 2) + (zIndiceslength * (i - 1));\n                        numerator = coefficients[dimOne + dimTwoMinusOne + j + 1] - coefficients[dimOne + dimTwoMinusOne + j];\n                        coefficient = (numerator / (zn - zj));\n                        coefficients[dimOne + dimTwo + coefIndex] = coefficient;\n                        coefIndex++;\n                    }\n                    nonZeroCoefficients = nonZeroCoefficients || (numerator !== 0.0);\n                }\n\n                if (nonZeroCoefficients) {\n                    highestNonZero = Math.max(highestNonZero, i);\n                }\n            }\n        }\n\n        return highestNonZero;\n    }\nexport default HermitePolynomialApproximation;\n","import defined from './defined.js';\n\n    /**\n     * An {@link InterpolationAlgorithm} for performing Lagrange interpolation.\n     *\n     * @exports LagrangePolynomialApproximation\n     */\n    var LagrangePolynomialApproximation = {\n        type : 'Lagrange'\n    };\n\n    /**\n     * Given the desired degree, returns the number of data points required for interpolation.\n     *\n     * @param {Number} degree The desired degree of interpolation.\n     * @returns {Number} The number of required data points needed for the desired degree of interpolation.\n     */\n    LagrangePolynomialApproximation.getRequiredDataPoints = function(degree) {\n        return Math.max(degree + 1.0, 2);\n    };\n\n    /**\n     * Interpolates values using Lagrange Polynomial Approximation.\n     *\n     * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n     * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n     * in this array must be in increasing order and the same value must not occur twice in the array.\n     * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n     * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n     * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n     * each independent variable value in xTable.\n     * @param {Number[]} [result] An existing array into which to store the result.\n     * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n     */\n    LagrangePolynomialApproximation.interpolateOrderZero = function(x, xTable, yTable, yStride, result) {\n        if (!defined(result)) {\n            result = new Array(yStride);\n        }\n\n        var i;\n        var j;\n        var length = xTable.length;\n\n        for (i = 0; i < yStride; i++) {\n            result[i] = 0;\n        }\n\n        for (i = 0; i < length; i++) {\n            var coefficient = 1;\n\n            for (j = 0; j < length; j++) {\n                if (j !== i) {\n                    var diffX = xTable[i] - xTable[j];\n                    coefficient *= (x - xTable[j]) / diffX;\n                }\n            }\n\n            for (j = 0; j < yStride; j++) {\n                result[j] += coefficient * yTable[i * yStride + j];\n            }\n        }\n\n        return result;\n    };\nexport default LagrangePolynomialApproximation;\n","import Check from './Check.js';\nimport defaultValue from './defaultValue.js';\nimport defined from './defined.js';\n\n    /**\n     * A set of curvilinear 3-dimensional coordinates.\n     *\n     * @alias Spherical\n     * @constructor\n     *\n     * @param {Number} [clock=0.0] The angular coordinate lying in the xy-plane measured from the positive x-axis and toward the positive y-axis.\n     * @param {Number} [cone=0.0] The angular coordinate measured from the positive z-axis and toward the negative z-axis.\n     * @param {Number} [magnitude=1.0] The linear coordinate measured from the origin.\n     */\n    function Spherical(clock, cone, magnitude) {\n        /**\n         * The clock component.\n         * @type {Number}\n         * @default 0.0\n         */\n        this.clock = defaultValue(clock, 0.0);\n        /**\n         * The cone component.\n         * @type {Number}\n         * @default 0.0\n         */\n        this.cone = defaultValue(cone, 0.0);\n        /**\n         * The magnitude component.\n         * @type {Number}\n         * @default 1.0\n         */\n        this.magnitude = defaultValue(magnitude, 1.0);\n    }\n\n    /**\n     * Converts the provided Cartesian3 into Spherical coordinates.\n     *\n     * @param {Cartesian3} cartesian3 The Cartesian3 to be converted to Spherical.\n     * @param {Spherical} [result] The object in which the result will be stored, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter, or a new instance if one was not provided.\n     */\n    Spherical.fromCartesian3 = function(cartesian3, result) {\n        \n\n        var x = cartesian3.x;\n        var y = cartesian3.y;\n        var z = cartesian3.z;\n        var radialSquared = x * x + y * y;\n\n        if (!defined(result)) {\n            result = new Spherical();\n        }\n\n        result.clock = Math.atan2(y, x);\n        result.cone = Math.atan2(Math.sqrt(radialSquared), z);\n        result.magnitude = Math.sqrt(radialSquared + z * z);\n        return result;\n    };\n\n    /**\n     * Creates a duplicate of a Spherical.\n     *\n     * @param {Spherical} spherical The spherical to clone.\n     * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter or a new instance if result was undefined. (Returns undefined if spherical is undefined)\n     */\n    Spherical.clone = function(spherical, result) {\n        if (!defined(spherical)) {\n            return undefined;\n        }\n\n        if (!defined(result)) {\n            return new Spherical(spherical.clock, spherical.cone, spherical.magnitude);\n        }\n\n        result.clock = spherical.clock;\n        result.cone = spherical.cone;\n        result.magnitude = spherical.magnitude;\n        return result;\n    };\n\n    /**\n     * Computes the normalized version of the provided spherical.\n     *\n     * @param {Spherical} spherical The spherical to be normalized.\n     * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter or a new instance if result was undefined.\n     */\n    Spherical.normalize = function(spherical, result) {\n      \n\n        if (!defined(result)) {\n            return new Spherical(spherical.clock, spherical.cone, 1.0);\n        }\n\n        result.clock = spherical.clock;\n        result.cone = spherical.cone;\n        result.magnitude = 1.0;\n        return result;\n    };\n\n    /**\n     * Returns true if the first spherical is equal to the second spherical, false otherwise.\n     *\n     * @param {Spherical} left The first Spherical to be compared.\n     * @param {Spherical} right The second Spherical to be compared.\n     * @returns {Boolean} true if the first spherical is equal to the second spherical, false otherwise.\n     */\n    Spherical.equals = function(left, right) {\n        return (left === right) ||\n               ((defined(left)) &&\n                (defined(right)) &&\n                (left.clock === right.clock) &&\n                (left.cone === right.cone) &&\n                (left.magnitude === right.magnitude));\n    };\n\n    /**\n     * Returns true if the first spherical is within the provided epsilon of the second spherical, false otherwise.\n     *\n     * @param {Spherical} left The first Spherical to be compared.\n     * @param {Spherical} right The second Spherical to be compared.\n     * @param {Number} [epsilon=0.0] The epsilon to compare against.\n     * @returns {Boolean} true if the first spherical is within the provided epsilon of the second spherical, false otherwise.\n     */\n    Spherical.equalsEpsilon = function(left, right, epsilon) {\n        epsilon = defaultValue(epsilon, 0.0);\n        return (left === right) ||\n               ((defined(left)) &&\n                (defined(right)) &&\n                (Math.abs(left.clock - right.clock) <= epsilon) &&\n                (Math.abs(left.cone - right.cone) <= epsilon) &&\n                (Math.abs(left.magnitude - right.magnitude) <= epsilon));\n    };\n\n    /**\n     * Returns true if this spherical is equal to the provided spherical, false otherwise.\n     *\n     * @param {Spherical} other The Spherical to be compared.\n     * @returns {Boolean} true if this spherical is equal to the provided spherical, false otherwise.\n     */\n    Spherical.prototype.equals = function(other) {\n        return Spherical.equals(this, other);\n    };\n\n    /**\n     * Creates a duplicate of this Spherical.\n     *\n     * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter or a new instance if result was undefined.\n     */\n    Spherical.prototype.clone = function(result) {\n        return Spherical.clone(this, result);\n    };\n\n    /**\n    * Returns true if this spherical is within the provided epsilon of the provided spherical, false otherwise.\n    *\n    * @param {Spherical} other The Spherical to be compared.\n    * @param {Number} epsilon The epsilon to compare against.\n    * @returns {Boolean} true if this spherical is within the provided epsilon of the provided spherical, false otherwise.\n    */\n    Spherical.prototype.equalsEpsilon = function(other, epsilon) {\n        return Spherical.equalsEpsilon(this, other, epsilon);\n    };\n\n    /**\n    * Returns a string representing this instance in the format (clock, cone, magnitude).\n    *\n    * @returns {String} A string representing this instance.\n    */\n    Spherical.prototype.toString = function() {\n        return '(' + this.clock + ', ' + this.cone + ', ' + this.magnitude + ')';\n    };\nexport default Spherical;\n","import Cartesian2 from '../Core/Cartesian2.js';\nimport Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultEvenColor = Color.WHITE;\n    var defaultOddColor = Color.BLACK;\n    var defaultRepeat = new Cartesian2(2.0, 2.0);\n\n    /**\n     * A {@link MaterialProperty} that maps to checkerboard {@link Material} uniforms.\n     * @alias CheckerboardMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.evenColor=Color.WHITE] A Property specifying the first {@link Color}.\n     * @param {Property} [options.oddColor=Color.BLACK] A Property specifying the second {@link Color}.\n     * @param {Property} [options.repeat=new Cartesian2(2.0, 2.0)] A {@link Cartesian2} Property specifying how many times the tiles repeat in each direction.\n     */\n    function CheckerboardMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._evenColor = undefined;\n        this._evenColorSubscription = undefined;\n        this._oddColor = undefined;\n        this._oddColorSubscription = undefined;\n        this._repeat = undefined;\n        this._repeatSubscription = undefined;\n\n        this.evenColor = options.evenColor;\n        this.oddColor = options.oddColor;\n        this.repeat = options.repeat;\n    }\n\n    defineProperties(CheckerboardMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CheckerboardMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._evenColor) && //\n                       Property.isConstant(this._oddColor) && //\n                       Property.isConstant(this._repeat);\n            }\n        },\n\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof CheckerboardMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n\n        /**\n         * Gets or sets the Property specifying the first {@link Color}.\n         * @memberof CheckerboardMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        evenColor : createPropertyDescriptor('evenColor'),\n\n        /**\n         * Gets or sets the Property specifying the second {@link Color}.\n         * @memberof CheckerboardMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.BLACK\n         */\n        oddColor : createPropertyDescriptor('oddColor'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying how many times the tiles repeat in each direction.\n         * @memberof CheckerboardMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(2.0, 2.0)\n         */\n        repeat : createPropertyDescriptor('repeat')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    CheckerboardMaterialProperty.prototype.getType = function(time) {\n        return 'Checkerboard';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CheckerboardMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.lightColor = Property.getValueOrClonedDefault(this._evenColor, time, defaultEvenColor, result.lightColor);\n        result.darkColor = Property.getValueOrClonedDefault(this._oddColor, time, defaultOddColor, result.darkColor);\n        result.repeat = Property.getValueOrDefault(this._repeat, time, defaultRepeat);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CheckerboardMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CheckerboardMaterialProperty && //\n                       Property.equals(this._evenColor, other._evenColor) && //\n                       Property.equals(this._oddColor, other._oddColor) && //\n                       Property.equals(this._repeat, other._repeat));\n    };\nexport default CheckerboardMaterialProperty;\n","import defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport CompositeProperty from './CompositeProperty.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link CompositeProperty} which is also a {@link MaterialProperty}.\n     *\n     * @alias CompositeMaterialProperty\n     * @constructor\n     */\n    function CompositeMaterialProperty() {\n        this._definitionChanged = new Event();\n        this._composite = new CompositeProperty();\n        this._composite.definitionChanged.addEventListener(CompositeMaterialProperty.prototype._raiseDefinitionChanged, this);\n    }\n\n    defineProperties(CompositeMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CompositeMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return this._composite.isConstant;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value.\n         * @memberof CompositeMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the interval collection.\n         * @memberof CompositeMaterialProperty.prototype\n         *\n         * @type {TimeIntervalCollection}\n         */\n        intervals : {\n            get : function() {\n                return this._composite._intervals;\n            }\n        }\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    CompositeMaterialProperty.prototype.getType = function(time) {\n        \n\n        var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getType(time);\n        }\n        return undefined;\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositeMaterialProperty.prototype.getValue = function(time, result) {\n        \n\n        var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getValue(time, result);\n        }\n        return undefined;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CompositeMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CompositeMaterialProperty && //\n                this._composite.equals(other._composite, Property.equals));\n    };\n\n    /**\n     * @private\n     */\n    CompositeMaterialProperty.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default CompositeMaterialProperty;\n","import Cartesian2 from '../Core/Cartesian2.js';\nimport Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultColor = Color.WHITE;\n    var defaultCellAlpha = 0.1;\n    var defaultLineCount = new Cartesian2(8, 8);\n    var defaultLineOffset = new Cartesian2(0, 0);\n    var defaultLineThickness = new Cartesian2(1, 1);\n\n    /**\n     * A {@link MaterialProperty} that maps to grid {@link Material} uniforms.\n     * @alias GridMaterialProperty\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.color=Color.WHITE] A Property specifying the grid {@link Color}.\n     * @param {Property} [options.cellAlpha=0.1] A numeric Property specifying cell alpha values.\n     * @param {Property} [options.lineCount=new Cartesian2(8, 8)] A {@link Cartesian2} Property specifying the number of grid lines along each axis.\n     * @param {Property} [options.lineThickness=new Cartesian2(1.0, 1.0)] A {@link Cartesian2} Property specifying the thickness of grid lines along each axis.\n     * @param {Property} [options.lineOffset=new Cartesian2(0.0, 0.0)] A {@link Cartesian2} Property specifying starting offset of grid lines along each axis.\n     *\n     * @constructor\n     */\n    function GridMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n        this._cellAlpha = undefined;\n        this._cellAlphaSubscription = undefined;\n        this._lineCount = undefined;\n        this._lineCountSubscription = undefined;\n        this._lineThickness = undefined;\n        this._lineThicknessSubscription = undefined;\n        this._lineOffset = undefined;\n        this._lineOffsetSubscription = undefined;\n\n        this.color = options.color;\n        this.cellAlpha = options.cellAlpha;\n        this.lineCount = options.lineCount;\n        this.lineThickness = options.lineThickness;\n        this.lineOffset = options.lineOffset;\n    }\n\n    defineProperties(GridMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof GridMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._color) &&\n                       Property.isConstant(this._cellAlpha) &&\n                       Property.isConstant(this._lineCount) &&\n                       Property.isConstant(this._lineThickness) &&\n                       Property.isConstant(this._lineOffset);\n            }\n        },\n\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof GridMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n\n        /**\n         * Gets or sets the Property specifying the grid {@link Color}.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        color : createPropertyDescriptor('color'),\n\n        /**\n         * Gets or sets the numeric Property specifying cell alpha values.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default 0.1\n         */\n        cellAlpha : createPropertyDescriptor('cellAlpha'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying the number of grid lines along each axis.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(8.0, 8.0)\n         */\n        lineCount : createPropertyDescriptor('lineCount'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying the thickness of grid lines along each axis.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(1.0, 1.0)\n         */\n        lineThickness : createPropertyDescriptor('lineThickness'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying the starting offset of grid lines along each axis.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(0.0, 0.0)\n         */\n        lineOffset : createPropertyDescriptor('lineOffset')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    GridMaterialProperty.prototype.getType = function(time) {\n        return 'Grid';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    GridMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, defaultColor, result.color);\n        result.cellAlpha = Property.getValueOrDefault(this._cellAlpha, time, defaultCellAlpha);\n        result.lineCount = Property.getValueOrClonedDefault(this._lineCount, time, defaultLineCount, result.lineCount);\n        result.lineThickness = Property.getValueOrClonedDefault(this._lineThickness, time, defaultLineThickness, result.lineThickness);\n        result.lineOffset = Property.getValueOrClonedDefault(this._lineOffset, time, defaultLineOffset, result.lineOffset);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    GridMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n        (other instanceof GridMaterialProperty && //\n        Property.equals(this._color, other._color) && //\n        Property.equals(this._cellAlpha, other._cellAlpha) && //\n        Property.equals(this._lineCount, other._lineCount) && //\n        Property.equals(this._lineThickness, other._lineThickness) && //\n        Property.equals(this._lineOffset, other._lineOffset));\n    };\nexport default GridMaterialProperty;\n","import Color from '../Core/Color.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link MaterialProperty} that maps to PolylineArrow {@link Material} uniforms.\n     *\n     * @param {Property} [color=Color.WHITE] The {@link Color} Property to be used.\n     *\n     * @alias PolylineArrowMaterialProperty\n     * @constructor\n     */\n    function PolylineArrowMaterialProperty(color) {\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n\n        this.color = color;\n    }\n\n    defineProperties(PolylineArrowMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof PolylineArrowMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._color);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof PolylineArrowMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the {@link Color} {@link Property}.\n         * @memberof PolylineArrowMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        color : createPropertyDescriptor('color')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    PolylineArrowMaterialProperty.prototype.getType = function(time) {\n        return 'PolylineArrow';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PolylineArrowMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, Color.WHITE, result.color);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PolylineArrowMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PolylineArrowMaterialProperty && //\n                Property.equals(this._color, other._color));\n    };\nexport default PolylineArrowMaterialProperty;\n","import Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultColor = Color.WHITE;\n    var defaultGapColor = Color.TRANSPARENT;\n    var defaultDashLength = 16.0;\n    var defaultDashPattern = 255.0;\n\n    /**\n     * A {@link MaterialProperty} that maps to polyline dash {@link Material} uniforms.\n     * @alias PolylineDashMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.color=Color.WHITE] A Property specifying the {@link Color} of the line.\n     * @param {Property} [options.gapColor=Color.TRANSPARENT] A Property specifying the {@link Color} of the gaps in the line.\n     * @param {Property} [options.dashLength=16.0] A numeric Property specifying the length of the dash pattern in pixels.\n     * @param {Property} [options.dashPattern=255.0] A numeric Property specifying a 16 bit pattern for the dash\n     */\n    function PolylineDashMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n        this._gapColor = undefined;\n        this._gapColorSubscription = undefined;\n        this._dashLength = undefined;\n        this._dashLengthSubscription = undefined;\n        this._dashPattern = undefined;\n        this._dashPatternSubscription = undefined;\n\n        this.color = options.color;\n        this.gapColor = options.gapColor;\n        this.dashLength = options.dashLength;\n        this.dashPattern = options.dashPattern;\n    }\n\n    defineProperties(PolylineDashMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return (Property.isConstant(this._color) &&\n                        Property.isConstant(this._gapColor) &&\n                        Property.isConstant(this._dashLength) &&\n                        Property.isConstant(this._dashPattern));\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the line.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        color : createPropertyDescriptor('color'),\n\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the gaps in the line.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        gapColor : createPropertyDescriptor('gapColor'),\n\n        /**\n         * Gets or sets the numeric Property specifying the length of a dash cycle\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        dashLength : createPropertyDescriptor('dashLength'),\n\n        /**\n         * Gets or sets the numeric Property specifying a dash pattern\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        dashPattern : createPropertyDescriptor('dashPattern')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    PolylineDashMaterialProperty.prototype.getType = function(time) {\n        return 'PolylineDash';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PolylineDashMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, defaultColor, result.color);\n        result.gapColor = Property.getValueOrClonedDefault(this._gapColor, time, defaultGapColor, result.gapColor);\n        result.dashLength = Property.getValueOrDefault(this._dashLength, time, defaultDashLength, result.dashLength);\n        result.dashPattern = Property.getValueOrDefault(this._dashPattern, time, defaultDashPattern, result.dashPattern);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PolylineDashMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PolylineDashMaterialProperty &&\n                Property.equals(this._color, other._color) &&\n                Property.equals(this._gapColor, other._gapColor) &&\n                Property.equals(this._dashLength, other._dashLength) &&\n                Property.equals(this._dashPattern, other._dashPattern));\n    };\nexport default PolylineDashMaterialProperty;\n","import Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultColor = Color.WHITE;\n    var defaultOutlineColor = Color.BLACK;\n    var defaultOutlineWidth = 1.0;\n\n    /**\n     * A {@link MaterialProperty} that maps to polyline outline {@link Material} uniforms.\n     * @alias PolylineOutlineMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.color=Color.WHITE] A Property specifying the {@link Color} of the line.\n     * @param {Property} [options.outlineColor=Color.BLACK] A Property specifying the {@link Color} of the outline.\n     * @param {Property} [options.outlineWidth=1.0] A numeric Property specifying the width of the outline, in pixels.\n     */\n    function PolylineOutlineMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n        this._outlineColor = undefined;\n        this._outlineColorSubscription = undefined;\n        this._outlineWidth = undefined;\n        this._outlineWidthSubscription = undefined;\n\n        this.color = options.color;\n        this.outlineColor = options.outlineColor;\n        this.outlineWidth = options.outlineWidth;\n    }\n\n    defineProperties(PolylineOutlineMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._color) && Property.isConstant(this._outlineColor) && Property.isConstant(this._outlineWidth);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the line.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        color : createPropertyDescriptor('color'),\n\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the outline.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.BLACK\n         */\n        outlineColor : createPropertyDescriptor('outlineColor'),\n\n        /**\n         * Gets or sets the numeric Property specifying the width of the outline.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         * @type {Property}\n         * @default 1.0\n         */\n        outlineWidth : createPropertyDescriptor('outlineWidth')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    PolylineOutlineMaterialProperty.prototype.getType = function(time) {\n        return 'PolylineOutline';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PolylineOutlineMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, defaultColor, result.color);\n        result.outlineColor = Property.getValueOrClonedDefault(this._outlineColor, time, defaultOutlineColor, result.outlineColor);\n        result.outlineWidth = Property.getValueOrDefault(this._outlineWidth, time, defaultOutlineWidth);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PolylineOutlineMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PolylineOutlineMaterialProperty && //\n                Property.equals(this._color, other._color) && //\n                Property.equals(this._outlineColor, other._outlineColor) && //\n                Property.equals(this._outlineWidth, other._outlineWidth));\n    };\nexport default PolylineOutlineMaterialProperty;\n","import defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport EventHelper from '../Core/EventHelper.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link Property} whose value is an array whose items are the computed value\n     * of other property instances.\n     *\n     * @alias PropertyArray\n     * @constructor\n     *\n     * @param {Property[]} [value] An array of Property instances.\n     */\n    function PropertyArray(value) {\n        this._value = undefined;\n        this._definitionChanged = new Event();\n        this._eventHelper = new EventHelper();\n        this.setValue(value);\n    }\n\n    defineProperties(PropertyArray.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  This property\n         * is considered constant if all property items in the array are constant.\n         * @memberof PropertyArray.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                var value = this._value;\n                if (!defined(value)) {\n                    return true;\n                }\n                var length = value.length;\n                for (var i = 0; i < length; i++) {\n                    if (!Property.isConstant(value[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value or one of the properties in the array also changes.\n         * @memberof PropertyArray.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object[]} The modified result parameter, which is an array of values produced by evaluating each of the contained properties at the given time or a new instance if the result parameter was not supplied.\n     */\n    PropertyArray.prototype.getValue = function(time, result) {\n        \n\n        var value = this._value;\n        if (!defined(value)) {\n            return undefined;\n        }\n\n        var length = value.length;\n        if (!defined(result)) {\n            result = new Array(length);\n        }\n        var i = 0;\n        var x = 0;\n        while (i < length) {\n            var property = this._value[i];\n            var itemValue = property.getValue(time, result[i]);\n            if (defined(itemValue)) {\n                result[x] = itemValue;\n                x++;\n            }\n            i++;\n        }\n        result.length = x;\n        return result;\n    };\n\n    /**\n     * Sets the value of the property.\n     *\n     * @param {Property[]} value An array of Property instances.\n     */\n    PropertyArray.prototype.setValue = function(value) {\n        var eventHelper = this._eventHelper;\n        eventHelper.removeAll();\n\n        if (defined(value)) {\n            this._value = value.slice();\n            var length = value.length;\n            for (var i = 0; i < length; i++) {\n                var property = value[i];\n                if (defined(property)) {\n                    eventHelper.add(property.definitionChanged, PropertyArray.prototype._raiseDefinitionChanged, this);\n                }\n            }\n        } else {\n            this._value = undefined;\n        }\n        this._definitionChanged.raiseEvent(this);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PropertyArray.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PropertyArray && //\n                Property.arrayEquals(this._value, other._value));\n    };\n\n    PropertyArray.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default PropertyArray;\n","import defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport CesiumMath from '../Core/Math.js';\n\n    /**\n     * Represents a {@link Packable} number that always interpolates values\n     * towards the shortest angle of rotation. This object is never used directly\n     * but is instead passed to the constructor of {@link SampledProperty}\n     * in order to represent a two-dimensional angle of rotation.\n     *\n     * @exports Rotation\n     *\n     *\n     * @example\n     * var time1 = Cesium.JulianDate.fromIso8601('2010-05-07T00:00:00');\n     * var time2 = Cesium.JulianDate.fromIso8601('2010-05-07T00:01:00');\n     * var time3 = Cesium.JulianDate.fromIso8601('2010-05-07T00:02:00');\n     *\n     * var property = new Cesium.SampledProperty(Cesium.Rotation);\n     * property.addSample(time1, 0);\n     * property.addSample(time3, Cesium.Math.toRadians(350));\n     *\n     * //Getting the value at time2 will equal 355 degrees instead\n     * //of 175 degrees (which is what you get if you construct\n     * //a SampledProperty(Number) instead.  Note, the actual\n     * //return value is in radians, not degrees.\n     * property.getValue(time2);\n     *\n     * @see PackableForInterpolation\n     */\n    var Rotation = {\n        /**\n         * The number of elements used to pack the object into an array.\n         * @type {Number}\n         */\n        packedLength : 1,\n\n        /**\n         * Stores the provided instance into the provided array.\n         *\n         * @param {Rotation} value The value to pack.\n         * @param {Number[]} array The array to pack into.\n         * @param {Number} [startingIndex=0] The index into the array at which to start packing the elements.\n         *\n         * @returns {Number[]} The array that was packed into\n         */\n        pack : function(value, array, startingIndex) {\n            \n\n            startingIndex = defaultValue(startingIndex, 0);\n            array[startingIndex] = value;\n\n            return array;\n        },\n\n        /**\n         * Retrieves an instance from a packed array.\n         *\n         * @param {Number[]} array The packed array.\n         * @param {Number} [startingIndex=0] The starting index of the element to be unpacked.\n         * @param {Rotation} [result] The object into which to store the result.\n         * @returns {Rotation} The modified result parameter or a new Rotation instance if one was not provided.\n         */\n        unpack : function(array, startingIndex, result) {\n            \n\n            startingIndex = defaultValue(startingIndex, 0);\n            return array[startingIndex];\n        },\n\n        /**\n         * Converts a packed array into a form suitable for interpolation.\n         *\n         * @param {Number[]} packedArray The packed array.\n         * @param {Number} [startingIndex=0] The index of the first element to be converted.\n         * @param {Number} [lastIndex=packedArray.length] The index of the last element to be converted.\n         * @param {Number[]} result The object into which to store the result.\n         */\n        convertPackedArrayForInterpolation : function(packedArray, startingIndex, lastIndex, result) {\n            \n\n            startingIndex = defaultValue(startingIndex, 0);\n            lastIndex = defaultValue(lastIndex, packedArray.length);\n\n            var previousValue;\n            for (var i = 0, len = lastIndex - startingIndex + 1; i < len; i++) {\n                var value = packedArray[startingIndex + i];\n                if (i === 0 || Math.abs(previousValue - value) < Math.PI) {\n                    result[i] = value;\n                } else {\n                    result[i] = value - CesiumMath.TWO_PI;\n                }\n                previousValue = value;\n            }\n        },\n\n        /**\n         * Retrieves an instance from a packed array converted with {@link Rotation.convertPackedArrayForInterpolation}.\n         *\n         * @param {Number[]} array The array previously packed for interpolation.\n         * @param {Number[]} sourceArray The original packed array.\n         * @param {Number} [firstIndex=0] The firstIndex used to convert the array.\n         * @param {Number} [lastIndex=packedArray.length] The lastIndex used to convert the array.\n         * @param {Rotation} [result] The object into which to store the result.\n         * @returns {Rotation} The modified result parameter or a new Rotation instance if one was not provided.\n         */\n        unpackInterpolationResult : function(array, sourceArray, firstIndex, lastIndex, result) {\n            \n\n            result = array[0];\n            if (result < 0) {\n                return result + CesiumMath.TWO_PI;\n            }\n            return result;\n        }\n    };\nexport default Rotation;\n","import freezeObject from '../Core/freezeObject.js';\n\n    /**\n     * Defined the orientation of stripes in {@link StripeMaterialProperty}.\n     *\n     * @exports StripeOrientation\n     */\n    var StripeOrientation = {\n        /**\n         * Horizontal orientation.\n         * @type {Number}\n         */\n        HORIZONTAL : 0,\n\n        /**\n         * Vertical orientation.\n         * @type {Number}\n         */\n        VERTICAL : 1\n    };\nexport default freezeObject(StripeOrientation);\n","import Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\nimport StripeOrientation from './StripeOrientation.js';\n\n    var defaultOrientation = StripeOrientation.HORIZONTAL;\n    var defaultEvenColor = Color.WHITE;\n    var defaultOddColor = Color.BLACK;\n    var defaultOffset = 0;\n    var defaultRepeat = 1;\n\n    /**\n     * A {@link MaterialProperty} that maps to stripe {@link Material} uniforms.\n     * @alias StripeMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.orientation=StripeOrientation.HORIZONTAL] A Property specifying the {@link StripeOrientation}.\n     * @param {Property} [options.evenColor=Color.WHITE] A Property specifying the first {@link Color}.\n     * @param {Property} [options.oddColor=Color.BLACK] A Property specifying the second {@link Color}.\n     * @param {Property} [options.offset=0] A numeric Property specifying how far into the pattern to start the material.\n     * @param {Property} [options.repeat=1] A numeric Property specifying how many times the stripes repeat.\n     */\n    function StripeMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._orientation = undefined;\n        this._orientationSubscription = undefined;\n        this._evenColor = undefined;\n        this._evenColorSubscription = undefined;\n        this._oddColor = undefined;\n        this._oddColorSubscription = undefined;\n        this._offset = undefined;\n        this._offsetSubscription = undefined;\n        this._repeat = undefined;\n        this._repeatSubscription = undefined;\n\n        this.orientation = options.orientation;\n        this.evenColor = options.evenColor;\n        this.oddColor = options.oddColor;\n        this.offset = options.offset;\n        this.repeat = options.repeat;\n    }\n\n    defineProperties(StripeMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof StripeMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._orientation) && //\n                       Property.isConstant(this._evenColor) && //\n                       Property.isConstant(this._oddColor) && //\n                       Property.isConstant(this._offset) && //\n                       Property.isConstant(this._repeat);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof StripeMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n\n        /**\n         * Gets or sets the Property specifying the {@link StripeOrientation}/\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default StripeOrientation.HORIZONTAL\n         */\n        orientation : createPropertyDescriptor('orientation'),\n\n        /**\n         * Gets or sets the Property specifying the first {@link Color}.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        evenColor : createPropertyDescriptor('evenColor'),\n\n        /**\n         * Gets or sets the Property specifying the second {@link Color}.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.BLACK\n         */\n        oddColor : createPropertyDescriptor('oddColor'),\n\n        /**\n         * Gets or sets the numeric Property specifying the point into the pattern\n         * to begin drawing; with 0.0 being the beginning of the even color, 1.0 the beginning\n         * of the odd color, 2.0 being the even color again, and any multiple or fractional values\n         * being in between.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default 0.0\n         */\n        offset : createPropertyDescriptor('offset'),\n\n        /**\n         * Gets or sets the numeric Property specifying how many times the stripes repeat.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default 1.0\n         */\n        repeat : createPropertyDescriptor('repeat')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    StripeMaterialProperty.prototype.getType = function(time) {\n        return 'Stripe';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    StripeMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.horizontal = Property.getValueOrDefault(this._orientation, time, defaultOrientation) === StripeOrientation.HORIZONTAL;\n        result.evenColor = Property.getValueOrClonedDefault(this._evenColor, time, defaultEvenColor, result.evenColor);\n        result.oddColor = Property.getValueOrClonedDefault(this._oddColor, time, defaultOddColor, result.oddColor);\n        result.offset = Property.getValueOrDefault(this._offset, time, defaultOffset);\n        result.repeat = Property.getValueOrDefault(this._repeat, time, defaultRepeat);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    StripeMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof StripeMaterialProperty && //\n                       Property.equals(this._orientation, other._orientation) && //\n                       Property.equals(this._evenColor, other._evenColor) && //\n                       Property.equals(this._oddColor, other._oddColor) && //\n                       Property.equals(this._offset, other._offset) && //\n                       Property.equals(this._repeat, other._repeat));\n    };\nexport default StripeMaterialProperty;\n","import Cartesian3 from '../Core/Cartesian3.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport JulianDate from '../Core/JulianDate.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link Property} which evaluates to a {@link Cartesian3} vector\n     * based on the velocity of the provided {@link PositionProperty}.\n     *\n     * @alias VelocityVectorProperty\n     * @constructor\n     *\n     * @param {Property} [position] The position property used to compute the velocity.\n     * @param {Boolean} [normalize=true] Whether to normalize the computed velocity vector.\n     *\n     * @example\n     * //Create an entity with a billboard rotated to match its velocity.\n     * var position = new Cesium.SampledProperty();\n     * position.addSamples(...);\n     * var entity = viewer.entities.add({\n     *   position : position,\n     *   billboard : {\n     *     image : 'image.png',\n     *     alignedAxis : new Cesium.VelocityVectorProperty(position, true) // alignedAxis must be a unit vector\n     *   }\n     * }));\n     */\n    function VelocityVectorProperty(position, normalize) {\n        this._position = undefined;\n        this._subscription = undefined;\n        this._definitionChanged = new Event();\n        this._normalize = defaultValue(normalize, true);\n\n        this.position = position;\n    }\n\n    defineProperties(VelocityVectorProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._position);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the position property used to compute the velocity vector.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Property}\n         */\n        position : {\n            get : function() {\n                return this._position;\n            },\n            set : function(value) {\n                var oldValue = this._position;\n                if (oldValue !== value) {\n                    if (defined(oldValue)) {\n                        this._subscription();\n                    }\n\n                    this._position = value;\n\n                    if (defined(value)) {\n                        this._subscription = value._definitionChanged.addEventListener(function() {\n                            this._definitionChanged.raiseEvent(this);\n                        }, this);\n                    }\n\n                    this._definitionChanged.raiseEvent(this);\n                }\n            }\n        },\n        /**\n         * Gets or sets whether the vector produced by this property\n         * will be normalized or not.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Boolean}\n         */\n        normalize : {\n            get : function() {\n                return this._normalize;\n            },\n            set : function(value) {\n                if (this._normalize === value) {\n                    return;\n                }\n\n                this._normalize = value;\n                this._definitionChanged.raiseEvent(this);\n            }\n        }\n    });\n\n    var position1Scratch = new Cartesian3();\n    var position2Scratch = new Cartesian3();\n    var timeScratch = new JulianDate();\n    var step = 1.0 / 60.0;\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} [time] The time for which to retrieve the value.\n     * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    VelocityVectorProperty.prototype.getValue = function(time, result) {\n        return this._getValue(time, result);\n    };\n\n    /**\n     * @private\n     */\n    VelocityVectorProperty.prototype._getValue = function(time, velocityResult, positionResult) {\n        \n\n        if (!defined(velocityResult)) {\n            velocityResult = new Cartesian3();\n        }\n\n        var property = this._position;\n        if (Property.isConstant(property)) {\n            return this._normalize ? undefined : Cartesian3.clone(Cartesian3.ZERO, velocityResult);\n        }\n\n        var position1 = property.getValue(time, position1Scratch);\n        var position2 = property.getValue(JulianDate.addSeconds(time, step, timeScratch), position2Scratch);\n\n        //If we don't have a position for now, return undefined.\n        if (!defined(position1)) {\n            return undefined;\n        }\n\n        //If we don't have a position for now + step, see if we have a position for now - step.\n        if (!defined(position2)) {\n            position2 = position1;\n            position1 = property.getValue(JulianDate.addSeconds(time, -step, timeScratch), position2Scratch);\n\n            if (!defined(position1)) {\n                return undefined;\n            }\n        }\n\n        if (Cartesian3.equals(position1, position2)) {\n            return this._normalize ? undefined : Cartesian3.clone(Cartesian3.ZERO, velocityResult);\n        }\n\n        if (defined(positionResult)) {\n            position1.clone(positionResult);\n        }\n\n        var velocity = Cartesian3.subtract(position2, position1, velocityResult);\n        if (this._normalize) {\n            return Cartesian3.normalize(velocity, velocityResult);\n        }\n\n        return Cartesian3.divideByScalar(velocity, step, velocityResult);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    VelocityVectorProperty.prototype.equals = function(other) {\n        return this === other ||//\n               (other instanceof VelocityVectorProperty &&\n                Property.equals(this._position, other._position));\n    };\nexport default VelocityVectorProperty;\n","import Cartesian3 from '../Core/Cartesian3.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport Matrix3 from '../Core/Matrix3.js';\nimport Quaternion from '../Core/Quaternion.js';\nimport Transforms from '../Core/Transforms.js';\nimport Property from './Property.js';\nimport VelocityVectorProperty from './VelocityVectorProperty.js';\n\n    /**\n     * A {@link Property} which evaluates to a {@link Quaternion} rotation\n     * based on the velocity of the provided {@link PositionProperty}.\n     *\n     * @alias VelocityOrientationProperty\n     * @constructor\n     *\n     * @param {Property} [position] The position property used to compute the orientation.\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid used to determine which way is up.\n     *\n     * @example\n     * //Create an entity with position and orientation.\n     * var position = new Cesium.SampledProperty();\n     * position.addSamples(...);\n     * var entity = viewer.entities.add({\n     *   position : position,\n     *   orientation : new Cesium.VelocityOrientationProperty(position)\n     * }));\n     */\n    function VelocityOrientationProperty(position, ellipsoid) {\n        this._velocityVectorProperty = new VelocityVectorProperty(position, true);\n        this._subscription = undefined;\n        this._ellipsoid = undefined;\n        this._definitionChanged = new Event();\n\n        this.ellipsoid = defaultValue(ellipsoid, Ellipsoid.WGS84);\n\n        var that = this;\n        this._velocityVectorProperty.definitionChanged.addEventListener(function() {\n            that._definitionChanged.raiseEvent(that);\n        });\n    }\n\n    defineProperties(VelocityOrientationProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._velocityVectorProperty);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the position property used to compute orientation.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Property}\n         */\n        position : {\n            get : function() {\n                return this._velocityVectorProperty.position;\n            },\n            set : function(value) {\n                this._velocityVectorProperty.position = value;\n            }\n        },\n        /**\n         * Gets or sets the ellipsoid used to determine which way is up.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Property}\n         */\n        ellipsoid : {\n            get : function() {\n                return this._ellipsoid;\n            },\n            set : function(value) {\n                var oldValue = this._ellipsoid;\n                if (oldValue !== value) {\n                    this._ellipsoid = value;\n                    this._definitionChanged.raiseEvent(this);\n                }\n            }\n        }\n    });\n\n    var positionScratch = new Cartesian3();\n    var velocityScratch = new Cartesian3();\n    var rotationScratch = new Matrix3();\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} [time] The time for which to retrieve the value.\n     * @param {Quaternion} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Quaternion} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    VelocityOrientationProperty.prototype.getValue = function(time, result) {\n        var velocity = this._velocityVectorProperty._getValue(time, velocityScratch, positionScratch);\n\n        if (!defined(velocity)) {\n            return undefined;\n        }\n\n        Transforms.rotationMatrixFromPositionVelocity(positionScratch, velocity, this._ellipsoid, rotationScratch);\n        return Quaternion.fromRotationMatrix(rotationScratch, result);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    VelocityOrientationProperty.prototype.equals = function(other) {\n        return this === other ||//\n               (other instanceof VelocityOrientationProperty &&\n                Property.equals(this._velocityVectorProperty, other._velocityVectorProperty) &&\n                (this._ellipsoid === other._ellipsoid ||\n                 this._ellipsoid.equals(other._ellipsoid)));\n    };\nexport default VelocityOrientationProperty;\n","import ArcType from '../Core/ArcType.js';\nimport BoundingRectangle from '../Core/BoundingRectangle.js';\nimport Cartesian2 from '../Core/Cartesian2.js';\nimport Cartesian3 from '../Core/Cartesian3.js';\nimport Cartographic from '../Core/Cartographic.js';\nimport ClockRange from '../Core/ClockRange.js';\nimport ClockStep from '../Core/ClockStep.js';\nimport Color from '../Core/Color.js';\nimport CornerType from '../Core/CornerType.js';\nimport Credit from '../Core/Credit.js';\nimport createGuid from '../Core/createGuid.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport DistanceDisplayCondition from '../Core/DistanceDisplayCondition.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport ExtrapolationType from '../Core/ExtrapolationType.js';\nimport getFilenameFromUri from '../Core/getFilenameFromUri.js';\nimport HermitePolynomialApproximation from '../Core/HermitePolynomialApproximation.js';\nimport isArray from '../Core/isArray.js';\nimport Iso8601 from '../Core/Iso8601.js';\nimport JulianDate from '../Core/JulianDate.js';\nimport LagrangePolynomialApproximation from '../Core/LagrangePolynomialApproximation.js';\nimport LinearApproximation from '../Core/LinearApproximation.js';\nimport CesiumMath from '../Core/Math.js';\nimport NearFarScalar from '../Core/NearFarScalar.js';\nimport PolygonHierarchy from '../Core/PolygonHierarchy.js';\nimport Quaternion from '../Core/Quaternion.js';\nimport Rectangle from '../Core/Rectangle.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport Resource from '../Core/Resource.js';\nimport RuntimeError from '../Core/RuntimeError.js';\nimport Spherical from '../Core/Spherical.js';\nimport TimeInterval from '../Core/TimeInterval.js';\nimport TimeIntervalCollection from '../Core/TimeIntervalCollection.js';\nimport ClassificationType from '../Scene/ClassificationType.js';\nimport ColorBlendMode from '../Scene/ColorBlendMode.js';\nimport HeightReference from '../Scene/HeightReference.js';\nimport HorizontalOrigin from '../Scene/HorizontalOrigin.js';\nimport LabelStyle from '../Scene/LabelStyle.js';\nimport ShadowMode from '../Scene/ShadowMode.js';\nimport VerticalOrigin from '../Scene/VerticalOrigin.js';\nimport Uri from '../ThirdParty/Uri.js';\nimport when from '../ThirdParty/when.js';\nimport BillboardGraphics from './BillboardGraphics.js';\nimport BoxGraphics from './BoxGraphics.js';\nimport CallbackProperty from './CallbackProperty.js';\nimport CheckerboardMaterialProperty from './CheckerboardMaterialProperty.js';\nimport ColorMaterialProperty from './ColorMaterialProperty.js';\nimport CompositeMaterialProperty from './CompositeMaterialProperty.js';\nimport CompositePositionProperty from './CompositePositionProperty.js';\nimport CompositeProperty from './CompositeProperty.js';\nimport ConstantPositionProperty from './ConstantPositionProperty.js';\nimport ConstantProperty from './ConstantProperty.js';\nimport CorridorGraphics from './CorridorGraphics.js';\nimport CylinderGraphics from './CylinderGraphics.js';\nimport DataSource from './DataSource.js';\nimport DataSourceClock from './DataSourceClock.js';\nimport EllipseGraphics from './EllipseGraphics.js';\nimport EllipsoidGraphics from './EllipsoidGraphics.js';\nimport EntityCluster from './EntityCluster.js';\nimport EntityCollection from './EntityCollection.js';\nimport GridMaterialProperty from './GridMaterialProperty.js';\nimport ImageMaterialProperty from './ImageMaterialProperty.js';\nimport LabelGraphics from './LabelGraphics.js';\nimport ModelGraphics from './ModelGraphics.js';\nimport NodeTransformationProperty from './NodeTransformationProperty.js';\nimport PathGraphics from './PathGraphics.js';\nimport PointGraphics from './PointGraphics.js';\nimport PolygonGraphics from './PolygonGraphics.js';\nimport PolylineArrowMaterialProperty from './PolylineArrowMaterialProperty.js';\nimport PolylineDashMaterialProperty from './PolylineDashMaterialProperty.js';\nimport PolylineGlowMaterialProperty from './PolylineGlowMaterialProperty.js';\nimport PolylineGraphics from './PolylineGraphics.js';\nimport PolylineOutlineMaterialProperty from './PolylineOutlineMaterialProperty.js';\nimport PositionPropertyArray from './PositionPropertyArray.js';\nimport Property from './Property.js';\nimport PropertyArray from './PropertyArray.js';\nimport PropertyBag from './PropertyBag.js';\nimport RectangleGraphics from './RectangleGraphics.js';\nimport ReferenceProperty from './ReferenceProperty.js';\nimport Rotation from './Rotation.js';\nimport SampledPositionProperty from './SampledPositionProperty.js';\nimport SampledProperty from './SampledProperty.js';\nimport StripeMaterialProperty from './StripeMaterialProperty.js';\nimport StripeOrientation from './StripeOrientation.js';\nimport TimeIntervalCollectionPositionProperty from './TimeIntervalCollectionPositionProperty.js';\nimport TimeIntervalCollectionProperty from './TimeIntervalCollectionProperty.js';\nimport VelocityOrientationProperty from './VelocityOrientationProperty.js';\nimport VelocityVectorProperty from './VelocityVectorProperty.js';\nimport WallGraphics from './WallGraphics.js';\n\n    // A marker type to distinguish CZML properties where we need to end up with a unit vector.\n    // The data is still loaded into Cartesian3 objects but they are normalized.\n    function UnitCartesian3() {}\n    UnitCartesian3.packedLength = Cartesian3.packedLength;\n    UnitCartesian3.unpack = Cartesian3.unpack;\n    UnitCartesian3.pack = Cartesian3.pack;\n\n    // As a side note, for the purposes of CZML, Quaternion always indicates a unit quaternion.\n\n    var currentId;\n\n    function createReferenceProperty(entityCollection, referenceString) {\n        if (referenceString[0] === '#') {\n            referenceString = currentId + referenceString;\n        }\n        return ReferenceProperty.fromString(entityCollection, referenceString);\n    }\n\n    function createSpecializedProperty(type, entityCollection, packetData) {\n        if (defined(packetData.reference)) {\n            return createReferenceProperty(entityCollection, packetData.reference);\n        }\n\n        if (defined(packetData.velocityReference)) {\n            var referenceProperty = createReferenceProperty(entityCollection, packetData.velocityReference);\n            switch (type) {\n                case Cartesian3:\n                case UnitCartesian3:\n                    return new VelocityVectorProperty(referenceProperty, type === UnitCartesian3);\n                case Quaternion:\n                    return new VelocityOrientationProperty(referenceProperty);\n            }\n        }\n\n        throw new RuntimeError(JSON.stringify(packetData) + ' is not valid CZML.');\n    }\n\n    function createAdapterProperty(property, adapterFunction) {\n        return new CallbackProperty(function(time, result) {\n            return adapterFunction(property.getValue(time, result));\n        }, property.isConstant);\n    }\n\n    var scratchCartesian = new Cartesian3();\n    var scratchSpherical = new Spherical();\n    var scratchCartographic = new Cartographic();\n    var scratchTimeInterval = new TimeInterval();\n    var scratchQuaternion = new Quaternion();\n\n    function unwrapColorInterval(czmlInterval) {\n        var rgbaf = czmlInterval.rgbaf;\n        if (defined(rgbaf)) {\n            return rgbaf;\n        }\n\n        var rgba = czmlInterval.rgba;\n        if (!defined(rgba)) {\n            return undefined;\n        }\n\n        var length = rgba.length;\n        if (length === Color.packedLength) {\n            return [Color.byteToFloat(rgba[0]), Color.byteToFloat(rgba[1]), Color.byteToFloat(rgba[2]), Color.byteToFloat(rgba[3])];\n        }\n\n        rgbaf = new Array(length);\n        for (var i = 0; i < length; i += 5) {\n            rgbaf[i] = rgba[i];\n            rgbaf[i + 1] = Color.byteToFloat(rgba[i + 1]);\n            rgbaf[i + 2] = Color.byteToFloat(rgba[i + 2]);\n            rgbaf[i + 3] = Color.byteToFloat(rgba[i + 3]);\n            rgbaf[i + 4] = Color.byteToFloat(rgba[i + 4]);\n        }\n        return rgbaf;\n    }\n\n    function unwrapUriInterval(czmlInterval, sourceUri) {\n        var uri = defaultValue(czmlInterval.uri, czmlInterval);\n        if (defined(sourceUri)) {\n            return sourceUri.getDerivedResource({\n                url: uri\n            });\n        }\n\n        return Resource.createIfNeeded(uri);\n    }\n\n    function unwrapRectangleInterval(czmlInterval) {\n        var wsen = czmlInterval.wsen;\n        if (defined(wsen)) {\n            return wsen;\n        }\n\n        var wsenDegrees = czmlInterval.wsenDegrees;\n        if (!defined(wsenDegrees)) {\n            return undefined;\n        }\n\n        var length = wsenDegrees.length;\n        if (length === Rectangle.packedLength) {\n            return [CesiumMath.toRadians(wsenDegrees[0]), CesiumMath.toRadians(wsenDegrees[1]), CesiumMath.toRadians(wsenDegrees[2]), CesiumMath.toRadians(wsenDegrees[3])];\n        }\n\n        wsen = new Array(length);\n        for (var i = 0; i < length; i += 5) {\n            wsen[i] = wsenDegrees[i];\n            wsen[i + 1] = CesiumMath.toRadians(wsenDegrees[i + 1]);\n            wsen[i + 2] = CesiumMath.toRadians(wsenDegrees[i + 2]);\n            wsen[i + 3] = CesiumMath.toRadians(wsenDegrees[i + 3]);\n            wsen[i + 4] = CesiumMath.toRadians(wsenDegrees[i + 4]);\n        }\n        return wsen;\n    }\n\n    function convertUnitSphericalToCartesian(unitSpherical) {\n        var length = unitSpherical.length;\n        scratchSpherical.magnitude = 1.0;\n        if (length === 2) {\n            scratchSpherical.clock = unitSpherical[0];\n            scratchSpherical.cone = unitSpherical[1];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length / 3 * 4);\n        for (var i = 0, j = 0; i < length; i += 3, j += 4) {\n            result[j] = unitSpherical[i];\n\n            scratchSpherical.clock = unitSpherical[i + 1];\n            scratchSpherical.cone = unitSpherical[i + 2];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n\n            result[j + 1] = scratchCartesian.x;\n            result[j + 2] = scratchCartesian.y;\n            result[j + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function convertSphericalToCartesian(spherical) {\n        var length = spherical.length;\n        if (length === 3) {\n            scratchSpherical.clock = spherical[0];\n            scratchSpherical.cone = spherical[1];\n            scratchSpherical.magnitude = spherical[2];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length);\n        for (var i = 0; i < length; i += 4) {\n            result[i] = spherical[i];\n\n            scratchSpherical.clock = spherical[i + 1];\n            scratchSpherical.cone = spherical[i + 2];\n            scratchSpherical.magnitude = spherical[i + 3];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n\n            result[i + 1] = scratchCartesian.x;\n            result[i + 2] = scratchCartesian.y;\n            result[i + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function convertCartographicRadiansToCartesian(cartographicRadians) {\n        var length = cartographicRadians.length;\n        if (length === 3) {\n            scratchCartographic.longitude = cartographicRadians[0];\n            scratchCartographic.latitude = cartographicRadians[1];\n            scratchCartographic.height = cartographicRadians[2];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length);\n        for (var i = 0; i < length; i += 4) {\n            result[i] = cartographicRadians[i];\n\n            scratchCartographic.longitude = cartographicRadians[i + 1];\n            scratchCartographic.latitude = cartographicRadians[i + 2];\n            scratchCartographic.height = cartographicRadians[i + 3];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n\n            result[i + 1] = scratchCartesian.x;\n            result[i + 2] = scratchCartesian.y;\n            result[i + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function convertCartographicDegreesToCartesian(cartographicDegrees) {\n        var length = cartographicDegrees.length;\n        if (length === 3) {\n            scratchCartographic.longitude = CesiumMath.toRadians(cartographicDegrees[0]);\n            scratchCartographic.latitude = CesiumMath.toRadians(cartographicDegrees[1]);\n            scratchCartographic.height = cartographicDegrees[2];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length);\n        for (var i = 0; i < length; i += 4) {\n            result[i] = cartographicDegrees[i];\n\n            scratchCartographic.longitude = CesiumMath.toRadians(cartographicDegrees[i + 1]);\n            scratchCartographic.latitude = CesiumMath.toRadians(cartographicDegrees[i + 2]);\n            scratchCartographic.height = cartographicDegrees[i + 3];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n\n            result[i + 1] = scratchCartesian.x;\n            result[i + 2] = scratchCartesian.y;\n            result[i + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function unwrapCartesianInterval(czmlInterval) {\n        var cartesian = czmlInterval.cartesian;\n        if (defined(cartesian)) {\n            return cartesian;\n        }\n\n        var cartesianVelocity = czmlInterval.cartesianVelocity;\n        if (defined(cartesianVelocity)) {\n            return cartesianVelocity;\n        }\n\n        var unitCartesian = czmlInterval.unitCartesian;\n        if (defined(unitCartesian)) {\n            return unitCartesian;\n        }\n\n        var unitSpherical = czmlInterval.unitSpherical;\n        if (defined(unitSpherical)) {\n            return convertUnitSphericalToCartesian(unitSpherical);\n        }\n\n        var spherical = czmlInterval.spherical;\n        if (defined(spherical)) {\n            return convertSphericalToCartesian(spherical);\n        }\n\n        var cartographicRadians = czmlInterval.cartographicRadians;\n        if (defined(cartographicRadians)) {\n            return convertCartographicRadiansToCartesian(cartographicRadians);\n        }\n\n        var cartographicDegrees = czmlInterval.cartographicDegrees;\n        if (defined(cartographicDegrees)) {\n            return convertCartographicDegreesToCartesian(cartographicDegrees);\n        }\n\n        throw new RuntimeError(JSON.stringify(czmlInterval) + ' is not a valid CZML interval.');\n    }\n\n    function normalizePackedCartesianArray(array, startingIndex) {\n        Cartesian3.unpack(array, startingIndex, scratchCartesian);\n        Cartesian3.normalize(scratchCartesian, scratchCartesian);\n        Cartesian3.pack(scratchCartesian, array, startingIndex);\n    }\n\n    function unwrapUnitCartesianInterval(czmlInterval) {\n        var cartesian = unwrapCartesianInterval(czmlInterval);\n        if (cartesian.length === 3) {\n            normalizePackedCartesianArray(cartesian, 0);\n            return cartesian;\n        }\n\n        for (var i = 1; i < cartesian.length; i += 4) {\n            normalizePackedCartesianArray(cartesian, i);\n        }\n\n        return cartesian;\n    }\n\n    function normalizePackedQuaternionArray(array, startingIndex) {\n        Quaternion.unpack(array, startingIndex, scratchQuaternion);\n        Quaternion.normalize(scratchQuaternion, scratchQuaternion);\n        Quaternion.pack(scratchQuaternion, array, startingIndex);\n    }\n\n    function unwrapQuaternionInterval(czmlInterval) {\n        var unitQuaternion = czmlInterval.unitQuaternion;\n        if (defined(unitQuaternion)) {\n            if (unitQuaternion.length === 4) {\n                normalizePackedQuaternionArray(unitQuaternion, 0);\n                return unitQuaternion;\n            }\n\n            for (var i = 1; i < unitQuaternion.length; i += 5) {\n                normalizePackedQuaternionArray(unitQuaternion, i);\n            }\n        }\n        return unitQuaternion;\n    }\n\n    function getPropertyType(czmlInterval) {\n        // The associations in this function need to be kept in sync with the\n        // associations in unwrapInterval.\n\n        // Intentionally omitted due to conficts in CZML property names:\n        // * Image (conflicts with Uri)\n        // * Rotation (conflicts with Number)\n        //\n        // cartesianVelocity is also omitted due to incomplete support for\n        // derivative information in CZML properties.\n        // (Currently cartesianVelocity is hacked directly into the position processing code)\n        if (typeof czmlInterval === 'boolean') {\n            return Boolean;\n        } else if (typeof czmlInterval === 'number') {\n            return Number;\n        } else if (typeof czmlInterval === 'string') {\n            return String;\n        } else if (czmlInterval.hasOwnProperty('array')) {\n            return Array;\n        } else if (czmlInterval.hasOwnProperty('boolean')) {\n            return Boolean;\n        } else if (czmlInterval.hasOwnProperty('boundingRectangle')) {\n            return BoundingRectangle;\n        } else if (czmlInterval.hasOwnProperty('cartesian2')) {\n            return Cartesian2;\n        } else if (czmlInterval.hasOwnProperty('cartesian') ||\n                   czmlInterval.hasOwnProperty('spherical') ||\n                   czmlInterval.hasOwnProperty('cartographicRadians') ||\n                   czmlInterval.hasOwnProperty('cartographicDegrees')) {\n            return Cartesian3;\n        } else if (czmlInterval.hasOwnProperty('unitCartesian') ||\n                   czmlInterval.hasOwnProperty('unitSpherical')) {\n            return UnitCartesian3;\n        } else if (czmlInterval.hasOwnProperty('rgba') ||\n                   czmlInterval.hasOwnProperty('rgbaf')) {\n            return Color;\n        } else if (czmlInterval.hasOwnProperty('arcType')) {\n            return ArcType;\n        } else if (czmlInterval.hasOwnProperty('classificationType')) {\n            return ClassificationType;\n        } else if (czmlInterval.hasOwnProperty('colorBlendMode')) {\n            return ColorBlendMode;\n        } else if (czmlInterval.hasOwnProperty('cornerType')) {\n            return CornerType;\n        } else if (czmlInterval.hasOwnProperty('heightReference')) {\n            return HeightReference;\n        } else if (czmlInterval.hasOwnProperty('horizontalOrigin')) {\n            return HorizontalOrigin;\n        } else if (czmlInterval.hasOwnProperty('date')) {\n            return JulianDate;\n        } else if (czmlInterval.hasOwnProperty('labelStyle')) {\n            return LabelStyle;\n        } else if (czmlInterval.hasOwnProperty('number')) {\n            return Number;\n        } else if (czmlInterval.hasOwnProperty('nearFarScalar')) {\n            return NearFarScalar;\n        } else if (czmlInterval.hasOwnProperty('distanceDisplayCondition')) {\n            return DistanceDisplayCondition;\n        } else if (czmlInterval.hasOwnProperty('object') ||\n                   czmlInterval.hasOwnProperty('value')) {\n            return Object;\n        } else if (czmlInterval.hasOwnProperty('unitQuaternion')) {\n            return Quaternion;\n        } else if (czmlInterval.hasOwnProperty('shadowMode')) {\n            return ShadowMode;\n        } else if (czmlInterval.hasOwnProperty('string')) {\n            return String;\n        } else if (czmlInterval.hasOwnProperty('stripeOrientation')) {\n            return StripeOrientation;\n        } else if (czmlInterval.hasOwnProperty('wsen') ||\n                   czmlInterval.hasOwnProperty('wsenDegrees')) {\n            return Rectangle;\n        } else if (czmlInterval.hasOwnProperty('uri')) {\n            return Uri;\n        } else if (czmlInterval.hasOwnProperty('verticalOrigin')) {\n            return VerticalOrigin;\n        }\n        // fallback case\n        return Object;\n    }\n\n    function unwrapInterval(type, czmlInterval, sourceUri) {\n        // The associations in this function need to be kept in sync with the\n        // associations in getPropertyType\n        switch (type) {\n            case ArcType:\n                return ArcType[defaultValue(czmlInterval.arcType, czmlInterval)];\n            case Array:\n                return czmlInterval.array;\n            case Boolean:\n                return defaultValue(czmlInterval['boolean'], czmlInterval);\n            case BoundingRectangle:\n                return czmlInterval.boundingRectangle;\n            case Cartesian2:\n                return czmlInterval.cartesian2;\n            case Cartesian3:\n                return unwrapCartesianInterval(czmlInterval);\n            case UnitCartesian3:\n                return unwrapUnitCartesianInterval(czmlInterval);\n            case Color:\n                return unwrapColorInterval(czmlInterval);\n            case ClassificationType:\n                return ClassificationType[defaultValue(czmlInterval.classificationType, czmlInterval)];\n            case ColorBlendMode:\n                return ColorBlendMode[defaultValue(czmlInterval.colorBlendMode, czmlInterval)];\n            case CornerType:\n                return CornerType[defaultValue(czmlInterval.cornerType, czmlInterval)];\n            case HeightReference:\n                return HeightReference[defaultValue(czmlInterval.heightReference, czmlInterval)];\n            case HorizontalOrigin:\n                return HorizontalOrigin[defaultValue(czmlInterval.horizontalOrigin, czmlInterval)];\n            case Image:\n                return unwrapUriInterval(czmlInterval, sourceUri);\n            case JulianDate:\n                return JulianDate.fromIso8601(defaultValue(czmlInterval.date, czmlInterval));\n            case LabelStyle:\n                return LabelStyle[defaultValue(czmlInterval.labelStyle, czmlInterval)];\n            case Number:\n                return defaultValue(czmlInterval.number, czmlInterval);\n            case NearFarScalar:\n                return czmlInterval.nearFarScalar;\n            case DistanceDisplayCondition:\n                return czmlInterval.distanceDisplayCondition;\n            case Object:\n                return defaultValue(defaultValue(czmlInterval.object, czmlInterval.value), czmlInterval);\n            case Quaternion:\n                return unwrapQuaternionInterval(czmlInterval);\n            case Rectangle:\n                return unwrapRectangleInterval(czmlInterval);\n            case Rotation:\n                return defaultValue(czmlInterval.number, czmlInterval);\n            case ShadowMode:\n                return ShadowMode[defaultValue(defaultValue(czmlInterval.shadowMode, czmlInterval.shadows), czmlInterval)];\n            case String:\n                return defaultValue(czmlInterval.string, czmlInterval);\n            case StripeOrientation:\n                return StripeOrientation[defaultValue(czmlInterval.stripeOrientation, czmlInterval)];\n            case Uri:\n                return unwrapUriInterval(czmlInterval, sourceUri);\n            case VerticalOrigin:\n                return VerticalOrigin[defaultValue(czmlInterval.verticalOrigin, czmlInterval)];\n            default:\n                throw new RuntimeError(type);\n        }\n    }\n\n    var interpolators = {\n        HERMITE : HermitePolynomialApproximation,\n        LAGRANGE : LagrangePolynomialApproximation,\n        LINEAR : LinearApproximation\n    };\n\n    function updateInterpolationSettings(packetData, property) {\n        var interpolationAlgorithm = packetData.interpolationAlgorithm;\n        var interpolationDegree = packetData.interpolationDegree;\n        if (defined(interpolationAlgorithm) || defined(interpolationDegree)) {\n            property.setInterpolationOptions({\n                interpolationAlgorithm : interpolators[interpolationAlgorithm],\n                interpolationDegree : interpolationDegree\n            });\n        }\n\n        var forwardExtrapolationType = packetData.forwardExtrapolationType;\n        if (defined(forwardExtrapolationType)) {\n            property.forwardExtrapolationType = ExtrapolationType[forwardExtrapolationType];\n        }\n\n        var forwardExtrapolationDuration = packetData.forwardExtrapolationDuration;\n        if (defined(forwardExtrapolationDuration)) {\n            property.forwardExtrapolationDuration = forwardExtrapolationDuration;\n        }\n\n        var backwardExtrapolationType = packetData.backwardExtrapolationType;\n        if (defined(backwardExtrapolationType)) {\n            property.backwardExtrapolationType = ExtrapolationType[backwardExtrapolationType];\n        }\n\n        var backwardExtrapolationDuration = packetData.backwardExtrapolationDuration;\n        if (defined(backwardExtrapolationDuration)) {\n            property.backwardExtrapolationDuration = backwardExtrapolationDuration;\n        }\n    }\n\n    var iso8601Scratch = {\n        iso8601 : undefined\n    };\n\n    function intervalFromString(intervalString) {\n        if (!defined(intervalString)) {\n            return undefined;\n        }\n        iso8601Scratch.iso8601 = intervalString;\n        return TimeInterval.fromIso8601(iso8601Scratch);\n    }\n\n    function wrapPropertyInInfiniteInterval(property) {\n        var interval = Iso8601.MAXIMUM_INTERVAL.clone();\n        interval.data = property;\n        return interval;\n    }\n\n    function convertPropertyToComposite(property) {\n        // Create the composite and add the old property, wrapped in an infinite interval.\n        var composite = new CompositeProperty();\n        composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n        return composite;\n    }\n\n    function convertPositionPropertyToComposite(property) {\n        // Create the composite and add the old property, wrapped in an infinite interval.\n        var composite = new CompositePositionProperty(property.referenceFrame);\n        composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n        return composite;\n    }\n\n    function processProperty(type, object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(packetData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var packedLength;\n        var unwrappedInterval;\n        var unwrappedIntervalLength;\n\n        // CZML properties can be defined in many ways.  Most ways represent a structure for\n        // encoding a single value (number, string, cartesian, etc.)  Regardless of the value type,\n        // if it encodes a single value it will get loaded into a ConstantProperty eventually.\n        // Alternatively, there are ways of defining a property that require specialized\n        // client-side representation. Currently, these are ReferenceProperty,\n        // and client-side velocity computation properties such as VelocityVectorProperty.\n        var isValue = !defined(packetData.reference) && !defined(packetData.velocityReference);\n        var hasInterval = defined(combinedInterval) && !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n        if (packetData.delete === true) {\n            // If deleting this property for all time, we can simply set to undefined and return.\n            if (!hasInterval) {\n                object[propertyName] = undefined;\n                return;\n            }\n\n            // Deleting depends on the type of property we have.\n            return removePropertyData(object[propertyName], combinedInterval);\n        }\n\n        var isSampled = false;\n\n        if (isValue) {\n            unwrappedInterval = unwrapInterval(type, packetData, sourceUri);\n            if (!defined(unwrappedInterval)) {\n                // not a known value type, bail\n                return;\n            }\n            packedLength = defaultValue(type.packedLength, 1);\n            unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n            isSampled = !defined(packetData.array) && (typeof unwrappedInterval !== 'string') && (unwrappedIntervalLength > packedLength) && (type !== Object);\n        }\n\n        // Rotation is a special case because it represents a native type (Number)\n        // and therefore does not need to be unpacked when loaded as a constant value.\n        var needsUnpacking = typeof type.unpack === 'function' && type !== Rotation;\n\n        // Any time a constant value is assigned, it completely blows away anything else.\n        if (!isSampled && !hasInterval) {\n            if (isValue) {\n                object[propertyName] = new ConstantProperty(needsUnpacking ? type.unpack(unwrappedInterval, 0) : unwrappedInterval);\n            } else {\n                object[propertyName] = createSpecializedProperty(type, entityCollection, packetData);\n            }\n            return;\n        }\n\n        var property = object[propertyName];\n\n        var epoch;\n        var packetEpoch = packetData.epoch;\n        if (defined(packetEpoch)) {\n            epoch = JulianDate.fromIso8601(packetEpoch);\n        }\n\n        // Without an interval, any sampled value is infinite, meaning it completely\n        // replaces any non-sampled property that may exist.\n        if (isSampled && !hasInterval) {\n            if (!(property instanceof SampledProperty)) {\n                object[propertyName] = property = new SampledProperty(type);\n            }\n            property.addSamplesPackedArray(unwrappedInterval, epoch);\n            updateInterpolationSettings(packetData, property);\n            return;\n        }\n\n        var interval;\n\n        // A constant value with an interval is normally part of a TimeIntervalCollection,\n        // However, if the current property is not a time-interval collection, we need\n        // to turn it into a Composite, preserving the old data with the new interval.\n        if (!isSampled && hasInterval) {\n            // Create a new interval for the constant value.\n            combinedInterval = combinedInterval.clone();\n            if (isValue) {\n                combinedInterval.data = needsUnpacking ? type.unpack(unwrappedInterval, 0) : unwrappedInterval;\n            } else {\n                combinedInterval.data = createSpecializedProperty(type, entityCollection, packetData);\n            }\n\n            // If no property exists, simply use a new interval collection\n            if (!defined(property)) {\n                object[propertyName] = property = isValue ? new TimeIntervalCollectionProperty() : new CompositeProperty();\n            }\n\n            if (isValue && property instanceof TimeIntervalCollectionProperty) {\n                // If we created a collection, or it already was one, use it.\n                property.intervals.addInterval(combinedInterval);\n            } else if (property instanceof CompositeProperty) {\n                // If the collection was already a CompositeProperty, use it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantProperty(combinedInterval.data);\n                }\n                property.intervals.addInterval(combinedInterval);\n            } else {\n                // Otherwise, create a CompositeProperty but preserve the existing data.\n                object[propertyName] = property = convertPropertyToComposite(property);\n\n                // Change the new data to a ConstantProperty and add it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantProperty(combinedInterval.data);\n                }\n                property.intervals.addInterval(combinedInterval);\n            }\n\n            return;\n        }\n\n        // isSampled && hasInterval\n        if (!defined(property)) {\n            object[propertyName] = property = new CompositeProperty();\n        }\n\n        // Create a CompositeProperty but preserve the existing data.\n        if (!(property instanceof CompositeProperty)) {\n            object[propertyName] = property = convertPropertyToComposite(property);\n        }\n\n        // Check if the interval already exists in the composite.\n        var intervals = property.intervals;\n        interval = intervals.findInterval(combinedInterval);\n        if (!defined(interval) || !(interval.data instanceof SampledProperty)) {\n            // If not, create a SampledProperty for it.\n            interval = combinedInterval.clone();\n            interval.data = new SampledProperty(type);\n            intervals.addInterval(interval);\n        }\n        interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n        updateInterpolationSettings(packetData, interval.data);\n    }\n\n    function removePropertyData(property, interval) {\n        if (property instanceof SampledProperty) {\n            property.removeSamples(interval);\n            return;\n        } else if (property instanceof TimeIntervalCollectionProperty) {\n            property.intervals.removeInterval(interval);\n            return;\n        } else if (property instanceof CompositeProperty) {\n            var intervals = property.intervals;\n            for (var i = 0; i < intervals.length; ++i) {\n                var intersection = TimeInterval.intersect(intervals.get(i), interval, scratchTimeInterval);\n                if (!intersection.isEmpty) {\n                    // remove data from the contained properties\n                    removePropertyData(intersection.data, interval);\n                }\n            }\n            // remove the intervals from the composite\n            intervals.removeInterval(interval);\n            return;\n        }\n    }\n\n    function processPacketData(type, object, propertyName, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                processProperty(type, object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n            }\n        } else {\n            processProperty(type, object, propertyName, packetData, interval, sourceUri, entityCollection);\n        }\n    }\n\n    function processPositionProperty(object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(packetData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var numberOfDerivatives = defined(packetData.cartesianVelocity) ? 1 : 0;\n        var packedLength = Cartesian3.packedLength * (numberOfDerivatives + 1);\n        var unwrappedInterval;\n        var unwrappedIntervalLength;\n        var isValue = !defined(packetData.reference);\n        var hasInterval = defined(combinedInterval) && !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n        if (packetData.delete === true) {\n            // If deleting this property for all time, we can simply set to undefined and return.\n            if (!hasInterval) {\n                object[propertyName] = undefined;\n                return;\n            }\n\n            // Deleting depends on the type of property we have.\n            return removePositionPropertyData(object[propertyName], combinedInterval);\n        }\n\n        var referenceFrame;\n        var isSampled = false;\n\n        if (isValue) {\n            if (defined(packetData.referenceFrame)) {\n                referenceFrame = ReferenceFrame[packetData.referenceFrame];\n            }\n            referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n            unwrappedInterval = unwrapCartesianInterval(packetData);\n            unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n            isSampled = unwrappedIntervalLength > packedLength;\n        }\n\n        // Any time a constant value is assigned, it completely blows away anything else.\n        if (!isSampled && !hasInterval) {\n            if (isValue) {\n                object[propertyName] = new ConstantPositionProperty(Cartesian3.unpack(unwrappedInterval), referenceFrame);\n            } else {\n                object[propertyName] = createReferenceProperty(entityCollection, packetData.reference);\n            }\n            return;\n        }\n\n        var property = object[propertyName];\n\n        var epoch;\n        var packetEpoch = packetData.epoch;\n        if (defined(packetEpoch)) {\n            epoch = JulianDate.fromIso8601(packetEpoch);\n        }\n\n        // Without an interval, any sampled value is infinite, meaning it completely\n        // replaces any non-sampled property that may exist.\n        if (isSampled && !hasInterval) {\n            if (!(property instanceof SampledPositionProperty) || (defined(referenceFrame) && property.referenceFrame !== referenceFrame)) {\n                object[propertyName] = property = new SampledPositionProperty(referenceFrame, numberOfDerivatives);\n            }\n            property.addSamplesPackedArray(unwrappedInterval, epoch);\n            updateInterpolationSettings(packetData, property);\n            return;\n        }\n\n        var interval;\n\n        // A constant value with an interval is normally part of a TimeIntervalCollection,\n        // However, if the current property is not a time-interval collection, we need\n        // to turn it into a Composite, preserving the old data with the new interval.\n        if (!isSampled && hasInterval) {\n            // Create a new interval for the constant value.\n            combinedInterval = combinedInterval.clone();\n            if (isValue) {\n                combinedInterval.data = Cartesian3.unpack(unwrappedInterval);\n            } else {\n                combinedInterval.data = createReferenceProperty(entityCollection, packetData.reference);\n            }\n\n            // If no property exists, simply use a new interval collection\n            if (!defined(property)) {\n                if (isValue) {\n                    property = new TimeIntervalCollectionPositionProperty(referenceFrame);\n                } else {\n                    property = new CompositePositionProperty(referenceFrame);\n                }\n                object[propertyName] = property;\n            }\n\n            if (isValue && property instanceof TimeIntervalCollectionPositionProperty && (defined(referenceFrame) && property.referenceFrame === referenceFrame)) {\n                // If we create a collection, or it already existed, use it.\n                property.intervals.addInterval(combinedInterval);\n            } else if (property instanceof CompositePositionProperty) {\n                // If the collection was already a CompositePositionProperty, use it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantPositionProperty(combinedInterval.data, referenceFrame);\n                }\n                property.intervals.addInterval(combinedInterval);\n            } else {\n                // Otherwise, create a CompositePositionProperty but preserve the existing data.\n                object[propertyName] = property = convertPositionPropertyToComposite(property);\n\n                // Change the new data to a ConstantPositionProperty and add it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantPositionProperty(combinedInterval.data, referenceFrame);\n                }\n                property.intervals.addInterval(combinedInterval);\n            }\n\n            return;\n        }\n\n        // isSampled && hasInterval\n        if (!defined(property)) {\n            object[propertyName] = property = new CompositePositionProperty(referenceFrame);\n        } else if (!(property instanceof CompositePositionProperty)) {\n            // Create a CompositeProperty but preserve the existing data.\n            object[propertyName] = property = convertPositionPropertyToComposite(property);\n        }\n\n        // Check if the interval already exists in the composite.\n        var intervals = property.intervals;\n        interval = intervals.findInterval(combinedInterval);\n        if (!defined(interval) || !(interval.data instanceof SampledPositionProperty) || (defined(referenceFrame) && interval.data.referenceFrame !== referenceFrame)) {\n            // If not, create a SampledPositionProperty for it.\n            interval = combinedInterval.clone();\n            interval.data = new SampledPositionProperty(referenceFrame, numberOfDerivatives);\n            intervals.addInterval(interval);\n        }\n        interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n        updateInterpolationSettings(packetData, interval.data);\n    }\n\n    function removePositionPropertyData(property, interval) {\n        if (property instanceof SampledPositionProperty) {\n            property.removeSamples(interval);\n            return;\n        } else if (property instanceof TimeIntervalCollectionPositionProperty) {\n            property.intervals.removeInterval(interval);\n            return;\n        } else if (property instanceof CompositePositionProperty) {\n            var intervals = property.intervals;\n            for (var i = 0; i < intervals.length; ++i) {\n                var intersection = TimeInterval.intersect(intervals.get(i), interval, scratchTimeInterval);\n                if (!intersection.isEmpty) {\n                    // remove data from the contained properties\n                    removePositionPropertyData(intersection.data, interval);\n                }\n            }\n            // remove the intervals from the composite\n            intervals.removeInterval(interval);\n            return;\n        }\n    }\n\n    function processPositionPacketData(object, propertyName, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                processPositionProperty(object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n            }\n        } else {\n            processPositionProperty(object, propertyName, packetData, interval, sourceUri, entityCollection);\n        }\n    }\n\n    function processMaterialProperty(object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(packetData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var property = object[propertyName];\n        var existingMaterial;\n        var existingInterval;\n\n        if (defined(combinedInterval)) {\n            if (!(property instanceof CompositeMaterialProperty)) {\n                property = new CompositeMaterialProperty();\n                object[propertyName] = property;\n            }\n            //See if we already have data at that interval.\n            var thisIntervals = property.intervals;\n            existingInterval = thisIntervals.findInterval({\n                start : combinedInterval.start,\n                stop : combinedInterval.stop\n            });\n            if (defined(existingInterval)) {\n                //We have an interval, but we need to make sure the\n                //new data is the same type of material as the old data.\n                existingMaterial = existingInterval.data;\n            } else {\n                //If not, create it.\n                existingInterval = combinedInterval.clone();\n                thisIntervals.addInterval(existingInterval);\n            }\n        } else {\n            existingMaterial = property;\n        }\n\n        var materialData;\n        if (defined(packetData.solidColor)) {\n            if (!(existingMaterial instanceof ColorMaterialProperty)) {\n                existingMaterial = new ColorMaterialProperty();\n            }\n            materialData = packetData.solidColor;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, undefined, entityCollection);\n        } else if (defined(packetData.grid)) {\n            if (!(existingMaterial instanceof GridMaterialProperty)) {\n                existingMaterial = new GridMaterialProperty();\n            }\n            materialData = packetData.grid;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'cellAlpha', materialData.cellAlpha, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'lineCount', materialData.lineCount, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'lineThickness', materialData.lineThickness, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'lineOffset', materialData.lineOffset, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.image)) {\n            if (!(existingMaterial instanceof ImageMaterialProperty)) {\n                existingMaterial = new ImageMaterialProperty();\n            }\n            materialData = packetData.image;\n            processPacketData(Image, existingMaterial, 'image', materialData.image, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'repeat', materialData.repeat, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Boolean, existingMaterial, 'transparent', materialData.transparent, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.stripe)) {\n            if (!(existingMaterial instanceof StripeMaterialProperty)) {\n                existingMaterial = new StripeMaterialProperty();\n            }\n            materialData = packetData.stripe;\n            processPacketData(StripeOrientation, existingMaterial, 'orientation', materialData.orientation, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'evenColor', materialData.evenColor, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'oddColor', materialData.oddColor, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'offset', materialData.offset, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'repeat', materialData.repeat, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.polylineOutline)) {\n            if (!(existingMaterial instanceof PolylineOutlineMaterialProperty)) {\n                existingMaterial = new PolylineOutlineMaterialProperty();\n            }\n            materialData = packetData.polylineOutline;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'outlineColor', materialData.outlineColor, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'outlineWidth', materialData.outlineWidth, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.polylineGlow)) {\n            if (!(existingMaterial instanceof PolylineGlowMaterialProperty)) {\n                existingMaterial = new PolylineGlowMaterialProperty();\n            }\n            materialData = packetData.polylineGlow;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'glowPower', materialData.glowPower, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'taperPower', materialData.taperPower, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.polylineArrow)) {\n            if (!(existingMaterial instanceof PolylineArrowMaterialProperty)) {\n                existingMaterial = new PolylineArrowMaterialProperty();\n            }\n            materialData = packetData.polylineArrow;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, undefined, entityCollection);\n        } else if (defined(packetData.polylineDash)) {\n            if (!(existingMaterial instanceof PolylineDashMaterialProperty)) {\n                existingMaterial = new PolylineDashMaterialProperty();\n            }\n            materialData = packetData.polylineDash;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, undefined, entityCollection);\n            processPacketData(Color, existingMaterial, 'gapColor', materialData.gapColor, undefined, undefined, entityCollection);\n            processPacketData(Number, existingMaterial, 'dashLength', materialData.dashLength, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'dashPattern', materialData.dashPattern, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.checkerboard)) {\n            if (!(existingMaterial instanceof CheckerboardMaterialProperty)) {\n                existingMaterial = new CheckerboardMaterialProperty();\n            }\n            materialData = packetData.checkerboard;\n            processPacketData(Color, existingMaterial, 'evenColor', materialData.evenColor, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'oddColor', materialData.oddColor, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'repeat', materialData.repeat, undefined, sourceUri, entityCollection);\n        }\n\n        if (defined(existingInterval)) {\n            existingInterval.data = existingMaterial;\n        } else {\n            object[propertyName] = existingMaterial;\n        }\n    }\n\n    function processMaterialPacketData(object, propertyName, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                processMaterialProperty(object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n            }\n        } else {\n            processMaterialProperty(object, propertyName, packetData, interval, sourceUri, entityCollection);\n        }\n    }\n\n    function processName(entity, packet, entityCollection, sourceUri) {\n        var nameData = packet.name;\n        if (defined(nameData)) {\n            entity.name = packet.name;\n        }\n    }\n\n    function processDescription(entity, packet, entityCollection, sourceUri) {\n        var descriptionData = packet.description;\n        if (defined(descriptionData)) {\n            processPacketData(String, entity, 'description', descriptionData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processPosition(entity, packet, entityCollection, sourceUri) {\n        var positionData = packet.position;\n        if (defined(positionData)) {\n            processPositionPacketData(entity, 'position', positionData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processViewFrom(entity, packet, entityCollection, sourceUri) {\n        var viewFromData = packet.viewFrom;\n        if (defined(viewFromData)) {\n            processPacketData(Cartesian3, entity, 'viewFrom', viewFromData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processOrientation(entity, packet, entityCollection, sourceUri) {\n        var orientationData = packet.orientation;\n        if (defined(orientationData)) {\n            processPacketData(Quaternion, entity, 'orientation', orientationData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processProperties(entity, packet, entityCollection, sourceUri) {\n        var propertiesData = packet.properties;\n        if (defined(propertiesData)) {\n            if (!defined(entity.properties)) {\n                entity.properties = new PropertyBag();\n            }\n\n            // We cannot simply call processPacketData(entity, 'properties', propertyData, undefined, sourceUri, entityCollection)\n            // because each property of \"properties\" may vary separately.\n            // The properties will be accessible as entity.properties.myprop.getValue(time).\n\n            for (var key in propertiesData) {\n                if (propertiesData.hasOwnProperty(key)) {\n                    if (!entity.properties.hasProperty(key)) {\n                        entity.properties.addProperty(key);\n                    }\n\n                    var propertyData = propertiesData[key];\n                    if (isArray(propertyData)) {\n                        for (var i = 0, len = propertyData.length; i < len; ++i) {\n                            processProperty(getPropertyType(propertyData[i]), entity.properties, key, propertyData[i], undefined, sourceUri, entityCollection);\n                        }\n                    } else {\n                        processProperty(getPropertyType(propertyData), entity.properties, key, propertyData, undefined, sourceUri, entityCollection);\n                    }\n                }\n            }\n        }\n    }\n\n    function processReferencesArrayPacketData(object, propertyName, references, interval, entityCollection, PropertyArrayType, CompositePropertyArrayType) {\n        var properties = references.map(function(reference) {\n            return createReferenceProperty(entityCollection, reference);\n        });\n\n        if (defined(interval)) {\n            interval = intervalFromString(interval);\n            var property = object[propertyName];\n            if (!(property instanceof CompositePropertyArrayType)) {\n                // If the property was not already a CompositeProperty,\n                // create a CompositeProperty but preserve the existing data.\n\n                // Create the composite and add the old property, wrapped in an infinite interval.\n                var composite = new CompositePropertyArrayType();\n                composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n\n                object[propertyName] = property = composite;\n            }\n\n            interval.data = new PropertyArrayType(properties);\n            property.intervals.addInterval(interval);\n        } else {\n            object[propertyName] = new PropertyArrayType(properties);\n        }\n    }\n\n    function processArrayPacketData(object, propertyName, packetData, entityCollection) {\n        var references = packetData.references;\n        if (defined(references)) {\n            processReferencesArrayPacketData(object, propertyName, references, packetData.interval, entityCollection, PropertyArray, CompositeProperty);\n        } else {\n            processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n        }\n    }\n\n    function processArray(object, propertyName, packetData, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, length = packetData.length; i < length; ++i) {\n                processArrayPacketData(object, propertyName, packetData[i], entityCollection);\n            }\n        } else {\n            processArrayPacketData(object, propertyName, packetData, entityCollection);\n        }\n    }\n\n    function processPositionArrayPacketData(object, propertyName, packetData, entityCollection) {\n        var references = packetData.references;\n        if (defined(references)) {\n            processReferencesArrayPacketData(object, propertyName, references, packetData.interval, entityCollection, PositionPropertyArray, CompositePositionProperty);\n        } else {\n            if (defined(packetData.cartesian)) {\n                packetData.array = Cartesian3.unpackArray(packetData.cartesian);\n            } else if (defined(packetData.cartographicRadians)) {\n                packetData.array = Cartesian3.fromRadiansArrayHeights(packetData.cartographicRadians);\n            } else if (defined(packetData.cartographicDegrees)) {\n                packetData.array = Cartesian3.fromDegreesArrayHeights(packetData.cartographicDegrees);\n            }\n\n            if (defined(packetData.array)) {\n                processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n            }\n        }\n    }\n\n    function processPositionArray(object, propertyName, packetData, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, length = packetData.length; i < length; ++i) {\n                processPositionArrayPacketData(object, propertyName, packetData[i], entityCollection);\n            }\n        } else {\n            processPositionArrayPacketData(object, propertyName, packetData, entityCollection);\n        }\n    }\n\n    function unpackCartesianArray(array) {\n        return Cartesian3.unpackArray(array);\n    }\n\n    function unpackCartographicRadiansArray(array) {\n        return Cartesian3.fromRadiansArrayHeights(array);\n    }\n\n    function unpackCartographicDegreesArray(array) {\n        return Cartesian3.fromDegreesArrayHeights(array);\n    }\n\n    function processPositionArrayOfArraysPacketData(object, propertyName, packetData, entityCollection) {\n        var references = packetData.references;\n        if (defined(references)) {\n            var properties = references.map(function(referenceArray) {\n                var tempObj = {};\n                processReferencesArrayPacketData(tempObj, 'positions', referenceArray, packetData.interval, entityCollection, PositionPropertyArray, CompositePositionProperty);\n                return tempObj.positions;\n            });\n            object[propertyName] = new PositionPropertyArray(properties);\n        } else {\n            if (defined(packetData.cartesian)) {\n                packetData.array = packetData.cartesian.map(unpackCartesianArray);\n            } else if (defined(packetData.cartographicRadians)) {\n                packetData.array = packetData.cartographicRadians.map(unpackCartographicRadiansArray);\n            } else if (defined(packetData.cartographicDegrees)) {\n                packetData.array = packetData.cartographicDegrees.map(unpackCartographicDegreesArray);\n            }\n\n            if (defined(packetData.array)) {\n                processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n            }\n        }\n    }\n\n    function processPositionArrayOfArrays(object, propertyName, packetData, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, length = packetData.length; i < length; ++i) {\n                processPositionArrayOfArraysPacketData(object, propertyName, packetData[i], entityCollection);\n            }\n        } else {\n            processPositionArrayOfArraysPacketData(object, propertyName, packetData, entityCollection);\n        }\n    }\n\n    function processAvailability(entity, packet, entityCollection, sourceUri) {\n        var packetData = packet.availability;\n        if (!defined(packetData)) {\n            return;\n        }\n\n        var intervals;\n        if (isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                if (!defined(intervals)) {\n                    intervals = new TimeIntervalCollection();\n                }\n                intervals.addInterval(intervalFromString(packetData[i]));\n            }\n        } else {\n            intervals = new TimeIntervalCollection();\n            intervals.addInterval(intervalFromString(packetData));\n        }\n        entity.availability = intervals;\n    }\n\n    function processAlignedAxis(billboard, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        processPacketData(UnitCartesian3, billboard, 'alignedAxis', packetData, interval, sourceUri, entityCollection);\n    }\n\n    function processBillboard(entity, packet, entityCollection, sourceUri) {\n        var billboardData = packet.billboard;\n        if (!defined(billboardData)) {\n            return;\n        }\n\n        var interval = intervalFromString(billboardData.interval);\n        var billboard = entity.billboard;\n        if (!defined(billboard)) {\n            entity.billboard = billboard = new BillboardGraphics();\n        }\n\n        processPacketData(Boolean, billboard, 'show', billboardData.show, interval, sourceUri, entityCollection);\n        processPacketData(Image, billboard, 'image', billboardData.image, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'scale', billboardData.scale, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian2, billboard, 'pixelOffset', billboardData.pixelOffset, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, billboard, 'eyeOffset', billboardData.eyeOffset, interval, sourceUri, entityCollection);\n        processPacketData(HorizontalOrigin, billboard, 'horizontalOrigin', billboardData.horizontalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(VerticalOrigin, billboard, 'verticalOrigin', billboardData.verticalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, billboard, 'heightReference', billboardData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, billboard, 'color', billboardData.color, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, billboard, 'rotation', billboardData.rotation, interval, sourceUri, entityCollection);\n        processAlignedAxis(billboard, billboardData.alignedAxis, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, billboard, 'sizeInMeters', billboardData.sizeInMeters, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'width', billboardData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'height', billboardData.height, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, billboard, 'scaleByDistance', billboardData.scaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, billboard, 'translucencyByDistance', billboardData.translucencyByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, billboard, 'pixelOffsetScaleByDistance', billboardData.pixelOffsetScaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(BoundingRectangle, billboard, 'imageSubRegion', billboardData.imageSubRegion, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, billboard, 'distanceDisplayCondition', billboardData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'disableDepthTestDistance', billboardData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n    }\n\n    function processBox(entity, packet, entityCollection, sourceUri) {\n        var boxData = packet.box;\n        if (!defined(boxData)) {\n            return;\n        }\n\n        var interval = intervalFromString(boxData.interval);\n        var box = entity.box;\n        if (!defined(box)) {\n            entity.box = box = new BoxGraphics();\n        }\n\n        processPacketData(Boolean, box, 'show', boxData.show, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, box, 'dimensions', boxData.dimensions, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, box, 'heightReference', boxData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, box, 'fill', boxData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(box, 'material', boxData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, box, 'outline', boxData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, box, 'outlineColor', boxData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, box, 'outlineWidth', boxData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, box, 'shadows', boxData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, box, 'distanceDisplayCondition', boxData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processCorridor(entity, packet, entityCollection, sourceUri) {\n        var corridorData = packet.corridor;\n        if (!defined(corridorData)) {\n            return;\n        }\n\n        var interval = intervalFromString(corridorData.interval);\n        var corridor = entity.corridor;\n        if (!defined(corridor)) {\n            entity.corridor = corridor = new CorridorGraphics();\n        }\n\n        processPacketData(Boolean, corridor, 'show', corridorData.show, interval, sourceUri, entityCollection);\n        processPositionArray(corridor, 'positions', corridorData.positions, entityCollection);\n        processPacketData(Number, corridor, 'width', corridorData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'height', corridorData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, corridor, 'heightReference', corridorData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'extrudedHeight', corridorData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, corridor, 'extrudedHeightReference', corridorData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(CornerType, corridor, 'cornerType', corridorData.cornerType, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'granularity', corridorData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, corridor, 'fill', corridorData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(corridor, 'material', corridorData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, corridor, 'outline', corridorData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, corridor, 'outlineColor', corridorData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'outlineWidth', corridorData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, corridor, 'shadows', corridorData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, corridor, 'distanceDisplayCondition', corridorData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, corridor, 'classificationType', corridorData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'zIndex', corridorData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function processCylinder(entity, packet, entityCollection, sourceUri) {\n        var cylinderData = packet.cylinder;\n        if (!defined(cylinderData)) {\n            return;\n        }\n\n        var interval = intervalFromString(cylinderData.interval);\n        var cylinder = entity.cylinder;\n        if (!defined(cylinder)) {\n            entity.cylinder = cylinder = new CylinderGraphics();\n        }\n\n        processPacketData(Boolean, cylinder, 'show', cylinderData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'length', cylinderData.length, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'topRadius', cylinderData.topRadius, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'bottomRadius', cylinderData.bottomRadius, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, cylinder, 'heightReference', cylinderData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, cylinder, 'fill', cylinderData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(cylinder, 'material', cylinderData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, cylinder, 'outline', cylinderData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, cylinder, 'outlineColor', cylinderData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'outlineWidth', cylinderData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'numberOfVerticalLines', cylinderData.numberOfVerticalLines, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'slices', cylinderData.slices, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, cylinder, 'shadows', cylinderData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, cylinder, 'distanceDisplayCondition', cylinderData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processDocument(packet, dataSource) {\n        var version = packet.version;\n        if (defined(version)) {\n            if (typeof version === 'string') {\n                var tokens = version.split('.');\n                if (tokens.length === 2) {\n                    if (tokens[0] !== '1') {\n                        throw new RuntimeError('Cesium only supports CZML version 1.');\n                    }\n                    dataSource._version = version;\n                }\n            }\n        }\n\n        if (!defined(dataSource._version)) {\n            throw new RuntimeError('CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.');\n        }\n\n        var documentPacket = dataSource._documentPacket;\n\n        if (defined(packet.name)) {\n            documentPacket.name = packet.name;\n        }\n\n        var clockPacket = packet.clock;\n        if (defined(clockPacket)) {\n            var clock = documentPacket.clock;\n            if (!defined(clock)) {\n                documentPacket.clock = {\n                    interval : clockPacket.interval,\n                    currentTime : clockPacket.currentTime,\n                    range : clockPacket.range,\n                    step : clockPacket.step,\n                    multiplier : clockPacket.multiplier\n                };\n            } else {\n                clock.interval = defaultValue(clockPacket.interval, clock.interval);\n                clock.currentTime = defaultValue(clockPacket.currentTime, clock.currentTime);\n                clock.range = defaultValue(clockPacket.range, clock.range);\n                clock.step = defaultValue(clockPacket.step, clock.step);\n                clock.multiplier = defaultValue(clockPacket.multiplier, clock.multiplier);\n            }\n        }\n    }\n\n    function processEllipse(entity, packet, entityCollection, sourceUri) {\n        var ellipseData = packet.ellipse;\n        if (!defined(ellipseData)) {\n            return;\n        }\n\n        var interval = intervalFromString(ellipseData.interval);\n        var ellipse = entity.ellipse;\n        if (!defined(ellipse)) {\n            entity.ellipse = ellipse = new EllipseGraphics();\n        }\n\n        processPacketData(Boolean, ellipse, 'show', ellipseData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'semiMajorAxis', ellipseData.semiMajorAxis, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'semiMinorAxis', ellipseData.semiMinorAxis, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'height', ellipseData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, ellipse, 'heightReference', ellipseData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'extrudedHeight', ellipseData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, ellipse, 'extrudedHeightReference', ellipseData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, ellipse, 'rotation', ellipseData.rotation, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, ellipse, 'stRotation', ellipseData.stRotation, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'granularity', ellipseData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipse, 'fill', ellipseData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(ellipse, 'material', ellipseData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipse, 'outline', ellipseData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, ellipse, 'outlineColor', ellipseData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'outlineWidth', ellipseData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'numberOfVerticalLines', ellipseData.numberOfVerticalLines, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, ellipse, 'shadows', ellipseData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, ellipse, 'distanceDisplayCondition', ellipseData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, ellipse, 'classificationType', ellipseData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'zIndex', ellipseData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function processEllipsoid(entity, packet, entityCollection, sourceUri) {\n        var ellipsoidData = packet.ellipsoid;\n        if (!defined(ellipsoidData)) {\n            return;\n        }\n\n        var interval = intervalFromString(ellipsoidData.interval);\n        var ellipsoid = entity.ellipsoid;\n        if (!defined(ellipsoid)) {\n            entity.ellipsoid = ellipsoid = new EllipsoidGraphics();\n        }\n\n        processPacketData(Boolean, ellipsoid, 'show', ellipsoidData.show, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, ellipsoid, 'radii', ellipsoidData.radii, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, ellipsoid, 'innerRadii', ellipsoidData.innerRadii, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'minimumClock', ellipsoidData.minimumClock, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'maximumClock', ellipsoidData.maximumClock, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'minimumCone', ellipsoidData.minimumCone, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'maximumCone', ellipsoidData.maximumCone, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, ellipsoid, 'heightReference', ellipsoidData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipsoid, 'fill', ellipsoidData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(ellipsoid, 'material', ellipsoidData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipsoid, 'outline', ellipsoidData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, ellipsoid, 'outlineColor', ellipsoidData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'outlineWidth', ellipsoidData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'stackPartitions', ellipsoidData.stackPartitions, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'slicePartitions', ellipsoidData.slicePartitions, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'subdivisions', ellipsoidData.subdivisions, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, ellipsoid, 'shadows', ellipsoidData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, ellipsoid, 'distanceDisplayCondition', ellipsoidData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processLabel(entity, packet, entityCollection, sourceUri) {\n        var labelData = packet.label;\n        if (!defined(labelData)) {\n            return;\n        }\n\n        var interval = intervalFromString(labelData.interval);\n        var label = entity.label;\n        if (!defined(label)) {\n            entity.label = label = new LabelGraphics();\n        }\n\n        processPacketData(Boolean, label, 'show', labelData.show, interval, sourceUri, entityCollection);\n        processPacketData(String, label, 'text', labelData.text, interval, sourceUri, entityCollection);\n        processPacketData(String, label, 'font', labelData.font, interval, sourceUri, entityCollection);\n        processPacketData(LabelStyle, label, 'style', labelData.style, interval, sourceUri, entityCollection);\n        processPacketData(Number, label, 'scale', labelData.scale, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, label, 'showBackground', labelData.showBackground, interval, sourceUri, entityCollection);\n        processPacketData(Color, label, 'backgroundColor', labelData.backgroundColor, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian2, label, 'backgroundPadding', labelData.backgroundPadding, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian2, label, 'pixelOffset', labelData.pixelOffset, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, label, 'eyeOffset', labelData.eyeOffset, interval, sourceUri, entityCollection);\n        processPacketData(HorizontalOrigin, label, 'horizontalOrigin', labelData.horizontalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(VerticalOrigin, label, 'verticalOrigin', labelData.verticalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, label, 'heightReference', labelData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, label, 'fillColor', labelData.fillColor, interval, sourceUri, entityCollection);\n        processPacketData(Color, label, 'outlineColor', labelData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, label, 'outlineWidth', labelData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, label, 'translucencyByDistance', labelData.translucencyByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, label, 'pixelOffsetScaleByDistance', labelData.pixelOffsetScaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, label, 'scaleByDistance', labelData.scaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, label, 'distanceDisplayCondition', labelData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(Number, label, 'disableDepthTestDistance', labelData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n    }\n\n    function processModel(entity, packet, entityCollection, sourceUri) {\n        var modelData = packet.model;\n        if (!defined(modelData)) {\n            return;\n        }\n\n        var interval = intervalFromString(modelData.interval);\n        var model = entity.model;\n        if (!defined(model)) {\n            entity.model = model = new ModelGraphics();\n        }\n\n        processPacketData(Boolean, model, 'show', modelData.show, interval, sourceUri, entityCollection);\n        processPacketData(Uri, model, 'uri', modelData.gltf, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'scale', modelData.scale, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'minimumPixelSize', modelData.minimumPixelSize, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'maximumScale', modelData.maximumScale, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, model, 'incrementallyLoadTextures', modelData.incrementallyLoadTextures, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, model, 'runAnimations', modelData.runAnimations, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, model, 'clampAnimations', modelData.clampAnimations, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, model, 'shadows', modelData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, model, 'heightReference', modelData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, model, 'silhouetteColor', modelData.silhouetteColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'silhouetteSize', modelData.silhouetteSize, interval, sourceUri, entityCollection);\n        processPacketData(Color, model, 'color', modelData.color, interval, sourceUri, entityCollection);\n        processPacketData(ColorBlendMode, model, 'colorBlendMode', modelData.colorBlendMode, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'colorBlendAmount', modelData.colorBlendAmount, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, model, 'distanceDisplayCondition', modelData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n\n        var i, len;\n        var nodeTransformationsData = modelData.nodeTransformations;\n        if (defined(nodeTransformationsData)) {\n            if (isArray(nodeTransformationsData)) {\n                for (i = 0, len = nodeTransformationsData.length; i < len; ++i) {\n                    processNodeTransformations(model, nodeTransformationsData[i], interval, sourceUri, entityCollection);\n                }\n            } else {\n                processNodeTransformations(model, nodeTransformationsData, interval, sourceUri, entityCollection);\n            }\n        }\n\n        var articulationsData = modelData.articulations;\n        if (defined(articulationsData)) {\n            if (isArray(articulationsData)) {\n                for (i = 0, len = articulationsData.length; i < len; ++i) {\n                    processArticulations(model, articulationsData[i], interval, sourceUri, entityCollection);\n                }\n            } else {\n                processArticulations(model, articulationsData, interval, sourceUri, entityCollection);\n            }\n        }\n    }\n\n    function processNodeTransformations(model, nodeTransformationsData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(nodeTransformationsData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var nodeTransformations = model.nodeTransformations;\n        var nodeNames = Object.keys(nodeTransformationsData);\n        for (var i = 0, len = nodeNames.length; i < len; ++i) {\n            var nodeName = nodeNames[i];\n            if (nodeName === 'interval') {\n                continue;\n            }\n\n            var nodeTransformationData = nodeTransformationsData[nodeName];\n            if (!defined(nodeTransformationData)) {\n                continue;\n            }\n\n            if (!defined(nodeTransformations)) {\n                model.nodeTransformations = nodeTransformations = new PropertyBag();\n            }\n\n            if (!nodeTransformations.hasProperty(nodeName)) {\n                nodeTransformations.addProperty(nodeName);\n            }\n\n            var nodeTransformation = nodeTransformations[nodeName];\n            if (!defined(nodeTransformation)) {\n                nodeTransformations[nodeName] = nodeTransformation = new NodeTransformationProperty();\n            }\n\n            processPacketData(Cartesian3, nodeTransformation, 'translation', nodeTransformationData.translation, combinedInterval, sourceUri, entityCollection);\n            processPacketData(Quaternion, nodeTransformation, 'rotation', nodeTransformationData.rotation, combinedInterval, sourceUri, entityCollection);\n            processPacketData(Cartesian3, nodeTransformation, 'scale', nodeTransformationData.scale, combinedInterval, sourceUri, entityCollection);\n        }\n    }\n\n    function processArticulations(model, articulationsData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(articulationsData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var articulations = model.articulations;\n        var keys = Object.keys(articulationsData);\n        for (var i = 0, len = keys.length; i < len; ++i) {\n            var key = keys[i];\n            if (key === 'interval') {\n                continue;\n            }\n\n            var articulationStageData = articulationsData[key];\n            if (!defined(articulationStageData)) {\n                continue;\n            }\n\n            if (!defined(articulations)) {\n                model.articulations = articulations = new PropertyBag();\n            }\n\n            if (!articulations.hasProperty(key)) {\n                articulations.addProperty(key);\n            }\n\n            processPacketData(Number, articulations, key, articulationStageData, combinedInterval, sourceUri, entityCollection);\n        }\n    }\n\n    function processPath(entity, packet, entityCollection, sourceUri) {\n        var pathData = packet.path;\n        if (!defined(pathData)) {\n            return;\n        }\n\n        var interval = intervalFromString(pathData.interval);\n        var path = entity.path;\n        if (!defined(path)) {\n            entity.path = path = new PathGraphics();\n        }\n\n        processPacketData(Boolean, path, 'show', pathData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'leadTime', pathData.leadTime, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'trailTime', pathData.trailTime, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'width', pathData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'resolution', pathData.resolution, interval, sourceUri, entityCollection);\n        processMaterialPacketData(path, 'material', pathData.material, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, path, 'distanceDisplayCondition', pathData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processPoint(entity, packet, entityCollection, sourceUri) {\n        var pointData = packet.point;\n        if (!defined(pointData)) {\n            return;\n        }\n\n        var interval = intervalFromString(pointData.interval);\n        var point = entity.point;\n        if (!defined(point)) {\n            entity.point = point = new PointGraphics();\n        }\n\n        processPacketData(Boolean, point, 'show', pointData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, point, 'pixelSize', pointData.pixelSize, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, point, 'heightReference', pointData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, point, 'color', pointData.color, interval, sourceUri, entityCollection);\n        processPacketData(Color, point, 'outlineColor', pointData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, point, 'outlineWidth', pointData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, point, 'scaleByDistance', pointData.scaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, point, 'translucencyByDistance', pointData.translucencyByDistance, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, point, 'distanceDisplayCondition', pointData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(Number, point, 'disableDepthTestDistance', pointData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n    }\n\n    function PolygonHierarchyProperty(polygon) {\n        this.polygon = polygon;\n        this._definitionChanged = new Event();\n    }\n\n    defineProperties(PolygonHierarchyProperty.prototype, {\n        isConstant : {\n            get : function() {\n                var positions = this.polygon._positions;\n                var holes = this.polygon._holes;\n                return (!defined(positions) || positions.isConstant) &&\n                       (!defined(holes) || holes.isConstant);\n            }\n        },\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        }\n    });\n\n    PolygonHierarchyProperty.prototype.getValue = function(time, result) {\n        var positions;\n        if (defined(this.polygon._positions)) {\n            positions = this.polygon._positions.getValue(time);\n        }\n\n        var holes;\n        if (defined(this.polygon._holes)) {\n            holes = this.polygon._holes.getValue(time);\n            if (defined(holes)) {\n                holes = holes.map(function(holePositions) {\n                    return new PolygonHierarchy(holePositions);\n                });\n            }\n        }\n\n        if (!defined(result)) {\n            return new PolygonHierarchy(positions, holes);\n        }\n\n        result.positions = positions;\n        result.holes = holes;\n        return result;\n    };\n\n    PolygonHierarchyProperty.prototype.equals = function(other) {\n        return this === other ||\n               (other instanceof PolygonHierarchyProperty &&\n                Property.equals(this.polygon._positions, other.polygon._positions) &&\n                Property.equals(this.polygon._holes, other.polygon._holes));\n    };\n\n    function processPolygon(entity, packet, entityCollection, sourceUri) {\n        var polygonData = packet.polygon;\n        if (!defined(polygonData)) {\n            return;\n        }\n\n        var interval = intervalFromString(polygonData.interval);\n        var polygon = entity.polygon;\n        if (!defined(polygon)) {\n            entity.polygon = polygon = new PolygonGraphics();\n        }\n\n        processPacketData(Boolean, polygon, 'show', polygonData.show, interval, sourceUri, entityCollection);\n\n        // adapt 'position' property producing Cartesian[]\n        // and 'holes' property producing Cartesian[][]\n        // to a single property producing PolygonHierarchy\n        processPositionArray(polygon, '_positions', polygonData.positions, entityCollection);\n        processPositionArrayOfArrays(polygon, '_holes', polygonData.holes, entityCollection);\n        if (defined(polygon._positions) || defined(polygon._holes)) {\n            polygon.hierarchy = new PolygonHierarchyProperty(polygon);\n        }\n\n        processPacketData(Number, polygon, 'height', polygonData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, polygon, 'heightReference', polygonData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'extrudedHeight', polygonData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, polygon, 'extrudedHeightReference', polygonData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, polygon, 'stRotation', polygonData.stRotation, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'granularity', polygonData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'fill', polygonData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(polygon, 'material', polygonData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'outline', polygonData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, polygon, 'outlineColor', polygonData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'outlineWidth', polygonData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'perPositionHeight', polygonData.perPositionHeight, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'closeTop', polygonData.closeTop, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'closeBottom', polygonData.closeBottom, interval, sourceUri, entityCollection);\n        processPacketData(ArcType, polygon, 'arcType', polygonData.arcType, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, polygon, 'shadows', polygonData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, polygon, 'distanceDisplayCondition', polygonData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, polygon, 'classificationType', polygonData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'zIndex', polygonData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function adaptFollowSurfaceToArcType(followSurface) {\n        return followSurface ? ArcType.GEODESIC : ArcType.NONE;\n    }\n\n    function processPolyline(entity, packet, entityCollection, sourceUri) {\n        var polylineData = packet.polyline;\n        if (!defined(polylineData)) {\n            return;\n        }\n\n        var interval = intervalFromString(polylineData.interval);\n        var polyline = entity.polyline;\n        if (!defined(polyline)) {\n            entity.polyline = polyline = new PolylineGraphics();\n        }\n\n        processPacketData(Boolean, polyline, 'show', polylineData.show, interval, sourceUri, entityCollection);\n        processPositionArray(polyline, 'positions', polylineData.positions, entityCollection);\n        processPacketData(Number, polyline, 'width', polylineData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, polyline, 'granularity', polylineData.granularity, interval, sourceUri, entityCollection);\n        processMaterialPacketData(polyline, 'material', polylineData.material, interval, sourceUri, entityCollection);\n        processMaterialPacketData(polyline, 'depthFailMaterial', polylineData.depthFailMaterial, interval, sourceUri, entityCollection);\n        processPacketData(ArcType, polyline, 'arcType', polylineData.arcType, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polyline, 'clampToGround', polylineData.clampToGround, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, polyline, 'shadows', polylineData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, polyline, 'distanceDisplayCondition', polylineData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, polyline, 'classificationType', polylineData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, polyline, 'zIndex', polylineData.zIndex, interval, sourceUri, entityCollection);\n\n        // for backwards compatibility, adapt CZML followSurface to arcType.\n        if (defined(polylineData.followSurface) && !defined(polylineData.arcType)) {\n            var tempObj = {};\n            processPacketData(Boolean, tempObj, 'followSurface', polylineData.followSurface, interval, sourceUri, entityCollection);\n            polyline.arcType = createAdapterProperty(tempObj.followSurface, adaptFollowSurfaceToArcType);\n        }\n    }\n\n    function processRectangle(entity, packet, entityCollection, sourceUri) {\n        var rectangleData = packet.rectangle;\n        if (!defined(rectangleData)) {\n            return;\n        }\n\n        var interval = intervalFromString(rectangleData.interval);\n        var rectangle = entity.rectangle;\n        if (!defined(rectangle)) {\n            entity.rectangle = rectangle = new RectangleGraphics();\n        }\n\n        processPacketData(Boolean, rectangle, 'show', rectangleData.show, interval, sourceUri, entityCollection);\n        processPacketData(Rectangle, rectangle, 'coordinates', rectangleData.coordinates, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'height', rectangleData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, rectangle, 'heightReference', rectangleData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'extrudedHeight', rectangleData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, rectangle, 'extrudedHeightReference', rectangleData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, rectangle, 'rotation', rectangleData.rotation, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, rectangle, 'stRotation', rectangleData.stRotation, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'granularity', rectangleData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, rectangle, 'fill', rectangleData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(rectangle, 'material', rectangleData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, rectangle, 'outline', rectangleData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, rectangle, 'outlineColor', rectangleData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'outlineWidth', rectangleData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, rectangle, 'shadows', rectangleData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, rectangle, 'distanceDisplayCondition', rectangleData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, rectangle, 'classificationType', rectangleData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'zIndex', rectangleData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function processWall(entity, packet, entityCollection, sourceUri) {\n        var wallData = packet.wall;\n        if (!defined(wallData)) {\n            return;\n        }\n\n        var interval = intervalFromString(wallData.interval);\n        var wall = entity.wall;\n        if (!defined(wall)) {\n            entity.wall = wall = new WallGraphics();\n        }\n\n        processPacketData(Boolean, wall, 'show', wallData.show, interval, sourceUri, entityCollection);\n        processPositionArray(wall, 'positions', wallData.positions, entityCollection);\n        processArray(wall, 'minimumHeights', wallData.minimumHeights, entityCollection);\n        processArray(wall, 'maximumHeights', wallData.maximumHeights, entityCollection);\n        processPacketData(Number, wall, 'granularity', wallData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, wall, 'fill', wallData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(wall, 'material', wallData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, wall, 'outline', wallData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, wall, 'outlineColor', wallData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, wall, 'outlineWidth', wallData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, wall, 'shadows', wallData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, wall, 'distanceDisplayCondition', wallData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processCzmlPacket(packet, entityCollection, updaterFunctions, sourceUri, dataSource) {\n        var objectId = packet.id;\n        if (!defined(objectId)) {\n            objectId = createGuid();\n        }\n\n        currentId = objectId;\n\n        if (!defined(dataSource._version) && objectId !== 'document') {\n            throw new RuntimeError('The first CZML packet is required to be the document object.');\n        }\n\n        if (packet['delete'] === true) {\n            entityCollection.removeById(objectId);\n        } else if (objectId === 'document') {\n            processDocument(packet, dataSource);\n        } else {\n            var entity = entityCollection.getOrCreateEntity(objectId);\n\n            var parentId = packet.parent;\n            if (defined(parentId)) {\n                entity.parent = entityCollection.getOrCreateEntity(parentId);\n            }\n\n            for (var i = updaterFunctions.length - 1; i > -1; i--) {\n                updaterFunctions[i](entity, packet, entityCollection, sourceUri);\n            }\n        }\n\n        currentId = undefined;\n    }\n\n    function updateClock(dataSource) {\n        var clock;\n        var clockPacket = dataSource._documentPacket.clock;\n        if (!defined(clockPacket)) {\n            if (!defined(dataSource._clock)) {\n                var availability = dataSource._entityCollection.computeAvailability();\n                if (!availability.start.equals(Iso8601.MINIMUM_VALUE)) {\n                    var startTime = availability.start;\n                    var stopTime = availability.stop;\n                    var totalSeconds = JulianDate.secondsDifference(stopTime, startTime);\n                    var multiplier = Math.round(totalSeconds / 120.0);\n\n                    clock = new DataSourceClock();\n                    clock.startTime = JulianDate.clone(startTime);\n                    clock.stopTime = JulianDate.clone(stopTime);\n                    clock.clockRange = ClockRange.LOOP_STOP;\n                    clock.multiplier = multiplier;\n                    clock.currentTime = JulianDate.clone(startTime);\n                    clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n                    dataSource._clock = clock;\n                    return true;\n                }\n            }\n            return false;\n        }\n\n        if (defined(dataSource._clock)) {\n            clock = dataSource._clock.clone();\n        } else {\n            clock = new DataSourceClock();\n            clock.startTime = Iso8601.MINIMUM_VALUE.clone();\n            clock.stopTime = Iso8601.MAXIMUM_VALUE.clone();\n            clock.currentTime = Iso8601.MINIMUM_VALUE.clone();\n            clock.clockRange = ClockRange.LOOP_STOP;\n            clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n            clock.multiplier = 1.0;\n        }\n\n        var interval = intervalFromString(clockPacket.interval);\n        if (defined(interval)) {\n            clock.startTime = interval.start;\n            clock.stopTime = interval.stop;\n        }\n\n        if (defined(clockPacket.currentTime)) {\n            clock.currentTime = JulianDate.fromIso8601(clockPacket.currentTime);\n        }\n        if (defined(clockPacket.range)) {\n            clock.clockRange = defaultValue(ClockRange[clockPacket.range], ClockRange.LOOP_STOP);\n        }\n        if (defined(clockPacket.step)) {\n            clock.clockStep = defaultValue(ClockStep[clockPacket.step], ClockStep.SYSTEM_CLOCK_MULTIPLIER);\n        }\n        if (defined(clockPacket.multiplier)) {\n            clock.multiplier = clockPacket.multiplier;\n        }\n\n        if (!clock.equals(dataSource._clock)) {\n            dataSource._clock = clock.clone(dataSource._clock);\n            return true;\n        }\n\n        return false;\n    }\n\n    function load(dataSource, czml, options, clear) {\n        \n\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        var promise = czml;\n        var sourceUri = options.sourceUri;\n\n        // User specified credit\n        var credit = options.credit;\n        if (typeof credit === 'string') {\n            credit = new Credit(credit);\n        }\n        dataSource._credit = credit;\n\n        // If the czml is a URL\n        if (typeof czml === 'string' || (czml instanceof Resource)) {\n            czml = Resource.createIfNeeded(czml);\n            promise = czml.fetchJson();\n            sourceUri = defaultValue(sourceUri, czml.clone());\n\n            // Add resource credits to our list of credits to display\n            var resourceCredits = dataSource._resourceCredits;\n            var credits = czml.credits;\n            if (defined(credits)) {\n                var length = credits.length;\n                for (var i = 0; i < length; i++) {\n                    resourceCredits.push(credits[i]);\n                }\n            }\n        }\n\n        sourceUri = Resource.createIfNeeded(sourceUri);\n\n        DataSource.setLoading(dataSource, true);\n\n        return when(promise, function(czml) {\n            return loadCzml(dataSource, czml, sourceUri, clear);\n        }).otherwise(function(error) {\n            DataSource.setLoading(dataSource, false);\n            dataSource._error.raiseEvent(dataSource, error);\n            console.log(error);\n            return when.reject(error);\n        });\n    }\n\n    function loadCzml(dataSource, czml, sourceUri, clear) {\n        DataSource.setLoading(dataSource, true);\n        var entityCollection = dataSource._entityCollection;\n\n        if (clear) {\n            dataSource._version = undefined;\n            dataSource._documentPacket = new DocumentPacket();\n            entityCollection.removeAll();\n        }\n\n        CzmlDataSource._processCzml(czml, entityCollection, sourceUri, undefined, dataSource);\n\n        var raiseChangedEvent = updateClock(dataSource);\n\n        var documentPacket = dataSource._documentPacket;\n        if (defined(documentPacket.name) && dataSource._name !== documentPacket.name) {\n            dataSource._name = documentPacket.name;\n            raiseChangedEvent = true;\n        } else if (!defined(dataSource._name) && defined(sourceUri)) {\n            dataSource._name = getFilenameFromUri(sourceUri.getUrlComponent());\n            raiseChangedEvent = true;\n        }\n\n        DataSource.setLoading(dataSource, false);\n        if (raiseChangedEvent) {\n            dataSource._changed.raiseEvent(dataSource);\n        }\n\n        return dataSource;\n    }\n\n    function DocumentPacket() {\n        this.name = undefined;\n        this.clock = undefined;\n    }\n\n    /**\n     * A {@link DataSource} which processes {@link https://github.com/AnalyticalGraphicsInc/czml-writer/wiki/CZML-Guide|CZML}.\n     * @alias CzmlDataSource\n     * @constructor\n     *\n     * @param {String} [name] An optional name for the data source.  This value will be overwritten if a loaded document contains a name.\n     *\n     * @demo {@link https://sandcastle.cesium.com/index.html?src=CZML.html|Cesium Sandcastle CZML Demo}\n     */\n    function CzmlDataSource(name) {\n        this._name = name;\n        this._changed = new Event();\n        this._error = new Event();\n        this._isLoading = false;\n        this._loading = new Event();\n        this._clock = undefined;\n        this._documentPacket = new DocumentPacket();\n        this._version = undefined;\n        this._entityCollection = new EntityCollection(this);\n        this._entityCluster = new EntityCluster();\n        this._credit = undefined;\n        this._resourceCredits = [];\n    }\n\n    /**\n     * Creates a Promise to a new instance loaded with the provided CZML data.\n     *\n     * @param {Resource|String|Object} czml A url or CZML object to be processed.\n     * @param {Object} [options] An object with the following properties:\n     * @param {Resource|String} [options.sourceUri] Overrides the url to use for resolving relative links.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     * @returns {Promise.<CzmlDataSource>} A promise that resolves to the new instance once the data is processed.\n     */\n    CzmlDataSource.load = function(czml, options) {\n        return new CzmlDataSource().load(czml, options);\n    };\n\n    defineProperties(CzmlDataSource.prototype, {\n        /**\n         * Gets a human-readable name for this instance.\n         * @memberof CzmlDataSource.prototype\n         * @type {String}\n         */\n        name : {\n            get : function() {\n                return this._name;\n            }\n        },\n        /**\n         * Gets the clock settings defined by the loaded CZML.  If no clock is explicitly\n         * defined in the CZML, the combined availability of all objects is returned.  If\n         * only static data exists, this value is undefined.\n         * @memberof CzmlDataSource.prototype\n         * @type {DataSourceClock}\n         */\n        clock : {\n            get : function() {\n                return this._clock;\n            }\n        },\n        /**\n         * Gets the collection of {@link Entity} instances.\n         * @memberof CzmlDataSource.prototype\n         * @type {EntityCollection}\n         */\n        entities : {\n            get : function() {\n                return this._entityCollection;\n            }\n        },\n        /**\n         * Gets a value indicating if the data source is currently loading data.\n         * @memberof CzmlDataSource.prototype\n         * @type {Boolean}\n         */\n        isLoading : {\n            get : function() {\n                return this._isLoading;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the underlying data changes.\n         * @memberof CzmlDataSource.prototype\n         * @type {Event}\n         */\n        changedEvent : {\n            get : function() {\n                return this._changed;\n            }\n        },\n        /**\n         * Gets an event that will be raised if an error is encountered during processing.\n         * @memberof CzmlDataSource.prototype\n         * @type {Event}\n         */\n        errorEvent : {\n            get : function() {\n                return this._error;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source either starts or stops loading.\n         * @memberof CzmlDataSource.prototype\n         * @type {Event}\n         */\n        loadingEvent : {\n            get : function() {\n                return this._loading;\n            }\n        },\n        /**\n         * Gets whether or not this data source should be displayed.\n         * @memberof CzmlDataSource.prototype\n         * @type {Boolean}\n         */\n        show : {\n            get : function() {\n                return this._entityCollection.show;\n            },\n            set : function(value) {\n                this._entityCollection.show = value;\n            }\n        },\n\n        /**\n         * Gets or sets the clustering options for this data source. This object can be shared between multiple data sources.\n         *\n         * @memberof CzmlDataSource.prototype\n         * @type {EntityCluster}\n         */\n        clustering : {\n            get : function() {\n                return this._entityCluster;\n            },\n            set : function(value) {\n                \n                this._entityCluster = value;\n            }\n        },\n        /**\n         * Gets the credit that will be displayed for the data source\n         * @memberof CzmlDataSource.prototype\n         * @type {Credit}\n         */\n        credit : {\n            get : function() {\n                return this._credit;\n            }\n        }\n    });\n\n    /**\n     * Gets the array of CZML processing functions.\n     * @memberof CzmlDataSource\n     * @type Array\n     */\n    CzmlDataSource.updaters = [\n        processBillboard, //\n        processBox, //\n        processCorridor, //\n        processCylinder, //\n        processEllipse, //\n        processEllipsoid, //\n        processLabel, //\n        processModel, //\n        processName, //\n        processDescription, //\n        processPath, //\n        processPoint, //\n        processPolygon, //\n        processPolyline, //\n        processProperties, //\n        processRectangle, //\n        processPosition, //\n        processViewFrom, //\n        processWall, //\n        processOrientation, //\n        processAvailability];\n\n    /**\n     * Processes the provided url or CZML object without clearing any existing data.\n     *\n     * @param {Resource|String|Object} czml A url or CZML object to be processed.\n     * @param {Object} [options] An object with the following properties:\n     * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links.\n     * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n     */\n    CzmlDataSource.prototype.process = function(czml, options) {\n        return load(this, czml, options, false);\n    };\n\n    /**\n     * Loads the provided url or CZML object, replacing any existing data.\n     *\n     * @param {Resource|String|Object} czml A url or CZML object to be processed.\n     * @param {Object} [options] An object with the following properties:\n     * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n     */\n    CzmlDataSource.prototype.load = function(czml, options) {\n        return load(this, czml, options, true);\n    };\n\n    /**\n     * A helper function used by custom CZML updater functions\n     * which creates or updates a {@link Property} from a CZML packet.\n     * @function\n     *\n     * @param {Function} type The constructor function for the property being processed.\n     * @param {Object} object The object on which the property will be added or updated.\n     * @param {String} propertyName The name of the property on the object.\n     * @param {Object} packetData The CZML packet being processed.\n     * @param {TimeInterval} interval A constraining interval for which the data is valid.\n     * @param {String} sourceUri The originating uri of the data being processed.\n     * @param {EntityCollection} entityCollection The collection being processsed.\n     */\n    CzmlDataSource.processPacketData = processPacketData;\n\n    /**\n     * A helper function used by custom CZML updater functions\n     * which creates or updates a {@link PositionProperty} from a CZML packet.\n     * @function\n     *\n     * @param {Object} object The object on which the property will be added or updated.\n     * @param {String} propertyName The name of the property on the object.\n     * @param {Object} packetData The CZML packet being processed.\n     * @param {TimeInterval} interval A constraining interval for which the data is valid.\n     * @param {String} sourceUri The originating uri of the data being processed.\n     * @param {EntityCollection} entityCollection The collection being processsed.\n     */\n    CzmlDataSource.processPositionPacketData = processPositionPacketData;\n\n    /**\n     * A helper function used by custom CZML updater functions\n     * which creates or updates a {@link MaterialProperty} from a CZML packet.\n     * @function\n     *\n     * @param {Object} object The object on which the property will be added or updated.\n     * @param {String} propertyName The name of the property on the object.\n     * @param {Object} packetData The CZML packet being processed.\n     * @param {TimeInterval} interval A constraining interval for which the data is valid.\n     * @param {String} sourceUri The originating uri of the data being processed.\n     * @param {EntityCollection} entityCollection The collection being processsed.\n     */\n    CzmlDataSource.processMaterialPacketData = processMaterialPacketData;\n\n    CzmlDataSource._processCzml = function(czml, entityCollection, sourceUri, updaterFunctions, dataSource) {\n        updaterFunctions = defaultValue(updaterFunctions, CzmlDataSource.updaters);\n\n        if (isArray(czml)) {\n            for (var i = 0, len = czml.length; i < len; ++i) {\n                processCzmlPacket(czml[i], entityCollection, updaterFunctions, sourceUri, dataSource);\n            }\n        } else {\n            processCzmlPacket(czml, entityCollection, updaterFunctions, sourceUri, dataSource);\n        }\n    };\nexport default CzmlDataSource;\n","var tmp = {};\n\n/*!\n * Autolinker.js\n * 3.11.0\n *\n * Copyright(c) 2019 Gregory Jacobs <greg@greg-jacobs.com>\n * MIT License\n *\n * https-colon-slashslash github.com/gregjacobs/Autolinker.js\n */\n(function (global, factory) {\n    global.Autolinker = factory();\n}(tmp, function () { 'use strict';\n\n    /**\n     * Assigns (shallow copies) the properties of `src` onto `dest`, if the\n     * corresponding property on `dest` === `undefined`.\n     *\n     * @param {Object} dest The destination object.\n     * @param {Object} src The source object.\n     * @return {Object} The destination object (`dest`)\n     */\n    function defaults(dest, src) {\n        for (var prop in src) {\n            if (src.hasOwnProperty(prop) && dest[prop] === undefined) {\n                dest[prop] = src[prop];\n            }\n        }\n        return dest;\n    }\n    /**\n     * Truncates the `str` at `len - ellipsisChars.length`, and adds the `ellipsisChars` to the\n     * end of the string (by default, two periods: '..'). If the `str` length does not exceed\n     * `len`, the string will be returned unchanged.\n     *\n     * @param {String} str The string to truncate and add an ellipsis to.\n     * @param {Number} truncateLen The length to truncate the string at.\n     * @param {String} [ellipsisChars=...] The ellipsis character(s) to add to the end of `str`\n     *   when truncated. Defaults to '...'\n     */\n    function ellipsis(str, truncateLen, ellipsisChars) {\n        var ellipsisLength;\n        if (str.length > truncateLen) {\n            if (ellipsisChars == null) {\n                ellipsisChars = '&hellip;';\n                ellipsisLength = 3;\n            }\n            else {\n                ellipsisLength = ellipsisChars.length;\n            }\n            str = str.substring(0, truncateLen - ellipsisLength) + ellipsisChars;\n        }\n        return str;\n    }\n    /**\n     * Supports `Array.prototype.indexOf()` functionality for old IE (IE8 and below).\n     *\n     * @param {Array} arr The array to find an element of.\n     * @param {*} element The element to find in the array, and return the index of.\n     * @return {Number} The index of the `element`, or -1 if it was not found.\n     */\n    function indexOf(arr, element) {\n        if (Array.prototype.indexOf) {\n            return arr.indexOf(element);\n        }\n        else {\n            for (var i = 0, len = arr.length; i < len; i++) {\n                if (arr[i] === element)\n                    return i;\n            }\n            return -1;\n        }\n    }\n    /**\n     * Removes array elements based on a filtering function. Mutates the input\n     * array.\n     *\n     * Using this instead of the ES5 Array.prototype.filter() function, to allow\n     * Autolinker compatibility with IE8, and also to prevent creating many new\n     * arrays in memory for filtering.\n     *\n     * @param {Array} arr The array to remove elements from. This array is\n     *   mutated.\n     * @param {Function} fn A function which should return `true` to\n     *   remove an element.\n     * @return {Array} The mutated input `arr`.\n     */\n    function remove(arr, fn) {\n        for (var i = arr.length - 1; i >= 0; i--) {\n            if (fn(arr[i]) === true) {\n                arr.splice(i, 1);\n            }\n        }\n    }\n    /**\n     * Performs the functionality of what modern browsers do when `String.prototype.split()` is called\n     * with a regular expression that contains capturing parenthesis.\n     *\n     * For example:\n     *\n     *     // Modern browsers:\n     *     \"a,b,c\".split( /(,)/ );  // --> [ 'a', ',', 'b', ',', 'c' ]\n     *\n     *     // Old IE (including IE8):\n     *     \"a,b,c\".split( /(,)/ );  // --> [ 'a', 'b', 'c' ]\n     *\n     * This method emulates the functionality of modern browsers for the old IE case.\n     *\n     * @param {String} str The string to split.\n     * @param {RegExp} splitRegex The regular expression to split the input `str` on. The splitting\n     *   character(s) will be spliced into the array, as in the \"modern browsers\" example in the\n     *   description of this method.\n     *   Note #1: the supplied regular expression **must** have the 'g' flag specified.\n     *   Note #2: for simplicity's sake, the regular expression does not need\n     *   to contain capturing parenthesis - it will be assumed that any match has them.\n     * @return {String[]} The split array of strings, with the splitting character(s) included.\n     */\n    function splitAndCapture(str, splitRegex) {\n        if (!splitRegex.global)\n            throw new Error(\"`splitRegex` must have the 'g' flag set\");\n        var result = [], lastIdx = 0, match;\n        while (match = splitRegex.exec(str)) {\n            result.push(str.substring(lastIdx, match.index));\n            result.push(match[0]); // push the splitting char(s)\n            lastIdx = match.index + match[0].length;\n        }\n        result.push(str.substring(lastIdx));\n        return result;\n    }\n    /**\n     * Function that should never be called but is used to check that every\n     * enum value is handled using TypeScript's 'never' type.\n     */\n    function throwUnhandledCaseError(theValue) {\n        throw new Error(\"Unhandled case for value: '\" + theValue + \"'\");\n    }\n\n    /**\n     * @class Autolinker.HtmlTag\n     * @extends Object\n     *\n     * Represents an HTML tag, which can be used to easily build/modify HTML tags programmatically.\n     *\n     * Autolinker uses this abstraction to create HTML tags, and then write them out as strings. You may also use\n     * this class in your code, especially within a {@link Autolinker#replaceFn replaceFn}.\n     *\n     * ## Examples\n     *\n     * Example instantiation:\n     *\n     *     var tag = new Autolinker.HtmlTag( {\n     *         tagName : 'a',\n     *         attrs   : { 'href': 'http-colon-slashslash google.com', 'class': 'external-link' },\n     *         innerHtml : 'Google'\n     *     } );\n     *\n     *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"external-link\">Google</a>\n     *\n     *     // Individual accessor methods\n     *     tag.getTagName();                 // 'a'\n     *     tag.getAttr( 'href' );            // 'http-colon-slashslash google.com'\n     *     tag.hasClass( 'external-link' );  // true\n     *\n     *\n     * Using mutator methods (which may be used in combination with instantiation config properties):\n     *\n     *     var tag = new Autolinker.HtmlTag();\n     *     tag.setTagName( 'a' );\n     *     tag.setAttr( 'href', 'http-colon-slashslash google.com' );\n     *     tag.addClass( 'external-link' );\n     *     tag.setInnerHtml( 'Google' );\n     *\n     *     tag.getTagName();                 // 'a'\n     *     tag.getAttr( 'href' );            // 'http-colon-slashslash google.com'\n     *     tag.hasClass( 'external-link' );  // true\n     *\n     *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"external-link\">Google</a>\n     *\n     *\n     * ## Example use within a {@link Autolinker#replaceFn replaceFn}\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance, configured with the Match's href and anchor text\n     *             tag.setAttr( 'rel', 'nofollow' );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n     *\n     *\n     * ## Example use with a new tag for the replacement\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = new Autolinker.HtmlTag( {\n     *                 tagName : 'button',\n     *                 attrs   : { 'title': 'Load URL: ' + match.getAnchorHref() },\n     *                 innerHtml : 'Load URL: ' + match.getAnchorText()\n     *             } );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <button title=\"Load URL: http-colon-slashslash google.com\">Load URL: google.com</button>\n     */\n    var HtmlTag = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration properties for this class, in an Object (map)\n         */\n        function HtmlTag(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * @cfg {String} tagName\n             *\n             * The tag name. Ex: 'a', 'button', etc.\n             *\n             * Not required at instantiation time, but should be set using {@link #setTagName} before {@link #toAnchorString}\n             * is executed.\n             */\n            this.tagName = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object.<String, String>} attrs\n             *\n             * An key/value Object (map) of attributes to create the tag with. The keys are the attribute names, and the\n             * values are the attribute values.\n             */\n            this.attrs = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} innerHTML\n             *\n             * The inner HTML for the tag.\n             */\n            this.innerHTML = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property {RegExp} whitespaceRegex\n             *\n             * Regular expression used to match whitespace in a string of CSS classes.\n             */\n            this.whitespaceRegex = /\\s+/; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.tagName = cfg.tagName || '';\n            this.attrs = cfg.attrs || {};\n            this.innerHTML = cfg.innerHtml || cfg.innerHTML || ''; // accept either the camelCased form or the fully capitalized acronym as in the DOM\n        }\n        /**\n         * Sets the tag name that will be used to generate the tag with.\n         *\n         * @param {String} tagName\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setTagName = function (tagName) {\n            this.tagName = tagName;\n            return this;\n        };\n        /**\n         * Retrieves the tag name.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getTagName = function () {\n            return this.tagName || '';\n        };\n        /**\n         * Sets an attribute on the HtmlTag.\n         *\n         * @param {String} attrName The attribute name to set.\n         * @param {String} attrValue The attribute value to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setAttr = function (attrName, attrValue) {\n            var tagAttrs = this.getAttrs();\n            tagAttrs[attrName] = attrValue;\n            return this;\n        };\n        /**\n         * Retrieves an attribute from the HtmlTag. If the attribute does not exist, returns `undefined`.\n         *\n         * @param {String} attrName The attribute name to retrieve.\n         * @return {String} The attribute's value, or `undefined` if it does not exist on the HtmlTag.\n         */\n        HtmlTag.prototype.getAttr = function (attrName) {\n            return this.getAttrs()[attrName];\n        };\n        /**\n         * Sets one or more attributes on the HtmlTag.\n         *\n         * @param {Object.<String, String>} attrs A key/value Object (map) of the attributes to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setAttrs = function (attrs) {\n            Object.assign(this.getAttrs(), attrs);\n            return this;\n        };\n        /**\n         * Retrieves the attributes Object (map) for the HtmlTag.\n         *\n         * @return {Object.<String, String>} A key/value object of the attributes for the HtmlTag.\n         */\n        HtmlTag.prototype.getAttrs = function () {\n            return this.attrs || (this.attrs = {});\n        };\n        /**\n         * Sets the provided `cssClass`, overwriting any current CSS classes on the HtmlTag.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to set (overwrite).\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setClass = function (cssClass) {\n            return this.setAttr('class', cssClass);\n        };\n        /**\n         * Convenience method to add one or more CSS classes to the HtmlTag. Will not add duplicate CSS classes.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to add.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.addClass = function (cssClass) {\n            var classAttr = this.getClass(), whitespaceRegex = this.whitespaceRegex, classes = (!classAttr) ? [] : classAttr.split(whitespaceRegex), newClasses = cssClass.split(whitespaceRegex), newClass;\n            while (newClass = newClasses.shift()) {\n                if (indexOf(classes, newClass) === -1) {\n                    classes.push(newClass);\n                }\n            }\n            this.getAttrs()['class'] = classes.join(\" \");\n            return this;\n        };\n        /**\n         * Convenience method to remove one or more CSS classes from the HtmlTag.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to remove.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.removeClass = function (cssClass) {\n            var classAttr = this.getClass(), whitespaceRegex = this.whitespaceRegex, classes = (!classAttr) ? [] : classAttr.split(whitespaceRegex), removeClasses = cssClass.split(whitespaceRegex), removeClass;\n            while (classes.length && (removeClass = removeClasses.shift())) {\n                var idx = indexOf(classes, removeClass);\n                if (idx !== -1) {\n                    classes.splice(idx, 1);\n                }\n            }\n            this.getAttrs()['class'] = classes.join(\" \");\n            return this;\n        };\n        /**\n         * Convenience method to retrieve the CSS class(es) for the HtmlTag, which will each be separated by spaces when\n         * there are multiple.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getClass = function () {\n            return this.getAttrs()['class'] || \"\";\n        };\n        /**\n         * Convenience method to check if the tag has a CSS class or not.\n         *\n         * @param {String} cssClass The CSS class to check for.\n         * @return {Boolean} `true` if the HtmlTag has the CSS class, `false` otherwise.\n         */\n        HtmlTag.prototype.hasClass = function (cssClass) {\n            return (' ' + this.getClass() + ' ').indexOf(' ' + cssClass + ' ') !== -1;\n        };\n        /**\n         * Sets the inner HTML for the tag.\n         *\n         * @param {String} html The inner HTML to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setInnerHTML = function (html) {\n            this.innerHTML = html;\n            return this;\n        };\n        /**\n         * Backwards compatibility method name.\n         *\n         * @param {String} html The inner HTML to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setInnerHtml = function (html) {\n            return this.setInnerHTML(html);\n        };\n        /**\n         * Retrieves the inner HTML for the tag.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getInnerHTML = function () {\n            return this.innerHTML || \"\";\n        };\n        /**\n         * Backward compatibility method name.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getInnerHtml = function () {\n            return this.getInnerHTML();\n        };\n        /**\n         * Override of superclass method used to generate the HTML string for the tag.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.toAnchorString = function () {\n            var tagName = this.getTagName(), attrsStr = this.buildAttrsStr();\n            attrsStr = (attrsStr) ? ' ' + attrsStr : ''; // prepend a space if there are actually attributes\n            return ['<', tagName, attrsStr, '>', this.getInnerHtml(), '</', tagName, '>'].join(\"\");\n        };\n        /**\n         * Support method for {@link #toAnchorString}, returns the string space-separated key=\"value\" pairs, used to populate\n         * the stringified HtmlTag.\n         *\n         * @protected\n         * @return {String} Example return: `attr1=\"value1\" attr2=\"value2\"`\n         */\n        HtmlTag.prototype.buildAttrsStr = function () {\n            if (!this.attrs)\n                return \"\"; // no `attrs` Object (map) has been set, return empty string\n            var attrs = this.getAttrs(), attrsArr = [];\n            for (var prop in attrs) {\n                if (attrs.hasOwnProperty(prop)) {\n                    attrsArr.push(prop + '=\"' + attrs[prop] + '\"');\n                }\n            }\n            return attrsArr.join(\" \");\n        };\n        return HtmlTag;\n    }());\n\n    /**\n     * Date: 2015-10-05\n     * Author: Kasper Sfren <soefritz@gmail.com> (https-colon-slashslash github.com/kafoso)\n     *\n     * A truncation feature, where the ellipsis will be placed at a section within\n     * the URL making it still somewhat human readable.\n     *\n     * @param {String} url\t\t\t\t\t\t A URL.\n     * @param {Number} truncateLen\t\t The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars\t The characters to place within the url, e.g. \"...\".\n     * @return {String} The truncated URL.\n     */\n    function truncateSmart(url, truncateLen, ellipsisChars) {\n        var ellipsisLengthBeforeParsing;\n        var ellipsisLength;\n        if (ellipsisChars == null) {\n            ellipsisChars = '&hellip;';\n            ellipsisLength = 3;\n            ellipsisLengthBeforeParsing = 8;\n        }\n        else {\n            ellipsisLength = ellipsisChars.length;\n            ellipsisLengthBeforeParsing = ellipsisChars.length;\n        }\n        var parse_url = function (url) {\n            var urlObj = {};\n            var urlSub = url;\n            var match = urlSub.match(/^([a-z]+):\\/\\//i);\n            if (match) {\n                urlObj.scheme = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^(.*?)(?=(\\?|#|\\/|$))/i);\n            if (match) {\n                urlObj.host = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^\\/(.*?)(?=(\\?|#|$))/i);\n            if (match) {\n                urlObj.path = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^\\?(.*?)(?=(#|$))/i);\n            if (match) {\n                urlObj.query = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^#(.*?)$/i);\n            if (match) {\n                urlObj.fragment = match[1];\n                //urlSub = urlSub.substr(match[0].length);  -- not used. Uncomment if adding another block.\n            }\n            return urlObj;\n        };\n        var buildUrl = function (urlObj) {\n            var url = \"\";\n            if (urlObj.scheme && urlObj.host) {\n                url += urlObj.scheme + \"://\";\n            }\n            if (urlObj.host) {\n                url += urlObj.host;\n            }\n            if (urlObj.path) {\n                url += \"/\" + urlObj.path;\n            }\n            if (urlObj.query) {\n                url += \"?\" + urlObj.query;\n            }\n            if (urlObj.fragment) {\n                url += \"#\" + urlObj.fragment;\n            }\n            return url;\n        };\n        var buildSegment = function (segment, remainingAvailableLength) {\n            var remainingAvailableLengthHalf = remainingAvailableLength / 2, startOffset = Math.ceil(remainingAvailableLengthHalf), endOffset = (-1) * Math.floor(remainingAvailableLengthHalf), end = \"\";\n            if (endOffset < 0) {\n                end = segment.substr(endOffset);\n            }\n            return segment.substr(0, startOffset) + ellipsisChars + end;\n        };\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        var availableLength = truncateLen - ellipsisLength;\n        var urlObj = parse_url(url);\n        // Clean up the URL\n        if (urlObj.query) {\n            var matchQuery = urlObj.query.match(/^(.*?)(?=(\\?|\\#))(.*?)$/i);\n            if (matchQuery) {\n                // Malformed URL; two or more \"?\". Removed any content behind the 2nd.\n                urlObj.query = urlObj.query.substr(0, matchQuery[1].length);\n                url = buildUrl(urlObj);\n            }\n        }\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        if (urlObj.host) {\n            urlObj.host = urlObj.host.replace(/^www\\./, \"\");\n            url = buildUrl(urlObj);\n        }\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        // Process and build the URL\n        var str = \"\";\n        if (urlObj.host) {\n            str += urlObj.host;\n        }\n        if (str.length >= availableLength) {\n            if (urlObj.host.length == truncateLen) {\n                return (urlObj.host.substr(0, (truncateLen - ellipsisLength)) + ellipsisChars).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            return buildSegment(str, availableLength).substr(0, availableLength + ellipsisLengthBeforeParsing);\n        }\n        var pathAndQuery = \"\";\n        if (urlObj.path) {\n            pathAndQuery += \"/\" + urlObj.path;\n        }\n        if (urlObj.query) {\n            pathAndQuery += \"?\" + urlObj.query;\n        }\n        if (pathAndQuery) {\n            if ((str + pathAndQuery).length >= availableLength) {\n                if ((str + pathAndQuery).length == truncateLen) {\n                    return (str + pathAndQuery).substr(0, truncateLen);\n                }\n                var remainingAvailableLength = availableLength - str.length;\n                return (str + buildSegment(pathAndQuery, remainingAvailableLength)).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            else {\n                str += pathAndQuery;\n            }\n        }\n        if (urlObj.fragment) {\n            var fragment = \"#\" + urlObj.fragment;\n            if ((str + fragment).length >= availableLength) {\n                if ((str + fragment).length == truncateLen) {\n                    return (str + fragment).substr(0, truncateLen);\n                }\n                var remainingAvailableLength2 = availableLength - str.length;\n                return (str + buildSegment(fragment, remainingAvailableLength2)).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            else {\n                str += fragment;\n            }\n        }\n        if (urlObj.scheme && urlObj.host) {\n            var scheme = urlObj.scheme + \"://\";\n            if ((str + scheme).length < availableLength) {\n                return (scheme + str).substr(0, truncateLen);\n            }\n        }\n        if (str.length <= truncateLen) {\n            return str;\n        }\n        var end = \"\";\n        if (availableLength > 0) {\n            end = str.substr((-1) * Math.floor(availableLength / 2));\n        }\n        return (str.substr(0, Math.ceil(availableLength / 2)) + ellipsisChars + end).substr(0, availableLength + ellipsisLengthBeforeParsing);\n    }\n\n    /**\n     * Date: 2015-10-05\n     * Author: Kasper Sfren <soefritz@gmail.com> (https-colon-slashslash github.com/kafoso)\n     *\n     * A truncation feature, where the ellipsis will be placed in the dead-center of the URL.\n     *\n     * @param {String} url             A URL.\n     * @param {Number} truncateLen     The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars   The characters to place within the url, e.g. \"..\".\n     * @return {String} The truncated URL.\n     */\n    function truncateMiddle(url, truncateLen, ellipsisChars) {\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        var ellipsisLengthBeforeParsing;\n        var ellipsisLength;\n        if (ellipsisChars == null) {\n            ellipsisChars = '&hellip;';\n            ellipsisLengthBeforeParsing = 8;\n            ellipsisLength = 3;\n        }\n        else {\n            ellipsisLengthBeforeParsing = ellipsisChars.length;\n            ellipsisLength = ellipsisChars.length;\n        }\n        var availableLength = truncateLen - ellipsisLength;\n        var end = \"\";\n        if (availableLength > 0) {\n            end = url.substr((-1) * Math.floor(availableLength / 2));\n        }\n        return (url.substr(0, Math.ceil(availableLength / 2)) + ellipsisChars + end).substr(0, availableLength + ellipsisLengthBeforeParsing);\n    }\n\n    /**\n     * A truncation feature where the ellipsis will be placed at the end of the URL.\n     *\n     * @param {String} anchorText\n     * @param {Number} truncateLen The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars The characters to place within the url, e.g. \"..\".\n     * @return {String} The truncated URL.\n     */\n    function truncateEnd(anchorText, truncateLen, ellipsisChars) {\n        return ellipsis(anchorText, truncateLen, ellipsisChars);\n    }\n\n    /**\n     * @protected\n     * @class Autolinker.AnchorTagBuilder\n     * @extends Object\n     *\n     * Builds anchor (&lt;a&gt;) tags for the Autolinker utility when a match is\n     * found.\n     *\n     * Normally this class is instantiated, configured, and used internally by an\n     * {@link Autolinker} instance, but may actually be used indirectly in a\n     * {@link Autolinker#replaceFn replaceFn} to create {@link Autolinker.HtmlTag HtmlTag}\n     * instances which may be modified before returning from the\n     * {@link Autolinker#replaceFn replaceFn}. For example:\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance\n     *             tag.setAttr( 'rel', 'nofollow' );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n     */\n    var AnchorTagBuilder = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration options for the AnchorTagBuilder instance, specified in an Object (map).\n         */\n        function AnchorTagBuilder(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * @cfg {Boolean} newWindow\n             * @inheritdoc Autolinker#newWindow\n             */\n            this.newWindow = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} truncate\n             * @inheritdoc Autolinker#truncate\n             */\n            this.truncate = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} className\n             * @inheritdoc Autolinker#className\n             */\n            this.className = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.newWindow = cfg.newWindow || false;\n            this.truncate = cfg.truncate || {};\n            this.className = cfg.className || '';\n        }\n        /**\n         * Generates the actual anchor (&lt;a&gt;) tag to use in place of the\n         * matched text, via its `match` object.\n         *\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {Autolinker.HtmlTag} The HtmlTag instance for the anchor tag.\n         */\n        AnchorTagBuilder.prototype.build = function (match) {\n            return new HtmlTag({\n                tagName: 'a',\n                attrs: this.createAttrs(match),\n                innerHtml: this.processAnchorText(match.getAnchorText())\n            });\n        };\n        /**\n         * Creates the Object (map) of the HTML attributes for the anchor (&lt;a&gt;)\n         *   tag being generated.\n         *\n         * @protected\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {Object} A key/value Object (map) of the anchor tag's attributes.\n         */\n        AnchorTagBuilder.prototype.createAttrs = function (match) {\n            var attrs = {\n                'href': match.getAnchorHref() // we'll always have the `href` attribute\n            };\n            var cssClass = this.createCssClass(match);\n            if (cssClass) {\n                attrs['class'] = cssClass;\n            }\n            if (this.newWindow) {\n                attrs['target'] = \"_blank\";\n                attrs['rel'] = \"noopener noreferrer\"; // Issue #149. See https://mathiasbynens.github.io/rel-noopener/\n            }\n            if (this.truncate) {\n                if (this.truncate.length && this.truncate.length < match.getAnchorText().length) {\n                    attrs['title'] = match.getAnchorHref();\n                }\n            }\n            return attrs;\n        };\n        /**\n         * Creates the CSS class that will be used for a given anchor tag, based on\n         * the `matchType` and the {@link #className} config.\n         *\n         * Example returns:\n         *\n         * - \"\"                                      // no {@link #className}\n         * - \"myLink myLink-url\"                     // url match\n         * - \"myLink myLink-email\"                   // email match\n         * - \"myLink myLink-phone\"                   // phone match\n         * - \"myLink myLink-hashtag\"                 // hashtag match\n         * - \"myLink myLink-mention myLink-twitter\"  // mention match with Twitter service\n         *\n         * @protected\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {String} The CSS class string for the link. Example return:\n         *   \"myLink myLink-url\". If no {@link #className} was configured, returns\n         *   an empty string.\n         */\n        AnchorTagBuilder.prototype.createCssClass = function (match) {\n            var className = this.className;\n            if (!className) {\n                return \"\";\n            }\n            else {\n                var returnClasses = [className], cssClassSuffixes = match.getCssClassSuffixes();\n                for (var i = 0, len = cssClassSuffixes.length; i < len; i++) {\n                    returnClasses.push(className + '-' + cssClassSuffixes[i]);\n                }\n                return returnClasses.join(' ');\n            }\n        };\n        /**\n         * Processes the `anchorText` by truncating the text according to the\n         * {@link #truncate} config.\n         *\n         * @private\n         * @param {String} anchorText The anchor tag's text (i.e. what will be\n         *   displayed).\n         * @return {String} The processed `anchorText`.\n         */\n        AnchorTagBuilder.prototype.processAnchorText = function (anchorText) {\n            anchorText = this.doTruncate(anchorText);\n            return anchorText;\n        };\n        /**\n         * Performs the truncation of the `anchorText` based on the {@link #truncate}\n         * option. If the `anchorText` is longer than the length specified by the\n         * {@link #truncate} option, the truncation is performed based on the\n         * `location` property. See {@link #truncate} for details.\n         *\n         * @private\n         * @param {String} anchorText The anchor tag's text (i.e. what will be\n         *   displayed).\n         * @return {String} The truncated anchor text.\n         */\n        AnchorTagBuilder.prototype.doTruncate = function (anchorText) {\n            var truncate = this.truncate;\n            if (!truncate || !truncate.length)\n                return anchorText;\n            var truncateLength = truncate.length, truncateLocation = truncate.location;\n            if (truncateLocation === 'smart') {\n                return truncateSmart(anchorText, truncateLength);\n            }\n            else if (truncateLocation === 'middle') {\n                return truncateMiddle(anchorText, truncateLength);\n            }\n            else {\n                return truncateEnd(anchorText, truncateLength);\n            }\n        };\n        return AnchorTagBuilder;\n    }());\n\n    /**\n     * @abstract\n     * @class Autolinker.match.Match\n     *\n     * Represents a match found in an input string which should be Autolinked. A Match object is what is provided in a\n     * {@link Autolinker#replaceFn replaceFn}, and may be used to query for details about the match.\n     *\n     * For example:\n     *\n     *     var input = \"...\";  // string with URLs, Email Addresses, and Mentions (Twitter, Instagram, Soundcloud)\n     *\n     *     var linkedText = Autolinker.link( input, {\n     *         replaceFn : function( match ) {\n     *             console.log( \"href = \", match.getAnchorHref() );\n     *             console.log( \"text = \", match.getAnchorText() );\n     *\n     *             switch( match.getType() ) {\n     *                 case 'url' :\n     *                     console.log( \"url: \", match.getUrl() );\n     *\n     *                 case 'email' :\n     *                     console.log( \"email: \", match.getEmail() );\n     *\n     *                 case 'mention' :\n     *                     console.log( \"mention: \", match.getMention() );\n     *             }\n     *         }\n     *     } );\n     *\n     * See the {@link Autolinker} class for more details on using the {@link Autolinker#replaceFn replaceFn}.\n     */\n    var Match = /** @class */ (function () {\n        /**\n         * @member Autolinker.match.Match\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function Match(cfg) {\n            /**\n             * @cfg {Autolinker.AnchorTagBuilder} tagBuilder (required)\n             *\n             * Reference to the AnchorTagBuilder instance to use to generate an anchor\n             * tag for the Match.\n             */\n            this.__jsduckDummyDocProp = null; // property used just to get the above doc comment into the ES5 output and documentation generator\n            /**\n             * @cfg {String} matchedText (required)\n             *\n             * The original text that was matched by the {@link Autolinker.matcher.Matcher}.\n             */\n            this.matchedText = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Number} offset (required)\n             *\n             * The offset of where the match was made in the input string.\n             */\n            this.offset = 0; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.tagBuilder = cfg.tagBuilder;\n            this.matchedText = cfg.matchedText;\n            this.offset = cfg.offset;\n        }\n        /**\n         * Returns the original text that was matched.\n         *\n         * @return {String}\n         */\n        Match.prototype.getMatchedText = function () {\n            return this.matchedText;\n        };\n        /**\n         * Sets the {@link #offset} of where the match was made in the input string.\n         *\n         * A {@link Autolinker.matcher.Matcher} will be fed only HTML text nodes,\n         * and will therefore set an original offset that is relative to the HTML\n         * text node itself. However, we want this offset to be relative to the full\n         * HTML input string, and thus if using {@link Autolinker#parse} (rather\n         * than calling a {@link Autolinker.matcher.Matcher} directly), then this\n         * offset is corrected after the Matcher itself has done its job.\n         *\n         * @param {Number} offset\n         */\n        Match.prototype.setOffset = function (offset) {\n            this.offset = offset;\n        };\n        /**\n         * Returns the offset of where the match was made in the input string. This\n         * is the 0-based index of the match.\n         *\n         * @return {Number}\n         */\n        Match.prototype.getOffset = function () {\n            return this.offset;\n        };\n        /**\n         * Returns the CSS class suffix(es) for this match.\n         *\n         * A CSS class suffix is appended to the {@link Autolinker#className} in\n         * the {@link Autolinker.AnchorTagBuilder} when a match is translated into\n         * an anchor tag.\n         *\n         * For example, if {@link Autolinker#className} was configured as 'myLink',\n         * and this method returns `[ 'url' ]`, the final class name of the element\n         * will become: 'myLink myLink-url'.\n         *\n         * The match may provide multiple CSS class suffixes to be appended to the\n         * {@link Autolinker#className} in order to facilitate better styling\n         * options for different match criteria. See {@link Autolinker.match.Mention}\n         * for an example.\n         *\n         * By default, this method returns a single array with the match's\n         * {@link #getType type} name, but may be overridden by subclasses.\n         *\n         * @return {String[]}\n         */\n        Match.prototype.getCssClassSuffixes = function () {\n            return [this.getType()];\n        };\n        /**\n         * Builds and returns an {@link Autolinker.HtmlTag} instance based on the\n         * Match.\n         *\n         * This can be used to easily generate anchor tags from matches, and either\n         * return their HTML string, or modify them before doing so.\n         *\n         * Example Usage:\n         *\n         *     var tag = match.buildTag();\n         *     tag.addClass( 'cordova-link' );\n         *     tag.setAttr( 'target', '_system' );\n         *\n         *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"cordova-link\" target=\"_system\">Google</a>\n         *\n         * Example Usage in {@link Autolinker#replaceFn}:\n         *\n         *     var html = Autolinker.link( \"Test google.com\", {\n         *         replaceFn : function( match ) {\n         *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance\n         *             tag.setAttr( 'rel', 'nofollow' );\n         *\n         *             return tag;\n         *         }\n         *     } );\n         *\n         *     // generated html:\n         *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n         */\n        Match.prototype.buildTag = function () {\n            return this.tagBuilder.build(this);\n        };\n        return Match;\n    }());\n\n    /*! *****************************************************************************\n    Copyright (c) Microsoft Corporation. All rights reserved.\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\n    this file except in compliance with the License. You may obtain a copy of the\n    License at http-colon-slashslash www.apache.org/licenses/LICENSE-2.0\n\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\n    MERCHANTABLITY OR NON-INFRINGEMENT.\n\n    See the Apache Version 2.0 License for specific language governing permissions\n    and limitations under the License.\n    ***************************************************************************** */\n    /* global Reflect, Promise */\n\n    var extendStatics = function(d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n\n    function __extends(d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    }\n\n    var __assign = function() {\n        __assign = Object.assign || function __assign(t) {\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\n                s = arguments[i];\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n            }\n            return t;\n        };\n        return __assign.apply(this, arguments);\n    };\n\n    /**\n     * @class Autolinker.match.Email\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Email match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var EmailMatch = /** @class */ (function (_super) {\n        __extends(EmailMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function EmailMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} email (required)\n             *\n             * The email address that was matched.\n             */\n            _this.email = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.email = cfg.email;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of EmailMatch, returns 'email'.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getType = function () {\n            return 'email';\n        };\n        /**\n         * Returns the email address that was matched.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getEmail = function () {\n            return this.email;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getAnchorHref = function () {\n            return 'mailto:' + this.email;\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getAnchorText = function () {\n            return this.email;\n        };\n        return EmailMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Hashtag\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Hashtag match found in an input string which should be\n     * Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more\n     * details.\n     */\n    var HashtagMatch = /** @class */ (function (_super) {\n        __extends(HashtagMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function HashtagMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point hashtag matches to. See {@link Autolinker#hashtag}\n             * for available values.\n             */\n            _this.serviceName = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} hashtag (required)\n             *\n             * The HashtagMatch that was matched, without the '#'.\n             */\n            _this.hashtag = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.serviceName = cfg.serviceName;\n            _this.hashtag = cfg.hashtag;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of HashtagMatch, returns 'hashtag'.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getType = function () {\n            return 'hashtag';\n        };\n        /**\n         * Returns the configured {@link #serviceName} to point the HashtagMatch to.\n         * Ex: 'facebook', 'twitter'.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getServiceName = function () {\n            return this.serviceName;\n        };\n        /**\n         * Returns the matched hashtag, without the '#' character.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getHashtag = function () {\n            return this.hashtag;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getAnchorHref = function () {\n            var serviceName = this.serviceName, hashtag = this.hashtag;\n            switch (serviceName) {\n                case 'twitter':\n                    return 'https://twitter.com/hashtag/' + hashtag;\n                case 'facebook':\n                    return 'https://www.facebook.com/hashtag/' + hashtag;\n                case 'instagram':\n                    return 'https://instagram.com/explore/tags/' + hashtag;\n                default: // Shouldn't happen because Autolinker's constructor should block any invalid values, but just in case.\n                    throw new Error('Unknown service name to point hashtag to: ' + serviceName);\n            }\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getAnchorText = function () {\n            return '#' + this.hashtag;\n        };\n        return HashtagMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Mention\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Mention match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var MentionMatch = /** @class */ (function (_super) {\n        __extends(MentionMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function MentionMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point mention matches to. See {@link Autolinker#mention}\n             * for available values.\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} mention (required)\n             *\n             * The Mention that was matched, without the '@' character.\n             */\n            _this.mention = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.mention = cfg.mention;\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of MentionMatch, returns 'mention'.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getType = function () {\n            return 'mention';\n        };\n        /**\n         * Returns the mention, without the '@' character.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getMention = function () {\n            return this.mention;\n        };\n        /**\n         * Returns the configured {@link #serviceName} to point the mention to.\n         * Ex: 'instagram', 'twitter', 'soundcloud'.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getServiceName = function () {\n            return this.serviceName;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getAnchorHref = function () {\n            switch (this.serviceName) {\n                case 'twitter':\n                    return 'https://twitter.com/' + this.mention;\n                case 'instagram':\n                    return 'https://instagram.com/' + this.mention;\n                case 'soundcloud':\n                    return 'https://soundcloud.com/' + this.mention;\n                default: // Shouldn't happen because Autolinker's constructor should block any invalid values, but just in case.\n                    throw new Error('Unknown service name to point mention to: ' + this.serviceName);\n            }\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getAnchorText = function () {\n            return '@' + this.mention;\n        };\n        /**\n         * Returns the CSS class suffixes that should be used on a tag built with\n         * the match. See {@link Autolinker.match.Match#getCssClassSuffixes} for\n         * details.\n         *\n         * @return {String[]}\n         */\n        MentionMatch.prototype.getCssClassSuffixes = function () {\n            var cssClassSuffixes = _super.prototype.getCssClassSuffixes.call(this), serviceName = this.getServiceName();\n            if (serviceName) {\n                cssClassSuffixes.push(serviceName);\n            }\n            return cssClassSuffixes;\n        };\n        return MentionMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Phone\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Phone number match found in an input string which should be\n     * Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more\n     * details.\n     */\n    var PhoneMatch = /** @class */ (function (_super) {\n        __extends(PhoneMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function PhoneMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @protected\n             * @property {String} number (required)\n             *\n             * The phone number that was matched, without any delimiter characters.\n             *\n             * Note: This is a string to allow for prefixed 0's.\n             */\n            _this.number = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property  {Boolean} plusSign (required)\n             *\n             * `true` if the matched phone number started with a '+' sign. We'll include\n             * it in the `tel:` URL if so, as this is needed for international numbers.\n             *\n             * Ex: '+1 (123) 456 7879'\n             */\n            _this.plusSign = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.number = cfg.number;\n            _this.plusSign = cfg.plusSign;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of PhoneMatch, returns 'phone'.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getType = function () {\n            return 'phone';\n        };\n        /**\n         * Returns the phone number that was matched as a string, without any\n         * delimiter characters.\n         *\n         * Note: This is a string to allow for prefixed 0's.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getPhoneNumber = function () {\n            return this.number;\n        };\n        /**\n         * Alias of {@link #getPhoneNumber}, returns the phone number that was\n         * matched as a string, without any delimiter characters.\n         *\n         * Note: This is a string to allow for prefixed 0's.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getNumber = function () {\n            return this.getPhoneNumber();\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getAnchorHref = function () {\n            return 'tel:' + (this.plusSign ? '+' : '') + this.number;\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getAnchorText = function () {\n            return this.matchedText;\n        };\n        return PhoneMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Url\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Url match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var UrlMatch = /** @class */ (function (_super) {\n        __extends(UrlMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function UrlMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} url (required)\n             *\n             * The url that was matched.\n             */\n            _this.url = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {\"scheme\"/\"www\"/\"tld\"} urlMatchType (required)\n             *\n             * The type of URL match that this class represents. This helps to determine\n             * if the match was made in the original text with a prefixed scheme (ex:\n             * 'http-colon-slashslash www.google.com'), a prefixed 'www' (ex: 'www.google.com'), or\n             * was matched by a known top-level domain (ex: 'google.com').\n             */\n            _this.urlMatchType = 'scheme'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} protocolUrlMatch (required)\n             *\n             * `true` if the URL is a match which already has a protocol (i.e.\n             * 'http-colon-slashslash '), `false` if the match was from a 'www' or known TLD match.\n             */\n            _this.protocolUrlMatch = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} protocolRelativeMatch (required)\n             *\n             * `true` if the URL is a protocol-relative match. A protocol-relative match\n             * is a URL that starts with '//', and will be either http-colon-slashslash  or https-colon-slashslash \n             * based on the protocol that the site is loaded under.\n             */\n            _this.protocolRelativeMatch = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} stripPrefix (required)\n             *\n             * The Object form of {@link Autolinker#cfg-stripPrefix}.\n             */\n            _this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} stripTrailingSlash (required)\n             * @inheritdoc Autolinker#cfg-stripTrailingSlash\n             */\n            _this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} decodePercentEncoding (required)\n             * @inheritdoc Autolinker#cfg-decodePercentEncoding\n             */\n            _this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @private\n             * @property {RegExp} schemePrefixRegex\n             *\n             * A regular expression used to remove the 'http-colon-slashslash ' or 'https-colon-slashslash ' from\n             * URLs.\n             */\n            _this.schemePrefixRegex = /^(https?:\\/\\/)?/i;\n            /**\n             * @private\n             * @property {RegExp} wwwPrefixRegex\n             *\n             * A regular expression used to remove the 'www.' from URLs.\n             */\n            _this.wwwPrefixRegex = /^(https?:\\/\\/)?(www\\.)?/i;\n            /**\n             * @private\n             * @property {RegExp} protocolRelativeRegex\n             *\n             * The regular expression used to remove the protocol-relative '//' from the {@link #url} string, for purposes\n             * of {@link #getAnchorText}. A protocol-relative URL is, for example, \"//yahoo.com\"\n             */\n            _this.protocolRelativeRegex = /^\\/\\//;\n            /**\n             * @private\n             * @property {Boolean} protocolPrepended\n             *\n             * Will be set to `true` if the 'http-colon-slashslash ' protocol has been prepended to the {@link #url} (because the\n             * {@link #url} did not have a protocol)\n             */\n            _this.protocolPrepended = false;\n            _this.urlMatchType = cfg.urlMatchType;\n            _this.url = cfg.url;\n            _this.protocolUrlMatch = cfg.protocolUrlMatch;\n            _this.protocolRelativeMatch = cfg.protocolRelativeMatch;\n            _this.stripPrefix = cfg.stripPrefix;\n            _this.stripTrailingSlash = cfg.stripTrailingSlash;\n            _this.decodePercentEncoding = cfg.decodePercentEncoding;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of UrlMatch, returns 'url'.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getType = function () {\n            return 'url';\n        };\n        /**\n         * Returns a string name for the type of URL match that this class\n         * represents.\n         *\n         * This helps to determine if the match was made in the original text with a\n         * prefixed scheme (ex: 'http-colon-slashslash www.google.com'), a prefixed 'www' (ex:\n         * 'www.google.com'), or was matched by a known top-level domain (ex:\n         * 'google.com').\n         *\n         * @return {\"scheme\"/\"www\"/\"tld\"}\n         */\n        UrlMatch.prototype.getUrlMatchType = function () {\n            return this.urlMatchType;\n        };\n        /**\n         * Returns the url that was matched, assuming the protocol to be 'http-colon-slashslash ' if the original\n         * match was missing a protocol.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getUrl = function () {\n            var url = this.url;\n            // if the url string doesn't begin with a protocol, assume 'http://'\n            if (!this.protocolRelativeMatch && !this.protocolUrlMatch && !this.protocolPrepended) {\n                url = this.url = 'http://' + url;\n                this.protocolPrepended = true;\n            }\n            return url;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getAnchorHref = function () {\n            var url = this.getUrl();\n            return url.replace(/&amp;/g, '&'); // any &amp;'s in the URL should be converted back to '&' if they were displayed as &amp; in the source html\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getAnchorText = function () {\n            var anchorText = this.getMatchedText();\n            if (this.protocolRelativeMatch) {\n                // Strip off any protocol-relative '//' from the anchor text\n                anchorText = this.stripProtocolRelativePrefix(anchorText);\n            }\n            if (this.stripPrefix.scheme) {\n                anchorText = this.stripSchemePrefix(anchorText);\n            }\n            if (this.stripPrefix.www) {\n                anchorText = this.stripWwwPrefix(anchorText);\n            }\n            if (this.stripTrailingSlash) {\n                anchorText = this.removeTrailingSlash(anchorText); // remove trailing slash, if there is one\n            }\n            if (this.decodePercentEncoding) {\n                anchorText = this.removePercentEncoding(anchorText);\n            }\n            return anchorText;\n        };\n        // ---------------------------------------\n        // Utility Functionality\n        /**\n         * Strips the scheme prefix (such as \"http-colon-slashslash \" or \"https-colon-slashslash \") from the given\n         * `url`.\n         *\n         * @private\n         * @param {String} url The text of the anchor that is being generated, for\n         *   which to strip off the url scheme.\n         * @return {String} The `url`, with the scheme stripped.\n         */\n        UrlMatch.prototype.stripSchemePrefix = function (url) {\n            return url.replace(this.schemePrefixRegex, '');\n        };\n        /**\n         * Strips the 'www' prefix from the given `url`.\n         *\n         * @private\n         * @param {String} url The text of the anchor that is being generated, for\n         *   which to strip off the 'www' if it exists.\n         * @return {String} The `url`, with the 'www' stripped.\n         */\n        UrlMatch.prototype.stripWwwPrefix = function (url) {\n            return url.replace(this.wwwPrefixRegex, '$1'); // leave any scheme ($1), it one exists\n        };\n        /**\n         * Strips any protocol-relative '//' from the anchor text.\n         *\n         * @private\n         * @param {String} text The text of the anchor that is being generated, for which to strip off the\n         *   protocol-relative prefix (such as stripping off \"//\")\n         * @return {String} The `anchorText`, with the protocol-relative prefix stripped.\n         */\n        UrlMatch.prototype.stripProtocolRelativePrefix = function (text) {\n            return text.replace(this.protocolRelativeRegex, '');\n        };\n        /**\n         * Removes any trailing slash from the given `anchorText`, in preparation for the text to be displayed.\n         *\n         * @private\n         * @param {String} anchorText The text of the anchor that is being generated, for which to remove any trailing\n         *   slash ('/') that may exist.\n         * @return {String} The `anchorText`, with the trailing slash removed.\n         */\n        UrlMatch.prototype.removeTrailingSlash = function (anchorText) {\n            if (anchorText.charAt(anchorText.length - 1) === '/') {\n                anchorText = anchorText.slice(0, -1);\n            }\n            return anchorText;\n        };\n        /**\n         * Decodes percent-encoded characters from the given `anchorText`, in\n         * preparation for the text to be displayed.\n         *\n         * @private\n         * @param {String} anchorText The text of the anchor that is being\n         *   generated, for which to decode any percent-encoded characters.\n         * @return {String} The `anchorText`, with the percent-encoded characters\n         *   decoded.\n         */\n        UrlMatch.prototype.removePercentEncoding = function (anchorText) {\n            // First, convert a few of the known % encodings to the corresponding\n            // HTML entities that could accidentally be interpretted as special\n            // HTML characters\n            var preProcessedEntityAnchorText = anchorText\n                .replace(/%22/gi, '&quot;') // \" char\n                .replace(/%26/gi, '&amp;') // & char\n                .replace(/%27/gi, '&#39;') // ' char\n                .replace(/%3C/gi, '&lt;') // < char\n                .replace(/%3E/gi, '&gt;'); // > char\n            try {\n                // Now attempt to decode the rest of the anchor text\n                return decodeURIComponent(preProcessedEntityAnchorText);\n            }\n            catch (e) { // Invalid % escape sequence in the anchor text\n                return preProcessedEntityAnchorText;\n            }\n        };\n        return UrlMatch;\n    }(Match));\n\n    /**\n     * @abstract\n     * @class Autolinker.matcher.Matcher\n     *\n     * An abstract class and interface for individual matchers to find matches in\n     * an input string with linkified versions of them.\n     *\n     * Note that Matchers do not take HTML into account - they must be fed the text\n     * nodes of any HTML string, which is handled by {@link Autolinker#parse}.\n     */\n    var Matcher = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Matcher\n         *   instance, specified in an Object (map).\n         */\n        function Matcher(cfg) {\n            /**\n             * @cfg {Autolinker.AnchorTagBuilder} tagBuilder (required)\n             *\n             * Reference to the AnchorTagBuilder instance to use to generate HTML tags\n             * for {@link Autolinker.match.Match Matches}.\n             */\n            this.__jsduckDummyDocProp = null; // property used just to get the above doc comment into the ES5 output and documentation generator\n            this.tagBuilder = cfg.tagBuilder;\n        }\n        return Matcher;\n    }());\n\n    /*\n     * This file builds and stores a library of the common regular expressions used\n     * by the Autolinker utility.\n     *\n     * Other regular expressions may exist ad-hoc, but these are generally the\n     * regular expressions that are shared between source files.\n     */\n    /**\n     * Regular expression to match upper and lowercase ASCII letters\n     */\n    var letterRe = /[A-Za-z]/;\n    /**\n     * Regular expression to match ASCII digits\n     */\n    var digitRe = /[0-9]/;\n    /**\n     * Regular expression to match whitespace\n     */\n    var whitespaceRe = /\\s/;\n    /**\n     * Regular expression to match quote characters\n     */\n    var quoteRe = /['\"]/;\n    /**\n     * Regular expression to match the range of ASCII control characters (0-31), and\n     * the backspace char (127)\n     */\n    var controlCharsRe = /[\\x00-\\x1F\\x7F]/;\n    /**\n     * The string form of a regular expression that would match all of the\n     * alphabetic (\"letter\") chars in the unicode character set when placed in a\n     * RegExp character class (`[]`). This includes all international alphabetic\n     * characters.\n     *\n     * These would be the characters matched by unicode regex engines `\\p{L}`\n     * escape (\"all letters\").\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Letter'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var alphaCharsStr = /A-Za-z\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B4\\u08B6-\\u08BD\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C60\\u0C61\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D5F-\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16F1-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1C80-\\u1C88\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FD5\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7AE\\uA7B0-\\uA7B7\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB65\\uAB70-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all emoji characters\n     * Source: https-colon-slashslash www.regextester.com/106421\n     */\n    var emojiStr = /\\u00a9\\u00ae\\u2000-\\u3300\\ud83c\\ud000-\\udfff\\ud83d\\ud000-\\udfff\\ud83e\\ud000-\\udfff/\n        .source;\n    /**\n     * The string form of a regular expression that would match all of the\n     * combining mark characters in the unicode character set when placed in a\n     * RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines `\\p{M}`\n     * escape (\"all marks\").\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Mark'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var marksStr = /\\u0300-\\u036F\\u0483-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0859-\\u085B\\u08D4-\\u08E1\\u08E3-\\u0903\\u093A-\\u093C\\u093E-\\u094F\\u0951-\\u0957\\u0962\\u0963\\u0981-\\u0983\\u09BC\\u09BE-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CD\\u09D7\\u09E2\\u09E3\\u0A01-\\u0A03\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81-\\u0A83\\u0ABC\\u0ABE-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AE2\\u0AE3\\u0B01-\\u0B03\\u0B3C\\u0B3E-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B62\\u0B63\\u0B82\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD7\\u0C00-\\u0C03\\u0C3E-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0C81-\\u0C83\\u0CBC\\u0CBE-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CE2\\u0CE3\\u0D01-\\u0D03\\u0D3E-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4D\\u0D57\\u0D62\\u0D63\\u0D82\\u0D83\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EB9\\u0EBB\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F71-\\u0F84\\u0F86\\u0F87\\u0F8D-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102B-\\u103E\\u1056-\\u1059\\u105E-\\u1060\\u1062-\\u1064\\u1067-\\u106D\\u1071-\\u1074\\u1082-\\u108D\\u108F\\u109A-\\u109D\\u135D-\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B4-\\u17D3\\u17DD\\u180B-\\u180D\\u1885\\u1886\\u18A9\\u1920-\\u192B\\u1930-\\u193B\\u1A17-\\u1A1B\\u1A55-\\u1A5E\\u1A60-\\u1A7C\\u1A7F\\u1AB0-\\u1ABE\\u1B00-\\u1B04\\u1B34-\\u1B44\\u1B6B-\\u1B73\\u1B80-\\u1B82\\u1BA1-\\u1BAD\\u1BE6-\\u1BF3\\u1C24-\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE8\\u1CED\\u1CF2-\\u1CF4\\u1CF8\\u1CF9\\u1DC0-\\u1DF5\\u1DFB-\\u1DFF\\u20D0-\\u20F0\\u2CEF-\\u2CF1\\u2D7F\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F-\\uA672\\uA674-\\uA67D\\uA69E\\uA69F\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA823-\\uA827\\uA880\\uA881\\uA8B4-\\uA8C5\\uA8E0-\\uA8F1\\uA926-\\uA92D\\uA947-\\uA953\\uA980-\\uA983\\uA9B3-\\uA9C0\\uA9E5\\uAA29-\\uAA36\\uAA43\\uAA4C\\uAA4D\\uAA7B-\\uAA7D\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uAAEB-\\uAAEF\\uAAF5\\uAAF6\\uABE3-\\uABEA\\uABEC\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE2F/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all of the\n     * alphabetic (\"letter\") chars, emoji, and combining marks in the unicode character set\n     * when placed in a RegExp character class (`[]`). This includes all\n     * international alphabetic characters.\n     *\n     * These would be the characters matched by unicode regex engines `\\p{L}\\p{M}`\n     * escapes and emoji characters.\n     */\n    var alphaCharsAndMarksStr = alphaCharsStr + emojiStr + marksStr;\n    /**\n     * The string form of a regular expression that would match all of the\n     * decimal number chars in the unicode character set when placed in a RegExp\n     * character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines `\\p{Nd}`\n     * escape (\"all decimal numbers\")\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Decimal_Number'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var decimalNumbersStr = /0-9\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0BE6-\\u0BEF\\u0C66-\\u0C6F\\u0CE6-\\u0CEF\\u0D66-\\u0D6F\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F29\\u1040-\\u1049\\u1090-\\u1099\\u17E0-\\u17E9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19D9\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\uA620-\\uA629\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all of the\n     * letters and decimal number chars in the unicode character set when placed in\n     * a RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines\n     * `[\\p{L}\\p{Nd}]` escape (\"all letters and decimal numbers\")\n     */\n    var alphaNumericCharsStr = alphaCharsAndMarksStr + decimalNumbersStr;\n    /**\n     * The string form of a regular expression that would match all of the\n     * letters, combining marks, and decimal number chars in the unicode character\n     * set when placed in a RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines\n     * `[\\p{L}\\p{M}\\p{Nd}]` escape (\"all letters, combining marks, and decimal\n     * numbers\")\n     */\n    var alphaNumericAndMarksCharsStr = alphaCharsAndMarksStr + decimalNumbersStr;\n    // Simplified IP regular expression\n    var ipStr = '(?:[' + decimalNumbersStr + ']{1,3}\\\\.){3}[' + decimalNumbersStr + ']{1,3}';\n    // Protected domain label which do not allow \"-\" character on the beginning and the end of a single label\n    var domainLabelStr = '[' + alphaNumericAndMarksCharsStr + '](?:[' + alphaNumericAndMarksCharsStr + '\\\\-]{0,61}[' + alphaNumericAndMarksCharsStr + '])?';\n    var getDomainLabelStr = function (group) {\n        return '(?=(' + domainLabelStr + '))\\\\' + group;\n    };\n    /**\n     * A function to match domain names of a URL or email address.\n     * Ex: 'google', 'yahoo', 'some-other-company', etc.\n     */\n    var getDomainNameStr = function (group) {\n        return '(?:' + getDomainLabelStr(group) + '(?:\\\\.' + getDomainLabelStr(group + 1) + '){0,126}|' + ipStr + ')';\n    };\n    /**\n     * A regular expression that is simply the character class of the characters\n     * that may be used in a domain name, minus the '-' or '.'\n     */\n    var domainNameCharRegex = new RegExp(\"[\" + alphaNumericAndMarksCharsStr + \"]\");\n\n    // NOTE: THIS IS A GENERATED FILE\n    // To update with the latest TLD list, run `npm run update-tld-regex` or `yarn update-tld-regex` (depending on which you have installed)\n    var tldRegex = /(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|vermgensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermgensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|spreadbetting|travelchannel|wolterskluwer|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|rightathome|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pbt977c|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b||accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nationwide|newholland|nextdirect|onyourside|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|telefonica|university|vistaprint|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|fujixerox|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|honeywell|institute|insurance|kuokgroup|ladbrokes|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--tckwe|xn--vhquv|yodobashi|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|chrysler|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|esurance|etisalat|everbank|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|movistar|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|symantec|training|uconnect|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama||abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|cartier|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|iselect|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lancome|lanxess|lasalle|latrobe|leclerc|liaison|limited|lincoln|markets|metlife|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|shriram|singles|staples|starhub|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|||||||||abarth|abbott|abbvie|active|africa|agency|airbus|airtel|alipay|alsace|alstom|anquan|aramco|author|bayern|beauty|berlin|bharti|blanco|bostik|boston|broker|camera|career|caseih|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|mobily|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|piaget|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|warman|webcam|xihuan|yachts|yandex|zappos|||||||||||||actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|dodge|drive|dubai|earth|edeka|email|epost|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|intel|irish|iveco|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|lupin|macys|mango|media|miami|money|mopar|movie|nadex|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|zippo|||||||||||||aarp|able|adac|aero|aigo|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|doha|duck|duns|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scor|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone||||||||||||||||||||||||||aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bnl|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceb|ceo|cfa|cfd|com|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jcp|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|srl|srt|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip||||||||||||||||||||||||||||||ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||)/;\n\n    // For debugging: search for other \"For debugging\" lines\n    // import CliTable from 'cli-table';\n    /**\n     * @class Autolinker.matcher.Email\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find email matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more details.\n     */\n    var EmailMatcher = /** @class */ (function (_super) {\n        __extends(EmailMatcher, _super);\n        function EmailMatcher() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            /**\n             * Valid characters that can be used in the \"local\" part of an email address,\n             * i.e. the \"name\" part of \"name@site.com\"\n             */\n            _this.localPartCharRegex = new RegExp(\"[\" + alphaNumericAndMarksCharsStr + \"!#$%&'*+/=?^_`{|}~-]\");\n            /**\n             * Stricter TLD regex which adds a beginning and end check to ensure\n             * the string is a valid TLD\n             */\n            _this.strictTldRegex = new RegExp(\"^\" + tldRegex.source + \"$\");\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        EmailMatcher.prototype.parseMatches = function (text) {\n            var tagBuilder = this.tagBuilder, localPartCharRegex = this.localPartCharRegex, strictTldRegex = this.strictTldRegex, matches = [], len = text.length, noCurrentEmailMatch = new CurrentEmailMatch();\n            // for matching a 'mailto:' prefix\n            var mailtoTransitions = {\n                'm': 'a',\n                'a': 'i',\n                'i': 'l',\n                'l': 't',\n                't': 'o',\n                'o': ':',\n            };\n            var charIdx = 0, state = 0 /* NonEmailMatch */, currentEmailMatch = noCurrentEmailMatch;\n            // For debugging: search for other \"For debugging\" lines\n            // const table = new CliTable( {\n            // \thead: [ 'charIdx', 'char', 'state', 'charIdx', 'currentEmailAddress.idx', 'hasDomainDot' ]\n            // } );\n            while (charIdx < len) {\n                var char = text.charAt(charIdx);\n                // For debugging: search for other \"For debugging\" lines\n                // table.push(\n                // \t[ charIdx, char, State[ state ], charIdx, currentEmailAddress.idx, currentEmailAddress.hasDomainDot ]\n                // );\n                switch (state) {\n                    case 0 /* NonEmailMatch */:\n                        stateNonEmailAddress(char);\n                        break;\n                    case 1 /* Mailto */:\n                        stateMailTo(text.charAt(charIdx - 1), char);\n                        break;\n                    case 2 /* LocalPart */:\n                        stateLocalPart(char);\n                        break;\n                    case 3 /* LocalPartDot */:\n                        stateLocalPartDot(char);\n                        break;\n                    case 4 /* AtSign */:\n                        stateAtSign(char);\n                        break;\n                    case 5 /* DomainChar */:\n                        stateDomainChar(char);\n                        break;\n                    case 6 /* DomainHyphen */:\n                        stateDomainHyphen(char);\n                        break;\n                    case 7 /* DomainDot */:\n                        stateDomainDot(char);\n                        break;\n                    default:\n                        throwUnhandledCaseError(state);\n                }\n                // For debugging: search for other \"For debugging\" lines\n                // table.push(\n                // \t[ charIdx, char, State[ state ], charIdx, currentEmailAddress.idx, currentEmailAddress.hasDomainDot ]\n                // );\n                charIdx++;\n            }\n            // Capture any valid match at the end of the string\n            captureMatchIfValidAndReset();\n            // For debugging: search for other \"For debugging\" lines\n            //console.log( '\\n' + table.toString() );\n            return matches;\n            // Handles the state when we're not in an email address\n            function stateNonEmailAddress(char) {\n                if (char === 'm') {\n                    beginEmailMatch(1 /* Mailto */);\n                }\n                else if (localPartCharRegex.test(char)) {\n                    beginEmailMatch();\n                }\n            }\n            // Handles if we're reading a 'mailto:' prefix on the string\n            function stateMailTo(prevChar, char) {\n                if (prevChar === ':') {\n                    // We've reached the end of the 'mailto:' prefix\n                    if (localPartCharRegex.test(char)) {\n                        state = 2 /* LocalPart */;\n                        currentEmailMatch = new CurrentEmailMatch(__assign({}, currentEmailMatch, { hasMailtoPrefix: true }));\n                    }\n                    else {\n                        // we've matched 'mailto:' but didn't get anything meaningful\n                        // immediately afterwards (for example, we encountered a\n                        // space character, or an '@' character which formed 'mailto:@'\n                        resetToNonEmailMatchState();\n                    }\n                }\n                else if (mailtoTransitions[prevChar] === char) ;\n                else if (localPartCharRegex.test(char)) {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // different character that didn't continue the prefix\n                    state = 2 /* LocalPart */;\n                }\n                else if (char === '.') {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // dot character\n                    state = 3 /* LocalPartDot */;\n                }\n                else if (char === '@') {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // an @ character\n                    state = 4 /* AtSign */;\n                }\n                else {\n                    // not an email address character, return to \"NonEmailAddress\" state\n                    resetToNonEmailMatchState();\n                }\n            }\n            // Handles the state when we're currently in the \"local part\" of an\n            // email address (as opposed to the \"domain part\")\n            function stateLocalPart(char) {\n                if (char === '.') {\n                    state = 3 /* LocalPartDot */;\n                }\n                else if (char === '@') {\n                    state = 4 /* AtSign */;\n                }\n                else if (localPartCharRegex.test(char)) ;\n                else {\n                    // not an email address character, return to \"NonEmailAddress\" state\n                    resetToNonEmailMatchState();\n                }\n            }\n            // Handles the state where we've read\n            function stateLocalPartDot(char) {\n                if (char === '.') {\n                    // We read a second '.' in a row, not a valid email address\n                    // local part\n                    resetToNonEmailMatchState();\n                }\n                else if (char === '@') {\n                    // We read the '@' character immediately after a dot ('.'), not\n                    // an email address\n                    resetToNonEmailMatchState();\n                }\n                else if (localPartCharRegex.test(char)) {\n                    state = 2 /* LocalPart */;\n                }\n                else {\n                    // Anything else, not an email address\n                    resetToNonEmailMatchState();\n                }\n            }\n            function stateAtSign(char) {\n                if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                }\n                else {\n                    // Anything else, not an email address\n                    resetToNonEmailMatchState();\n                }\n            }\n            function stateDomainChar(char) {\n                if (char === '.') {\n                    state = 7 /* DomainDot */;\n                }\n                else if (char === '-') {\n                    state = 6 /* DomainHyphen */;\n                }\n                else if (domainNameCharRegex.test(char)) ;\n                else {\n                    // Anything else, we potentially matched if the criteria has\n                    // been met\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function stateDomainHyphen(char) {\n                if (char === '-' || char === '.') {\n                    // Not valid to have two hyphens (\"--\") or hypen+dot (\"-.\")\n                    captureMatchIfValidAndReset();\n                }\n                else if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                }\n                else {\n                    // Anything else\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function stateDomainDot(char) {\n                if (char === '.' || char === '-') {\n                    // not valid to have two dots (\"..\") or dot+hypen (\".-\")\n                    captureMatchIfValidAndReset();\n                }\n                else if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                    // After having read a '.' and then a valid domain character,\n                    // we now know that the domain part of the email is valid, and\n                    // we have found at least a partial EmailMatch (however, the\n                    // email address may have additional characters from this point)\n                    currentEmailMatch = new CurrentEmailMatch(__assign({}, currentEmailMatch, { hasDomainDot: true }));\n                }\n                else {\n                    // Anything else\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function beginEmailMatch(newState) {\n                if (newState === void 0) { newState = 2 /* LocalPart */; }\n                state = newState;\n                currentEmailMatch = new CurrentEmailMatch({ idx: charIdx });\n            }\n            function resetToNonEmailMatchState() {\n                state = 0 /* NonEmailMatch */;\n                currentEmailMatch = noCurrentEmailMatch;\n            }\n            /*\n             * Captures the current email address as an EmailMatch if it's valid,\n             * and resets the state to read another email address.\n             */\n            function captureMatchIfValidAndReset() {\n                if (currentEmailMatch.hasDomainDot) { // we need at least one dot in the domain to be considered a valid email address\n                    var matchedText = text.slice(currentEmailMatch.idx, charIdx);\n                    // If we read a '.' or '-' char that ended the email address\n                    // (valid domain name characters, but only valid email address\n                    // characters if they are followed by something else), strip\n                    // it off now\n                    if (/[-.]$/.test(matchedText)) {\n                        matchedText = matchedText.slice(0, -1);\n                    }\n                    var emailAddress = currentEmailMatch.hasMailtoPrefix\n                        ? matchedText.slice('mailto:'.length)\n                        : matchedText;\n                    // if the email address has a valid TLD, add it to the list of matches\n                    if (doesEmailHaveValidTld(emailAddress)) {\n                        matches.push(new EmailMatch({\n                            tagBuilder: tagBuilder,\n                            matchedText: matchedText,\n                            offset: currentEmailMatch.idx,\n                            email: emailAddress\n                        }));\n                    }\n                }\n                resetToNonEmailMatchState();\n                /**\n                 * Determines if the given email address has a valid TLD or not\n                 * @param {string} emailAddress - email address\n                 * @return {Boolean} - true is email have valid TLD, false otherwise\n                 */\n                function doesEmailHaveValidTld(emailAddress) {\n                    var emailAddressTld = emailAddress.split('.').pop() || '';\n                    var emailAddressNormalized = emailAddressTld.toLowerCase();\n                    var isValidTld = strictTldRegex.test(emailAddressNormalized);\n                    return isValidTld;\n                }\n            }\n        };\n        return EmailMatcher;\n    }(Matcher));\n    var CurrentEmailMatch = /** @class */ (function () {\n        function CurrentEmailMatch(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            this.idx = cfg.idx !== undefined ? cfg.idx : -1;\n            this.hasMailtoPrefix = !!cfg.hasMailtoPrefix;\n            this.hasDomainDot = !!cfg.hasDomainDot;\n        }\n        return CurrentEmailMatch;\n    }());\n\n    /**\n     * @private\n     * @class Autolinker.matcher.UrlMatchValidator\n     * @singleton\n     *\n     * Used by Autolinker to filter out false URL positives from the\n     * {@link Autolinker.matcher.Url UrlMatcher}.\n     *\n     * Due to the limitations of regular expressions (including the missing feature\n     * of look-behinds in JS regular expressions), we cannot always determine the\n     * validity of a given match. This class applies a bit of additional logic to\n     * filter out any false positives that have been matched by the\n     * {@link Autolinker.matcher.Url UrlMatcher}.\n     */\n    var UrlMatchValidator = /** @class */ (function () {\n        function UrlMatchValidator() {\n        }\n        /**\n         * Determines if a given URL match found by the {@link Autolinker.matcher.Url UrlMatcher}\n         * is valid. Will return `false` for:\n         *\n         * 1) URL matches which do not have at least have one period ('.') in the\n         *    domain name (effectively skipping over matches like \"abc:def\").\n         *    However, URL matches with a protocol will be allowed (ex: 'http-colon-slashslash localhost')\n         * 2) URL matches which do not have at least one word character in the\n         *    domain name (effectively skipping over matches like \"git:1.0\").\n         * 3) A protocol-relative url match (a URL beginning with '//') whose\n         *    previous character is a word character (effectively skipping over\n         *    strings like \"abc//google.com\")\n         *\n         * Otherwise, returns `true`.\n         *\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Boolean} `true` if the match given is valid and should be\n         *   processed, or `false` if the match is invalid and/or should just not be\n         *   processed.\n         */\n        UrlMatchValidator.isValid = function (urlMatch, protocolUrlMatch) {\n            if ((protocolUrlMatch && !this.isValidUriScheme(protocolUrlMatch)) ||\n                this.urlMatchDoesNotHaveProtocolOrDot(urlMatch, protocolUrlMatch) || // At least one period ('.') must exist in the URL match for us to consider it an actual URL, *unless* it was a full protocol match (like 'http://localhost')\n                (this.urlMatchDoesNotHaveAtLeastOneWordChar(urlMatch, protocolUrlMatch) && // At least one letter character must exist in the domain name after a protocol match. Ex: skip over something like \"git:1.0\"\n                    !this.isValidIpAddress(urlMatch)) || // Except if it's an IP address\n                this.containsMultipleDots(urlMatch)) {\n                return false;\n            }\n            return true;\n        };\n        UrlMatchValidator.isValidIpAddress = function (uriSchemeMatch) {\n            var newRegex = new RegExp(this.hasFullProtocolRegex.source + this.ipRegex.source);\n            var uriScheme = uriSchemeMatch.match(newRegex);\n            return uriScheme !== null;\n        };\n        UrlMatchValidator.containsMultipleDots = function (urlMatch) {\n            var stringBeforeSlash = urlMatch;\n            if (this.hasFullProtocolRegex.test(urlMatch)) {\n                stringBeforeSlash = urlMatch.split('://')[1];\n            }\n            return stringBeforeSlash.split('/')[0].indexOf(\"..\") > -1;\n        };\n        /**\n         * Determines if the URI scheme is a valid scheme to be autolinked. Returns\n         * `false` if the scheme is 'javascript:' or 'vbscript:'\n         *\n         * @private\n         * @param {String} uriSchemeMatch The match URL string for a full URI scheme\n         *   match. Ex: 'http-colon-slashslash yahoo.com' or 'mailto:a@a.com'.\n         * @return {Boolean} `true` if the scheme is a valid one, `false` otherwise.\n         */\n        UrlMatchValidator.isValidUriScheme = function (uriSchemeMatch) {\n            var uriSchemeMatchArr = uriSchemeMatch.match(this.uriSchemeRegex), uriScheme = uriSchemeMatchArr && uriSchemeMatchArr[0].toLowerCase();\n            return (uriScheme !== 'javascript:' && uriScheme !== 'vbscript:');\n        };\n        /**\n         * Determines if a URL match does not have either:\n         *\n         * a) a full protocol (i.e. 'http-colon-slashslash '), or\n         * b) at least one dot ('.') in the domain name (for a non-full-protocol\n         *    match).\n         *\n         * Either situation is considered an invalid URL (ex: 'git:d' does not have\n         * either the '://' part, or at least one dot in the domain name. If the\n         * match was 'git:abc.com', we would consider this valid.)\n         *\n         * @private\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Boolean} `true` if the URL match does not have a full protocol,\n         *   or at least one dot ('.') in a non-full-protocol match.\n         */\n        UrlMatchValidator.urlMatchDoesNotHaveProtocolOrDot = function (urlMatch, protocolUrlMatch) {\n            return (!!urlMatch && (!protocolUrlMatch || !this.hasFullProtocolRegex.test(protocolUrlMatch)) && urlMatch.indexOf('.') === -1);\n        };\n        /**\n         * Determines if a URL match does not have at least one word character after\n         * the protocol (i.e. in the domain name).\n         *\n         * At least one letter character must exist in the domain name after a\n         * protocol match. Ex: skip over something like \"git:1.0\"\n         *\n         * @private\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to know whether or not we\n         *   have a protocol in the URL string, in order to check for a word\n         *   character after the protocol separator (':').\n         * @return {Boolean} `true` if the URL match does not have at least one word\n         *   character in it after the protocol, `false` otherwise.\n         */\n        UrlMatchValidator.urlMatchDoesNotHaveAtLeastOneWordChar = function (urlMatch, protocolUrlMatch) {\n            if (urlMatch && protocolUrlMatch) {\n                return !this.hasWordCharAfterProtocolRegex.test(urlMatch);\n            }\n            else {\n                return false;\n            }\n        };\n        /**\n         * Regex to test for a full protocol, with the two trailing slashes. Ex: 'http-colon-slashslash '\n         *\n         * @private\n         * @property {RegExp} hasFullProtocolRegex\n         */\n        UrlMatchValidator.hasFullProtocolRegex = /^[A-Za-z][-.+A-Za-z0-9]*:\\/\\//;\n        /**\n         * Regex to find the URI scheme, such as 'mailto:'.\n         *\n         * This is used to filter out 'javascript:' and 'vbscript:' schemes.\n         *\n         * @private\n         * @property {RegExp} uriSchemeRegex\n         */\n        UrlMatchValidator.uriSchemeRegex = /^[A-Za-z][-.+A-Za-z0-9]*:/;\n        /**\n         * Regex to determine if at least one word char exists after the protocol (i.e. after the ':')\n         *\n         * @private\n         * @property {RegExp} hasWordCharAfterProtocolRegex\n         */\n        UrlMatchValidator.hasWordCharAfterProtocolRegex = new RegExp(\":[^\\\\s]*?[\" + alphaCharsStr + \"]\");\n        /**\n         * Regex to determine if the string is a valid IP address\n         *\n         * @private\n         * @property {RegExp} ipRegex\n         */\n        UrlMatchValidator.ipRegex = /[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?(:[0-9]*)?\\/?$/;\n        return UrlMatchValidator;\n    }());\n\n    /**\n     * @class Autolinker.matcher.Url\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find URL matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more details.\n     */\n    var UrlMatcher = /** @class */ (function (_super) {\n        __extends(UrlMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function UrlMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {Object} stripPrefix (required)\n             *\n             * The Object form of {@link Autolinker#cfg-stripPrefix}.\n             */\n            _this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} stripTrailingSlash (required)\n             * @inheritdoc Autolinker#stripTrailingSlash\n             */\n            _this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} decodePercentEncoding (required)\n             * @inheritdoc Autolinker#decodePercentEncoding\n             */\n            _this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property {RegExp} matcherRegex\n             *\n             * The regular expression to match URLs with an optional scheme, port\n             * number, path, query string, and hash anchor.\n             *\n             * Example matches:\n             *\n             *     http-colon-slashslash google.com\n             *     www.google.com\n             *     google.com/path/to/file?q1=1&q2=2#myAnchor\n             *\n             *\n             * This regular expression will have the following capturing groups:\n             *\n             * 1.  Group that matches a scheme-prefixed URL (i.e. 'http-colon-slashslash google.com').\n             *     This is used to match scheme URLs with just a single word, such as\n             *     'http-colon-slashslash localhost', where we won't double check that the domain name\n             *     has at least one dot ('.') in it.\n             * 2.  Group that matches a 'www.' prefixed URL. This is only matched if the\n             *     'www.' text was not prefixed by a scheme (i.e.: not prefixed by\n             *     'http-colon-slashslash ', 'ftp:', etc.)\n             * 3.  A protocol-relative ('//') match for the case of a 'www.' prefixed\n             *     URL. Will be an empty string if it is not a protocol-relative match.\n             *     We need to know the character before the '//' in order to determine\n             *     if it is a valid match or the // was in a string we don't want to\n             *     auto-link.\n             * 4.  Group that matches a known TLD (top level domain), when a scheme\n             *     or 'www.'-prefixed domain is not matched.\n             * 5.  A protocol-relative ('//') match for the case of a known TLD prefixed\n             *     URL. Will be an empty string if it is not a protocol-relative match.\n             *     See #3 for more info.\n             */\n            _this.matcherRegex = (function () {\n                var schemeRegex = /(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\\/\\/)(?!\\d+\\/?)(?:\\/\\/)?)/, // match protocol, allow in format \"http://\" or \"mailto:\". However, do not match the first part of something like 'link:http://www.google.com' (i.e. don't match \"link:\"). Also, make sure we don't interpret 'google.com:8000' as if 'google.com' was a protocol here (i.e. ignore a trailing port number in this regex)\n                wwwRegex = /(?:www\\.)/, // starting with 'www.'\n                // Allow optional path, query string, and hash anchor, not ending in the following characters: \"?!:,.;\"\n                // http://blog.codinghorror.com/the-problem-with-urls/\n                urlSuffixRegex = new RegExp('[/?#](?:[' + alphaNumericAndMarksCharsStr + '\\\\-+&@#/%=~_()|\\'$*\\\\[\\\\]?!:,.;\\u2713]*[' + alphaNumericAndMarksCharsStr + '\\\\-+&@#/%=~_()|\\'$*\\\\[\\\\]\\u2713])?');\n                return new RegExp([\n                    '(?:',\n                    '(',\n                    schemeRegex.source,\n                    getDomainNameStr(2),\n                    ')',\n                    '|',\n                    '(',\n                    '(//)?',\n                    wwwRegex.source,\n                    getDomainNameStr(6),\n                    ')',\n                    '|',\n                    '(',\n                    '(//)?',\n                    getDomainNameStr(10) + '\\\\.',\n                    tldRegex.source,\n                    '(?![-' + alphaNumericCharsStr + '])',\n                    ')',\n                    ')',\n                    '(?::[0-9]+)?',\n                    '(?:' + urlSuffixRegex.source + ')?' // match for path, query string, and/or hash anchor - optional\n                ].join(\"\"), 'gi');\n            })();\n            /**\n             * A regular expression to use to check the character before a protocol-relative\n             * URL match. We don't want to match a protocol-relative URL if it is part\n             * of another word.\n             *\n             * For example, we want to match something like \"Go to: //google.com\",\n             * but we don't want to match something like \"abc//google.com\"\n             *\n             * This regular expression is used to test the character before the '//'.\n             *\n             * @protected\n             * @type {RegExp} wordCharRegExp\n             */\n            _this.wordCharRegExp = new RegExp('[' + alphaNumericAndMarksCharsStr + ']');\n            _this.stripPrefix = cfg.stripPrefix;\n            _this.stripTrailingSlash = cfg.stripTrailingSlash;\n            _this.decodePercentEncoding = cfg.decodePercentEncoding;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        UrlMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, stripPrefix = this.stripPrefix, stripTrailingSlash = this.stripTrailingSlash, decodePercentEncoding = this.decodePercentEncoding, tagBuilder = this.tagBuilder, matches = [], match;\n            var _loop_1 = function () {\n                var matchStr = match[0], schemeUrlMatch = match[1], wwwUrlMatch = match[4], wwwProtocolRelativeMatch = match[5],\n                //tldUrlMatch = match[ 8 ],  -- not needed at the moment\n                tldProtocolRelativeMatch = match[9], offset = match.index, protocolRelativeMatch = wwwProtocolRelativeMatch || tldProtocolRelativeMatch, prevChar = text.charAt(offset - 1);\n                if (!UrlMatchValidator.isValid(matchStr, schemeUrlMatch)) {\n                    return \"continue\";\n                }\n                // If the match is preceded by an '@' character, then it is either\n                // an email address or a username. Skip these types of matches.\n                if (offset > 0 && prevChar === '@') {\n                    return \"continue\";\n                }\n                // If it's a protocol-relative '//' match, but the character before the '//'\n                // was a word character (i.e. a letter/number), then we found the '//' in the\n                // middle of another word (such as \"asdf//asdf.com\"). In this case, skip the\n                // match.\n                if (offset > 0 && protocolRelativeMatch && this_1.wordCharRegExp.test(prevChar)) {\n                    return \"continue\";\n                }\n                // If the URL ends with a question mark, don't include the question\n                // mark as part of the URL. We'll assume the question mark was the\n                // end of a sentence, such as: \"Going to google.com?\"\n                if (/\\?$/.test(matchStr)) {\n                    matchStr = matchStr.substr(0, matchStr.length - 1);\n                }\n                // Handle a closing parenthesis or square bracket at the end of the\n                // match, and exclude it if there is not a matching open parenthesis\n                // or square bracket in the match itself.\n                if (this_1.matchHasUnbalancedClosingParen(matchStr)) {\n                    matchStr = matchStr.substr(0, matchStr.length - 1); // remove the trailing \")\"\n                }\n                else {\n                    // Handle an invalid character after the TLD\n                    var pos = this_1.matchHasInvalidCharAfterTld(matchStr, schemeUrlMatch);\n                    if (pos > -1) {\n                        matchStr = matchStr.substr(0, pos); // remove the trailing invalid chars\n                    }\n                }\n                // The autolinker accepts many characters in a url's scheme (like `fake://test.com`).\n                // However, in cases where a URL is missing whitespace before an obvious link,\n                // (for example: `nowhitespacehttp://www.test.com`), we only want the match to start\n                // at the http:// part. We will check if the match contains a common scheme and then\n                // shift the match to start from there.\n                var foundCommonScheme = ['http://', 'https://'].find(function (commonScheme) { return !!schemeUrlMatch && schemeUrlMatch.indexOf(commonScheme) !== -1; });\n                if (foundCommonScheme) {\n                    // If we found an overmatched URL, we want to find the index\n                    // of where the match should start and shift the match to\n                    // start from the beginning of the common scheme\n                    var indexOfSchemeStart = matchStr.indexOf(foundCommonScheme);\n                    matchStr = matchStr.substr(indexOfSchemeStart);\n                    schemeUrlMatch = schemeUrlMatch.substr(indexOfSchemeStart);\n                    offset = offset + indexOfSchemeStart;\n                }\n                var urlMatchType = schemeUrlMatch ? 'scheme' : (wwwUrlMatch ? 'www' : 'tld'), protocolUrlMatch = !!schemeUrlMatch;\n                matches.push(new UrlMatch({\n                    tagBuilder: tagBuilder,\n                    matchedText: matchStr,\n                    offset: offset,\n                    urlMatchType: urlMatchType,\n                    url: matchStr,\n                    protocolUrlMatch: protocolUrlMatch,\n                    protocolRelativeMatch: !!protocolRelativeMatch,\n                    stripPrefix: stripPrefix,\n                    stripTrailingSlash: stripTrailingSlash,\n                    decodePercentEncoding: decodePercentEncoding,\n                }));\n            };\n            var this_1 = this;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                _loop_1();\n            }\n            return matches;\n        };\n        /**\n         * Determines if a match found has an unmatched closing parenthesis or\n         * square bracket. If so, the parenthesis or square bracket will be removed\n         * from the match itself, and appended after the generated anchor tag.\n         *\n         * A match may have an extra closing parenthesis at the end of the match\n         * because the regular expression must include parenthesis for URLs such as\n         * \"wikipedia.com/something_(disambiguation)\", which should be auto-linked.\n         *\n         * However, an extra parenthesis *will* be included when the URL itself is\n         * wrapped in parenthesis, such as in the case of:\n         *     \"(wikipedia.com/something_(disambiguation))\"\n         * In this case, the last closing parenthesis should *not* be part of the\n         * URL itself, and this method will return `true`.\n         *\n         * For square brackets in URLs such as in PHP arrays, the same behavior as\n         * parenthesis discussed above should happen:\n         *     \"[http-colon-slashslash www.example.com/foo.php?bar[]=1&bar[]=2&bar[]=3]\"\n         * The closing square bracket should not be part of the URL itself, and this\n         * method will return `true`.\n         *\n         * @protected\n         * @param {String} matchStr The full match string from the {@link #matcherRegex}.\n         * @return {Boolean} `true` if there is an unbalanced closing parenthesis or\n         *   square bracket at the end of the `matchStr`, `false` otherwise.\n         */\n        UrlMatcher.prototype.matchHasUnbalancedClosingParen = function (matchStr) {\n            var endChar = matchStr.charAt(matchStr.length - 1);\n            var startChar;\n            if (endChar === ')') {\n                startChar = '(';\n            }\n            else if (endChar === ']') {\n                startChar = '[';\n            }\n            else {\n                return false; // not a close parenthesis or square bracket\n            }\n            // Find if there are the same number of open braces as close braces in\n            // the URL string, minus the last character (which we have already\n            // determined to be either ')' or ']'\n            var numOpenBraces = 0;\n            for (var i = 0, len = matchStr.length - 1; i < len; i++) {\n                var char = matchStr.charAt(i);\n                if (char === startChar) {\n                    numOpenBraces++;\n                }\n                else if (char === endChar) {\n                    numOpenBraces = Math.max(numOpenBraces - 1, 0);\n                }\n            }\n            // If the number of open braces matches the number of close braces in\n            // the URL minus the last character, then the match has *unbalanced*\n            // braces because of the last character. Example of unbalanced braces\n            // from the regex match:\n            //     \"http://example.com?a[]=1]\"\n            if (numOpenBraces === 0) {\n                return true;\n            }\n            return false;\n        };\n        /**\n         * Determine if there's an invalid character after the TLD in a URL. Valid\n         * characters after TLD are ':/?#'. Exclude scheme matched URLs from this\n         * check.\n         *\n         * @protected\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} schemeUrlMatch The match URL string for a scheme\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Number} the position where the invalid character was found. If\n         *   no such character was found, returns -1\n         */\n        UrlMatcher.prototype.matchHasInvalidCharAfterTld = function (urlMatch, schemeUrlMatch) {\n            if (!urlMatch) {\n                return -1;\n            }\n            var offset = 0;\n            if (schemeUrlMatch) {\n                offset = urlMatch.indexOf(':');\n                urlMatch = urlMatch.slice(offset);\n            }\n            var re = new RegExp(\"^((.?\\/\\/)?[-.\" + alphaNumericAndMarksCharsStr + \"]*[-\" + alphaNumericAndMarksCharsStr + \"]\\\\.[-\" + alphaNumericAndMarksCharsStr + \"]+)\");\n            var res = re.exec(urlMatch);\n            if (res === null) {\n                return -1;\n            }\n            offset += res[1].length;\n            urlMatch = urlMatch.slice(res[1].length);\n            if (/^[^-.A-Za-z0-9:\\/?#]/.test(urlMatch)) {\n                return offset;\n            }\n            return -1;\n        };\n        return UrlMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Hashtag\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find HashtagMatch matches in an input string.\n     */\n    var HashtagMatcher = /** @class */ (function (_super) {\n        __extends(HashtagMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function HashtagMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point hashtag matches to. See {@link Autolinker#hashtag}\n             * for available values.\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * The regular expression to match Hashtags. Example match:\n             *\n             *     #asdf\n             *\n             * @protected\n             * @property {RegExp} matcherRegex\n             */\n            _this.matcherRegex = new RegExp(\"#[_\" + alphaNumericAndMarksCharsStr + \"]{1,139}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'); // lookahead used to make sure we don't match something above 139 characters\n            /**\n             * The regular expression to use to check the character before a username match to\n             * make sure we didn't accidentally match an email address.\n             *\n             * For example, the string \"asdf@asdf.com\" should not match \"@asdf\" as a username.\n             *\n             * @protected\n             * @property {RegExp} nonWordCharRegex\n             */\n            _this.nonWordCharRegex = new RegExp('[^' + alphaNumericAndMarksCharsStr + ']');\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        HashtagMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, nonWordCharRegex = this.nonWordCharRegex, serviceName = this.serviceName, tagBuilder = this.tagBuilder, matches = [], match;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                var offset = match.index, prevChar = text.charAt(offset - 1);\n                // If we found the match at the beginning of the string, or we found the match\n                // and there is a whitespace char in front of it (meaning it is not a '#' char\n                // in the middle of a word), then it is a hashtag match.\n                if (offset === 0 || nonWordCharRegex.test(prevChar)) {\n                    var matchedText = match[0], hashtag = match[0].slice(1); // strip off the '#' character at the beginning\n                    matches.push(new HashtagMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: offset,\n                        serviceName: serviceName,\n                        hashtag: hashtag\n                    }));\n                }\n            }\n            return matches;\n        };\n        return HashtagMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Phone\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find Phone number matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more\n     * details.\n     */\n    var PhoneMatcher = /** @class */ (function (_super) {\n        __extends(PhoneMatcher, _super);\n        function PhoneMatcher() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            /**\n             * The regular expression to match Phone numbers. Example match:\n             *\n             *     (123) 456-7890\n             *\n             * This regular expression has the following capturing groups:\n             *\n             * 1 or 2. The prefixed '+' sign, if there is one.\n             *\n             * @protected\n             * @property {RegExp} matcherRegex\n             */\n            _this.matcherRegex = /(?:(?:(?:(\\+)?\\d{1,3}[-\\040.]?)?\\(?\\d{3}\\)?[-\\040.]?\\d{3}[-\\040.]?\\d{4})|(?:(\\+)(?:9[976]\\d|8[987530]\\d|6[987]\\d|5[90]\\d|42\\d|3[875]\\d|2[98654321]\\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\\040.]?(?:\\d[-\\040.]?){6,12}\\d+))([,;]+[0-9]+#?)*/g;\n            return _this;\n        }\n        // ex: (123) 456-7890, 123 456 7890, 123-456-7890, +18004441234,,;,10226420346#,\n        // +1 (800) 444 1234, 10226420346#, 1-800-444-1234,1022,64,20346#\n        /**\n         * @inheritdoc\n         */\n        PhoneMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, tagBuilder = this.tagBuilder, matches = [], match;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                // Remove non-numeric values from phone number string\n                var matchedText = match[0], cleanNumber = matchedText.replace(/[^0-9,;#]/g, ''), // strip out non-digit characters exclude comma semicolon and #\n                plusSign = !!(match[1] || match[2]), // match[ 1 ] or match[ 2 ] is the prefixed plus sign, if there is one\n                before = match.index == 0 ? '' : text.substr(match.index - 1, 1), after = text.substr(match.index + matchedText.length, 1), contextClear = !before.match(/\\d/) && !after.match(/\\d/);\n                if (this.testMatch(match[3]) && this.testMatch(matchedText) && contextClear) {\n                    matches.push(new PhoneMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: match.index,\n                        number: cleanNumber,\n                        plusSign: plusSign\n                    }));\n                }\n            }\n            return matches;\n        };\n        PhoneMatcher.prototype.testMatch = function (text) {\n            return /\\D/.test(text);\n        };\n        return PhoneMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Mention\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find/replace username matches in an input string.\n     */\n    var MentionMatcher = /** @class */ (function (_super) {\n        __extends(MentionMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function MentionMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {'twitter'/'instagram'/'soundcloud'} protected\n             *\n             * The name of service to link @mentions to.\n             *\n             * Valid values are: 'twitter', 'instagram', or 'soundcloud'\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * Hash of regular expression to match username handles. Example match:\n             *\n             *     @asdf\n             *\n             * @private\n             * @property {Object} matcherRegexes\n             */\n            _this.matcherRegexes = {\n                'twitter': new RegExp(\"@[_\" + alphaNumericAndMarksCharsStr + \"]{1,50}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'),\n                'instagram': new RegExp(\"@[_.\" + alphaNumericAndMarksCharsStr + \"]{1,30}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'),\n                'soundcloud': new RegExp(\"@[-_.\" + alphaNumericAndMarksCharsStr + \"]{1,50}(?![-_\" + alphaNumericAndMarksCharsStr + \"])\", 'g') // lookahead used to make sure we don't match something above 50 characters\n            };\n            /**\n             * The regular expression to use to check the character before a username match to\n             * make sure we didn't accidentally match an email address.\n             *\n             * For example, the string \"asdf@asdf.com\" should not match \"@asdf\" as a username.\n             *\n             * @private\n             * @property {RegExp} nonWordCharRegex\n             */\n            _this.nonWordCharRegex = new RegExp('[^' + alphaNumericAndMarksCharsStr + ']');\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        MentionMatcher.prototype.parseMatches = function (text) {\n            var serviceName = this.serviceName, matcherRegex = this.matcherRegexes[this.serviceName], nonWordCharRegex = this.nonWordCharRegex, tagBuilder = this.tagBuilder, matches = [], match;\n            if (!matcherRegex) {\n                return matches;\n            }\n            while ((match = matcherRegex.exec(text)) !== null) {\n                var offset = match.index, prevChar = text.charAt(offset - 1);\n                // If we found the match at the beginning of the string, or we found the match\n                // and there is a whitespace char in front of it (meaning it is not an email\n                // address), then it is a username match.\n                if (offset === 0 || nonWordCharRegex.test(prevChar)) {\n                    var matchedText = match[0].replace(/\\.+$/g, ''), // strip off trailing .\n                    mention = matchedText.slice(1); // strip off the '@' character at the beginning\n                    matches.push(new MentionMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: offset,\n                        serviceName: serviceName,\n                        mention: mention\n                    }));\n                }\n            }\n            return matches;\n        };\n        return MentionMatcher;\n    }(Matcher));\n\n    // For debugging: search for other \"For debugging\" lines\n    // import CliTable from 'cli-table';\n    /**\n     * Parses an HTML string, calling the callbacks to notify of tags and text.\n     *\n     * ## History\n     *\n     * This file previously used a regular expression to find html tags in the input\n     * text. Unfortunately, we ran into a bunch of catastrophic backtracking issues\n     * with certain input text, causing Autolinker to either hang or just take a\n     * really long time to parse the string.\n     *\n     * The current code is intended to be a O(n) algorithm that walks through\n     * the string in one pass, and tries to be as cheap as possible. We don't need\n     * to implement the full HTML spec, but rather simply determine where the string\n     * looks like an HTML tag, and where it looks like text (so that we can autolink\n     * that).\n     *\n     * This state machine parser is intended just to be a simple but performant\n     * parser of HTML for the subset of requirements we have. We simply need to:\n     *\n     * 1. Determine where HTML tags are\n     * 2. Determine the tag name (Autolinker specifically only cares about <a>,\n     *    <script>, and <style> tags, so as not to link any text within them)\n     *\n     * We don't need to:\n     *\n     * 1. Create a parse tree\n     * 2. Auto-close tags with invalid markup\n     * 3. etc.\n     *\n     * The other intention behind this is that we didn't want to add external\n     * dependencies on the Autolinker utility which would increase its size. For\n     * instance, adding htmlparser2 adds 125kb to the minified output file,\n     * increasing its final size from 47kb to 172kb (at the time of writing). It\n     * also doesn't work exactly correctly, treating the string \"<3 blah blah blah\"\n     * as an HTML tag.\n     *\n     * Reference for HTML spec:\n     *\n     *     https-colon-slashslash www.w3.org/TR/html51/syntax.html#sec-tokenization\n     *\n     * @param {String} html The HTML to parse\n     * @param {Object} callbacks\n     * @param {Function} callbacks.onOpenTag Callback function to call when an open\n     *   tag is parsed. Called with the tagName as its argument.\n     * @param {Function} callbacks.onCloseTag Callback function to call when a close\n     *   tag is parsed. Called with the tagName as its argument. If a self-closing\n     *   tag is found, `onCloseTag` is called immediately after `onOpenTag`.\n     * @param {Function} callbacks.onText Callback function to call when text (i.e\n     *   not an HTML tag) is parsed. Called with the text (string) as its first\n     *   argument, and offset (number) into the string as its second.\n     */\n    function parseHtml(html, _a) {\n        var onOpenTag = _a.onOpenTag, onCloseTag = _a.onCloseTag, onText = _a.onText, onComment = _a.onComment, onDoctype = _a.onDoctype;\n        var noCurrentTag = new CurrentTag();\n        var charIdx = 0, len = html.length, state = 0 /* Data */, currentDataIdx = 0, // where the current data start index is\n        currentTag = noCurrentTag; // describes the current tag that is being read\n        // For debugging: search for other \"For debugging\" lines\n        // const table = new CliTable( {\n        // \thead: [ 'charIdx', 'char', 'state', 'currentDataIdx', 'currentOpenTagIdx', 'tag.type' ]\n        // } );\n        while (charIdx < len) {\n            var char = html.charAt(charIdx);\n            // For debugging: search for other \"For debugging\" lines\n            // ALSO: Temporarily remove the 'const' keyword on the State enum\n            // table.push(\n            // \t[ charIdx, char, State[ state ], currentDataIdx, currentTag.idx, currentTag.idx === -1 ? '' : currentTag.type ]\n            // );\n            switch (state) {\n                case 0 /* Data */:\n                    stateData(char);\n                    break;\n                case 1 /* TagOpen */:\n                    stateTagOpen(char);\n                    break;\n                case 2 /* EndTagOpen */:\n                    stateEndTagOpen(char);\n                    break;\n                case 3 /* TagName */:\n                    stateTagName(char);\n                    break;\n                case 4 /* BeforeAttributeName */:\n                    stateBeforeAttributeName(char);\n                    break;\n                case 5 /* AttributeName */:\n                    stateAttributeName(char);\n                    break;\n                case 6 /* AfterAttributeName */:\n                    stateAfterAttributeName(char);\n                    break;\n                case 7 /* BeforeAttributeValue */:\n                    stateBeforeAttributeValue(char);\n                    break;\n                case 8 /* AttributeValueDoubleQuoted */:\n                    stateAttributeValueDoubleQuoted(char);\n                    break;\n                case 9 /* AttributeValueSingleQuoted */:\n                    stateAttributeValueSingleQuoted(char);\n                    break;\n                case 10 /* AttributeValueUnquoted */:\n                    stateAttributeValueUnquoted(char);\n                    break;\n                case 11 /* AfterAttributeValueQuoted */:\n                    stateAfterAttributeValueQuoted(char);\n                    break;\n                case 12 /* SelfClosingStartTag */:\n                    stateSelfClosingStartTag(char);\n                    break;\n                case 13 /* MarkupDeclarationOpenState */:\n                    stateMarkupDeclarationOpen(char);\n                    break;\n                case 14 /* CommentStart */:\n                    stateCommentStart(char);\n                    break;\n                case 15 /* CommentStartDash */:\n                    stateCommentStartDash(char);\n                    break;\n                case 16 /* Comment */:\n                    stateComment(char);\n                    break;\n                case 17 /* CommentEndDash */:\n                    stateCommentEndDash(char);\n                    break;\n                case 18 /* CommentEnd */:\n                    stateCommentEnd(char);\n                    break;\n                case 19 /* CommentEndBang */:\n                    stateCommentEndBang(char);\n                    break;\n                case 20 /* Doctype */:\n                    stateDoctype(char);\n                    break;\n                default:\n                    throwUnhandledCaseError(state);\n            }\n            // For debugging: search for other \"For debugging\" lines\n            // ALSO: Temporarily remove the 'const' keyword on the State enum\n            // table.push(\n            // \t[ charIdx, char, State[ state ], currentDataIdx, currentTag.idx, currentTag.idx === -1 ? '' : currentTag.type ]\n            // );\n            charIdx++;\n        }\n        if (currentDataIdx < charIdx) {\n            emitText();\n        }\n        // For debugging: search for other \"For debugging\" lines\n        // console.log( '\\n' + table.toString() );\n        // Called when non-tags are being read (i.e. the text around HTML ags)\n        // https://www.w3.org/TR/html51/syntax.html#data-state\n        function stateData(char) {\n            if (char === '<') {\n                startNewTag();\n            }\n        }\n        // Called after a '<' is read from the Data state\n        // https://www.w3.org/TR/html51/syntax.html#tag-open-state\n        function stateTagOpen(char) {\n            if (char === '!') {\n                state = 13 /* MarkupDeclarationOpenState */;\n            }\n            else if (char === '/') {\n                state = 2 /* EndTagOpen */;\n                currentTag = new CurrentTag(__assign({}, currentTag, { isClosing: true }));\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (letterRe.test(char)) {\n                // tag name start (and no '/' read)\n                state = 3 /* TagName */;\n                currentTag = new CurrentTag(__assign({}, currentTag, { isOpening: true }));\n            }\n            else {\n                // Any other\n                state = 0 /* Data */;\n                currentTag = noCurrentTag;\n            }\n        }\n        // After a '<x', '</x' sequence is read (where 'x' is a letter character),\n        // this is to continue reading the tag name\n        // https://www.w3.org/TR/html51/syntax.html#tag-name-state\n        function stateTagName(char) {\n            if (whitespaceRe.test(char)) {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (char === '/') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (!letterRe.test(char) && !digitRe.test(char) && char !== ':') {\n                // Anything else that does not form an html tag. Note: the colon\n                // character is accepted for XML namespaced tags\n                resetToDataState();\n            }\n        }\n        // Called after the '/' is read from a '</' sequence\n        // https://www.w3.org/TR/html51/syntax.html#end-tag-open-state\n        function stateEndTagOpen(char) {\n            if (char === '>') { // parse error. Encountered \"</>\". Skip it without treating as a tag\n                resetToDataState();\n            }\n            else if (letterRe.test(char)) {\n                state = 3 /* TagName */;\n            }\n            else {\n                // some other non-tag-like character, don't treat this as a tag\n                resetToDataState();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#before-attribute-name-state\n        function stateBeforeAttributeName(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (char === \"=\" || quoteRe.test(char) || controlCharsRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n            else {\n                // Any other char, start of a new attribute name\n                state = 5 /* AttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-name-state\n        function stateAttributeName(char) {\n            if (whitespaceRe.test(char)) {\n                state = 6 /* AfterAttributeName */;\n            }\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '=') {\n                state = 7 /* BeforeAttributeValue */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (quoteRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#after-attribute-name-state\n        function stateAfterAttributeName(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '=') {\n                state = 7 /* BeforeAttributeValue */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (quoteRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n            else {\n                // Any other character, start a new attribute in the current tag\n                state = 5 /* AttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#before-attribute-value-state\n        function stateBeforeAttributeValue(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === \"\\\"\") {\n                state = 8 /* AttributeValueDoubleQuoted */;\n            }\n            else if (char === \"'\") {\n                state = 9 /* AttributeValueSingleQuoted */;\n            }\n            else if (/[>=`]/.test(char)) {\n                // Invalid chars after an '=' for an attribute value, don't count\n                // the current tag as an HTML tag\n                resetToDataState();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else {\n                // Any other character, consider it an unquoted attribute value\n                state = 10 /* AttributeValueUnquoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-double-quoted-state\n        function stateAttributeValueDoubleQuoted(char) {\n            if (char === \"\\\"\") { // end the current double-quoted attribute\n                state = 11 /* AfterAttributeValueQuoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-single-quoted-state\n        function stateAttributeValueSingleQuoted(char) {\n            if (char === \"'\") { // end the current single-quoted attribute\n                state = 11 /* AfterAttributeValueQuoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-unquoted-state\n        function stateAttributeValueUnquoted(char) {\n            if (whitespaceRe.test(char)) {\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#after-attribute-value-quoted-state\n        function stateAfterAttributeValueQuoted(char) {\n            if (whitespaceRe.test(char)) {\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else {\n                // Any other character, \"parse error\". Spec says to switch to the\n                // BeforeAttributeState and re-consume the character, as it may be\n                // the start of a new attribute name\n                state = 4 /* BeforeAttributeName */;\n                reconsumeCurrentCharacter();\n            }\n        }\n        // A '/' has just been read in the current tag (presumably for '/>'), and\n        // this handles the next character\n        // https://www.w3.org/TR/html51/syntax.html#self-closing-start-tag-state\n        function stateSelfClosingStartTag(char) {\n            if (char === '>') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { isClosing: true }));\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else {\n                state = 4 /* BeforeAttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#markup-declaration-open-state\n        // (HTML Comments or !DOCTYPE)\n        function stateMarkupDeclarationOpen(char) {\n            if (html.substr(charIdx, 2) === '--') { // html comment\n                charIdx += 2; // \"consume\" characters\n                currentTag = new CurrentTag(__assign({}, currentTag, { type: 'comment' }));\n                state = 14 /* CommentStart */;\n            }\n            else if (html.substr(charIdx, 7).toUpperCase() === 'DOCTYPE') {\n                charIdx += 7; // \"consume\" characters\n                currentTag = new CurrentTag(__assign({}, currentTag, { type: 'doctype' }));\n                state = 20 /* Doctype */;\n            }\n            else {\n                // At this point, the spec specifies that the state machine should\n                // enter the \"bogus comment\" state, in which case any character(s)\n                // after the '<!' that were read should become an HTML comment up\n                // until the first '>' that is read (or EOF). Instead, we'll assume\n                // that a user just typed '<!' as part of text data\n                resetToDataState();\n            }\n        }\n        // Handles after the sequence '<!--' has been read\n        // https://www.w3.org/TR/html51/syntax.html#comment-start-state\n        function stateCommentStart(char) {\n            if (char === '-') {\n                // We've read the sequence '<!---' at this point (3 dashes)\n                state = 15 /* CommentStartDash */;\n            }\n            else if (char === '>') {\n                // At this point, we'll assume the comment wasn't a real comment\n                // so we'll just emit it as data. We basically read the sequence\n                // '<!-->'\n                resetToDataState();\n            }\n            else {\n                // Any other char, take it as part of the comment\n                state = 16 /* Comment */;\n            }\n        }\n        // We've read the sequence '<!---' at this point (3 dashes)\n        // https://www.w3.org/TR/html51/syntax.html#comment-start-dash-state\n        function stateCommentStartDash(char) {\n            if (char === '-') {\n                // We've read '<!----' (4 dashes) at this point\n                state = 18 /* CommentEnd */;\n            }\n            else if (char === '>') {\n                // At this point, we'll assume the comment wasn't a real comment\n                // so we'll just emit it as data. We basically read the sequence\n                // '<!--->'\n                resetToDataState();\n            }\n            else {\n                // Anything else, take it as a valid comment\n                state = 16 /* Comment */;\n            }\n        }\n        // Currently reading the comment's text (data)\n        // https://www.w3.org/TR/html51/syntax.html#comment-state\n        function stateComment(char) {\n            if (char === '-') {\n                state = 17 /* CommentEndDash */;\n            }\n        }\n        // When we we've read the first dash inside a comment, it may signal the\n        // end of the comment if we read another dash\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-dash-state\n        function stateCommentEndDash(char) {\n            if (char === '-') {\n                state = 18 /* CommentEnd */;\n            }\n            else {\n                // Wasn't a dash, must still be part of the comment\n                state = 16 /* Comment */;\n            }\n        }\n        // After we've read two dashes inside a comment, it may signal the end of\n        // the comment if we then read a '>' char\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-state\n        function stateCommentEnd(char) {\n            if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '!') {\n                state = 19 /* CommentEndBang */;\n            }\n            else if (char === '-') ;\n            else {\n                // Anything else, switch back to the comment state since we didn't\n                // read the full \"end comment\" sequence (i.e. '-->')\n                state = 16 /* Comment */;\n            }\n        }\n        // We've read the sequence '--!' inside of a comment\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-bang-state\n        function stateCommentEndBang(char) {\n            if (char === '-') {\n                // We read the sequence '--!-' inside of a comment. The last dash\n                // could signify that the comment is going to close\n                state = 17 /* CommentEndDash */;\n            }\n            else if (char === '>') {\n                // End of comment with the sequence '--!>'\n                emitTagAndPreviousTextNode();\n            }\n            else {\n                // The '--!' was not followed by a '>', continue reading the\n                // comment's text\n                state = 16 /* Comment */;\n            }\n        }\n        /**\n         * For DOCTYPES in particular, we don't care about the attributes. Just\n         * advance to the '>' character and emit the tag, unless we find a '<'\n         * character in which case we'll start a new tag.\n         *\n         * Example doctype tag:\n         *    <!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http-colon-slashslash www.w3.org/TR/html4/strict.dtd\">\n         *\n         * Actual spec: https-colon-slashslash www.w3.org/TR/html51/syntax.html#doctype-state\n         */\n        function stateDoctype(char) {\n            if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                startNewTag();\n            }\n        }\n        /**\n         * Resets the state back to the Data state, and removes the current tag.\n         *\n         * We'll generally run this function whenever a \"parse error\" is\n         * encountered, where the current tag that is being read no longer looks\n         * like a real HTML tag.\n         */\n        function resetToDataState() {\n            state = 0 /* Data */;\n            currentTag = noCurrentTag;\n        }\n        /**\n         * Starts a new HTML tag at the current index, ignoring any previous HTML\n         * tag that was being read.\n         *\n         * We'll generally run this function whenever we read a new '<' character,\n         * including when we read a '<' character inside of an HTML tag that we were\n         * previously reading.\n         */\n        function startNewTag() {\n            state = 1 /* TagOpen */;\n            currentTag = new CurrentTag({ idx: charIdx });\n        }\n        /**\n         * Once we've decided to emit an open tag, that means we can also emit the\n         * text node before it.\n         */\n        function emitTagAndPreviousTextNode() {\n            var textBeforeTag = html.slice(currentDataIdx, currentTag.idx);\n            if (textBeforeTag) {\n                // the html tag was the first element in the html string, or two\n                // tags next to each other, in which case we should not emit a text\n                // node\n                onText(textBeforeTag, currentDataIdx);\n            }\n            if (currentTag.type === 'comment') {\n                onComment(currentTag.idx);\n            }\n            else if (currentTag.type === 'doctype') {\n                onDoctype(currentTag.idx);\n            }\n            else {\n                if (currentTag.isOpening) {\n                    onOpenTag(currentTag.name, currentTag.idx);\n                }\n                if (currentTag.isClosing) { // note: self-closing tags will emit both opening and closing\n                    onCloseTag(currentTag.name, currentTag.idx);\n                }\n            }\n            // Since we just emitted a tag, reset to the data state for the next char\n            resetToDataState();\n            currentDataIdx = charIdx + 1;\n        }\n        function emitText() {\n            var text = html.slice(currentDataIdx, charIdx);\n            onText(text, currentDataIdx);\n            currentDataIdx = charIdx + 1;\n        }\n        /**\n         * Captures the tag name from the start of the tag to the current character\n         * index, and converts it to lower case\n         */\n        function captureTagName() {\n            var startIdx = currentTag.idx + (currentTag.isClosing ? 2 : 1);\n            return html.slice(startIdx, charIdx).toLowerCase();\n        }\n        /**\n         * Causes the main loop to re-consume the current character, such as after\n         * encountering a \"parse error\" that changed state and needs to reconsume\n         * the same character in that new state.\n         */\n        function reconsumeCurrentCharacter() {\n            charIdx--;\n        }\n    }\n    var CurrentTag = /** @class */ (function () {\n        function CurrentTag(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            this.idx = cfg.idx !== undefined ? cfg.idx : -1;\n            this.type = cfg.type || 'tag';\n            this.name = cfg.name || '';\n            this.isOpening = !!cfg.isOpening;\n            this.isClosing = !!cfg.isClosing;\n        }\n        return CurrentTag;\n    }());\n\n    /**\n     * @class Autolinker\n     * @extends Object\n     *\n     * Utility class used to process a given string of text, and wrap the matches in\n     * the appropriate anchor (&lt;a&gt;) tags to turn them into links.\n     *\n     * Any of the configuration options may be provided in an Object provided\n     * to the Autolinker constructor, which will configure how the {@link #link link()}\n     * method will process the links.\n     *\n     * For example:\n     *\n     *     var autolinker = new Autolinker( {\n     *         newWindow : false,\n     *         truncate  : 30\n     *     } );\n     *\n     *     var html = autolinker.link( \"Joe went to www.yahoo.com\" );\n     *     // produces: 'Joe went to <a href=\"http-colon-slashslash www.yahoo.com\">yahoo.com</a>'\n     *\n     *\n     * The {@link #static-link static link()} method may also be used to inline\n     * options into a single call, which may be more convenient for one-off uses.\n     * For example:\n     *\n     *     var html = Autolinker.link( \"Joe went to www.yahoo.com\", {\n     *         newWindow : false,\n     *         truncate  : 30\n     *     } );\n     *     // produces: 'Joe went to <a href=\"http-colon-slashslash www.yahoo.com\">yahoo.com</a>'\n     *\n     *\n     * ## Custom Replacements of Links\n     *\n     * If the configuration options do not provide enough flexibility, a {@link #replaceFn}\n     * may be provided to fully customize the output of Autolinker. This function is\n     * called once for each URL/Email/Phone#/Hashtag/Mention (Twitter, Instagram, Soundcloud)\n     * match that is encountered.\n     *\n     * For example:\n     *\n     *     var input = \"...\";  // string with URLs, Email Addresses, Phone #s, Hashtags, and Mentions (Twitter, Instagram, Soundcloud)\n     *\n     *     var linkedText = Autolinker.link( input, {\n     *         replaceFn : function( match ) {\n     *             console.log( \"href = \", match.getAnchorHref() );\n     *             console.log( \"text = \", match.getAnchorText() );\n     *\n     *             switch( match.getType() ) {\n     *                 case 'url' :\n     *                     console.log( \"url: \", match.getUrl() );\n     *\n     *                     if( match.getUrl().indexOf( 'mysite.com' ) === -1 ) {\n     *                         var tag = match.buildTag();  // returns an `Autolinker.HtmlTag` instance, which provides mutator methods for easy changes\n     *                         tag.setAttr( 'rel', 'nofollow' );\n     *                         tag.addClass( 'external-link' );\n     *\n     *                         return tag;\n     *\n     *                     } else {\n     *                         return true;  // let Autolinker perform its normal anchor tag replacement\n     *                     }\n     *\n     *                 case 'email' :\n     *                     var email = match.getEmail();\n     *                     console.log( \"email: \", email );\n     *\n     *                     if( email === \"my@own.address\" ) {\n     *                         return false;  // don't auto-link this particular email address; leave as-is\n     *                     } else {\n     *                         return;  // no return value will have Autolinker perform its normal anchor tag replacement (same as returning `true`)\n     *                     }\n     *\n     *                 case 'phone' :\n     *                     var phoneNumber = match.getPhoneNumber();\n     *                     console.log( phoneNumber );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.phone.numbers.to/\">' + phoneNumber + '</a>';\n     *\n     *                 case 'hashtag' :\n     *                     var hashtag = match.getHashtag();\n     *                     console.log( hashtag );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.hashtag.handles.to/\">' + hashtag + '</a>';\n     *\n     *                 case 'mention' :\n     *                     var mention = match.getMention();\n     *                     console.log( mention );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.mention.to/\">' + mention + '</a>';\n     *             }\n     *         }\n     *     } );\n     *\n     *\n     * The function may return the following values:\n     *\n     * - `true` (Boolean): Allow Autolinker to replace the match as it normally\n     *   would.\n     * - `false` (Boolean): Do not replace the current match at all - leave as-is.\n     * - Any String: If a string is returned from the function, the string will be\n     *   used directly as the replacement HTML for the match.\n     * - An {@link Autolinker.HtmlTag} instance, which can be used to build/modify\n     *   an HTML tag before writing out its HTML text.\n     */\n    var Autolinker = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration options for the Autolinker instance,\n         *   specified in an Object (map).\n         */\n        function Autolinker(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * The Autolinker version number exposed on the instance itself.\n             *\n             * Ex: 0.25.1\n             */\n            this.version = Autolinker.version;\n            /**\n             * @cfg {Boolean/Object} [urls]\n             *\n             * `true` if URLs should be automatically linked, `false` if they should not\n             * be. Defaults to `true`.\n             *\n             * Examples:\n             *\n             *     urls: true\n             *\n             *     // or\n             *\n             *     urls: {\n             *         schemeMatches : true,\n             *         wwwMatches    : true,\n             *         tldMatches    : true\n             *     }\n             *\n             * As shown above, this option also accepts an Object form with 3 properties\n             * to allow for more customization of what exactly gets linked. All default\n             * to `true`:\n             *\n             * @cfg {Boolean} [urls.schemeMatches] `true` to match URLs found prefixed\n             *   with a scheme, i.e. `http-colon-slashslash google.com`, or `other+scheme://google.com`,\n             *   `false` to prevent these types of matches.\n             * @cfg {Boolean} [urls.wwwMatches] `true` to match urls found prefixed with\n             *   `'www.'`, i.e. `www.google.com`. `false` to prevent these types of\n             *   matches. Note that if the URL had a prefixed scheme, and\n             *   `schemeMatches` is true, it will still be linked.\n             * @cfg {Boolean} [urls.tldMatches] `true` to match URLs with known top\n             *   level domains (.com, .net, etc.) that are not prefixed with a scheme or\n             *   `'www.'`. This option attempts to match anything that looks like a URL\n             *   in the given text. Ex: `google.com`, `asdf.org/?page=1`, etc. `false`\n             *   to prevent these types of matches.\n             */\n            this.urls = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [email=true]\n             *\n             * `true` if email addresses should be automatically linked, `false` if they\n             * should not be.\n             */\n            this.email = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [phone=true]\n             *\n             * `true` if Phone numbers (\"(555)555-5555\") should be automatically linked,\n             * `false` if they should not be.\n             */\n            this.phone = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean/String} [hashtag=false]\n             *\n             * A string for the service name to have hashtags (ex: \"#myHashtag\")\n             * auto-linked to. The currently-supported values are:\n             *\n             * - 'twitter'\n             * - 'facebook'\n             * - 'instagram'\n             *\n             * Pass `false` to skip auto-linking of hashtags.\n             */\n            this.hashtag = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String/Boolean} [mention=false]\n             *\n             * A string for the service name to have mentions (ex: \"@myuser\")\n             * auto-linked to. The currently supported values are:\n             *\n             * - 'twitter'\n             * - 'instagram'\n             * - 'soundcloud'\n             *\n             * Defaults to `false` to skip auto-linking of mentions.\n             */\n            this.mention = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [newWindow=true]\n             *\n             * `true` if the links should open in a new window, `false` otherwise.\n             */\n            this.newWindow = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean/Object} [stripPrefix=true]\n             *\n             * `true` if 'http-colon-slashslash ' (or 'https-colon-slashslash ') and/or the 'www.' should be stripped\n             * from the beginning of URL links' text, `false` otherwise. Defaults to\n             * `true`.\n             *\n             * Examples:\n             *\n             *     stripPrefix: true\n             *\n             *     // or\n             *\n             *     stripPrefix: {\n             *         scheme : true,\n             *         www    : true\n             *     }\n             *\n             * As shown above, this option also accepts an Object form with 2 properties\n             * to allow for more customization of what exactly is prevented from being\n             * displayed. Both default to `true`:\n             *\n             * @cfg {Boolean} [stripPrefix.scheme] `true` to prevent the scheme part of\n             *   a URL match from being displayed to the user. Example:\n             *   `'http-colon-slashslash google.com'` will be displayed as `'google.com'`. `false` to\n             *   not strip the scheme. NOTE: Only an `'http-colon-slashslash '` or `'https-colon-slashslash '` scheme\n             *   will be removed, so as not to remove a potentially dangerous scheme\n             *   (such as `'file://'` or `'javascript:'`)\n             * @cfg {Boolean} [stripPrefix.www] www (Boolean): `true` to prevent the\n             *   `'www.'` part of a URL match from being displayed to the user. Ex:\n             *   `'www.google.com'` will be displayed as `'google.com'`. `false` to not\n             *   strip the `'www'`.\n             */\n            this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [stripTrailingSlash=true]\n             *\n             * `true` to remove the trailing slash from URL matches, `false` to keep\n             *  the trailing slash.\n             *\n             *  Example when `true`: `http-colon-slashslash google.com/` will be displayed as\n             *  `http-colon-slashslash google.com`.\n             */\n            this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [decodePercentEncoding=true]\n             *\n             * `true` to decode percent-encoded characters in URL matches, `false` to keep\n             *  the percent-encoded characters.\n             *\n             *  Example when `true`: `https-colon-slashslash en.wikipedia.org/wiki/San_Jos%C3%A9` will\n             *  be displayed as `https-colon-slashslash en.wikipedia.org/wiki/San_Jos`.\n             */\n            this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Number/Object} [truncate=0]\n             *\n             * ## Number Form\n             *\n             * A number for how many characters matched text should be truncated to\n             * inside the text of a link. If the matched text is over this number of\n             * characters, it will be truncated to this length by adding a two period\n             * ellipsis ('..') to the end of the string.\n             *\n             * For example: A url like 'http-colon-slashslash www.yahoo.com/some/long/path/to/a/file'\n             * truncated to 25 characters might look something like this:\n             * 'yahoo.com/some/long/pat..'\n             *\n             * Example Usage:\n             *\n             *     truncate: 25\n             *\n             *\n             *  Defaults to `0` for \"no truncation.\"\n             *\n             *\n             * ## Object Form\n             *\n             * An Object may also be provided with two properties: `length` (Number) and\n             * `location` (String). `location` may be one of the following: 'end'\n             * (default), 'middle', or 'smart'.\n             *\n             * Example Usage:\n             *\n             *     truncate: { length: 25, location: 'middle' }\n             *\n             * @cfg {Number} [truncate.length=0] How many characters to allow before\n             *   truncation will occur. Defaults to `0` for \"no truncation.\"\n             * @cfg {\"end\"/\"middle\"/\"smart\"} [truncate.location=\"end\"]\n             *\n             * - 'end' (default): will truncate up to the number of characters, and then\n             *   add an ellipsis at the end. Ex: 'yahoo.com/some/long/pat..'\n             * - 'middle': will truncate and add the ellipsis in the middle. Ex:\n             *   'yahoo.com/s..th/to/a/file'\n             * - 'smart': for URLs where the algorithm attempts to strip out unnecessary\n             *   parts first (such as the 'www.', then URL scheme, hash, etc.),\n             *   attempting to make the URL human-readable before looking for a good\n             *   point to insert the ellipsis if it is still too long. Ex:\n             *   'yahoo.com/some..to/a/file'. For more details, see\n             *   {@link Autolinker.truncate.TruncateSmart}.\n             */\n            this.truncate = { length: 0, location: 'end' }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} className\n             *\n             * A CSS class name to add to the generated links. This class will be added\n             * to all links, as well as this class plus match suffixes for styling\n             * url/email/phone/hashtag/mention links differently.\n             *\n             * For example, if this config is provided as \"myLink\", then:\n             *\n             * - URL links will have the CSS classes: \"myLink myLink-url\"\n             * - Email links will have the CSS classes: \"myLink myLink-email\", and\n             * - Phone links will have the CSS classes: \"myLink myLink-phone\"\n             * - Hashtag links will have the CSS classes: \"myLink myLink-hashtag\"\n             * - Mention links will have the CSS classes: \"myLink myLink-mention myLink-[type]\"\n             *   where [type] is either \"instagram\", \"twitter\" or \"soundcloud\"\n             */\n            this.className = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Function} replaceFn\n             *\n             * A function to individually process each match found in the input string.\n             *\n             * See the class's description for usage.\n             *\n             * The `replaceFn` can be called with a different context object (`this`\n             * reference) using the {@link #context} cfg.\n             *\n             * This function is called with the following parameter:\n             *\n             * @cfg {Autolinker.match.Match} replaceFn.match The Match instance which\n             *   can be used to retrieve information about the match that the `replaceFn`\n             *   is currently processing. See {@link Autolinker.match.Match} subclasses\n             *   for details.\n             */\n            this.replaceFn = null; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} context\n             *\n             * The context object (`this` reference) to call the `replaceFn` with.\n             *\n             * Defaults to this Autolinker instance.\n             */\n            this.context = undefined; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @private\n             * @property {Autolinker.matcher.Matcher[]} matchers\n             *\n             * The {@link Autolinker.matcher.Matcher} instances for this Autolinker\n             * instance.\n             *\n             * This is lazily created in {@link #getMatchers}.\n             */\n            this.matchers = null;\n            /**\n             * @private\n             * @property {Autolinker.AnchorTagBuilder} tagBuilder\n             *\n             * The AnchorTagBuilder instance used to build match replacement anchor tags.\n             * Note: this is lazily instantiated in the {@link #getTagBuilder} method.\n             */\n            this.tagBuilder = null;\n            // Note: when `this.something` is used in the rhs of these assignments,\n            //       it refers to the default values set above the constructor\n            this.urls = this.normalizeUrlsCfg(cfg.urls);\n            this.email = typeof cfg.email === 'boolean' ? cfg.email : this.email;\n            this.phone = typeof cfg.phone === 'boolean' ? cfg.phone : this.phone;\n            this.hashtag = cfg.hashtag || this.hashtag;\n            this.mention = cfg.mention || this.mention;\n            this.newWindow = typeof cfg.newWindow === 'boolean' ? cfg.newWindow : this.newWindow;\n            this.stripPrefix = this.normalizeStripPrefixCfg(cfg.stripPrefix);\n            this.stripTrailingSlash = typeof cfg.stripTrailingSlash === 'boolean' ? cfg.stripTrailingSlash : this.stripTrailingSlash;\n            this.decodePercentEncoding = typeof cfg.decodePercentEncoding === 'boolean' ? cfg.decodePercentEncoding : this.decodePercentEncoding;\n            // Validate the value of the `mention` cfg\n            var mention = this.mention;\n            if (mention !== false && mention !== 'twitter' && mention !== 'instagram' && mention !== 'soundcloud') {\n                throw new Error(\"invalid `mention` cfg - see docs\");\n            }\n            // Validate the value of the `hashtag` cfg\n            var hashtag = this.hashtag;\n            if (hashtag !== false && hashtag !== 'twitter' && hashtag !== 'facebook' && hashtag !== 'instagram') {\n                throw new Error(\"invalid `hashtag` cfg - see docs\");\n            }\n            this.truncate = this.normalizeTruncateCfg(cfg.truncate);\n            this.className = cfg.className || this.className;\n            this.replaceFn = cfg.replaceFn || this.replaceFn;\n            this.context = cfg.context || this;\n        }\n        /**\n         * Automatically links URLs, Email addresses, Phone Numbers, Twitter handles,\n         * Hashtags, and Mentions found in the given chunk of HTML. Does not link URLs\n         * found within HTML tags.\n         *\n         * For instance, if given the text: `You should go to http-colon-slashslash www.yahoo.com`,\n         * then the result will be `You should go to &lt;a href=\"http-colon-slashslash www.yahoo.com\"&gt;http-colon-slashslash www.yahoo.com&lt;/a&gt;`\n         *\n         * Example:\n         *\n         *     var linkedText = Autolinker.link( \"Go to google.com\", { newWindow: false } );\n         *     // Produces: \"Go to <a href=\"http-colon-slashslash google.com\">google.com</a>\"\n         *\n         * @static\n         * @param {String} textOrHtml The HTML or text to find matches within (depending\n         *   on if the {@link #urls}, {@link #email}, {@link #phone}, {@link #mention},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @param {Object} [options] Any of the configuration options for the Autolinker\n         *   class, specified in an Object (map). See the class description for an\n         *   example call.\n         * @return {String} The HTML text, with matches automatically linked.\n         */\n        Autolinker.link = function (textOrHtml, options) {\n            var autolinker = new Autolinker(options);\n            return autolinker.link(textOrHtml);\n        };\n        /**\n         * Parses the input `textOrHtml` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches (without making any replacements).\n         *\n         * Note that if parsing multiple pieces of text, it is slightly more efficient\n         * to create an Autolinker instance, and use the instance-level {@link #parse}\n         * method.\n         *\n         * Example:\n         *\n         *     var matches = Autolinker.parse( \"Hello google.com, I am asdf@asdf.com\", {\n         *         urls: true,\n         *         email: true\n         *     } );\n         *\n         *     console.log( matches.length );           // 2\n         *     console.log( matches[ 0 ].getType() );   // 'url'\n         *     console.log( matches[ 0 ].getUrl() );    // 'google.com'\n         *     console.log( matches[ 1 ].getType() );   // 'email'\n         *     console.log( matches[ 1 ].getEmail() );  // 'asdf@asdf.com'\n         *\n         * @static\n         * @param {String} textOrHtml The HTML or text to find matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @param {Object} [options] Any of the configuration options for the Autolinker\n         *   class, specified in an Object (map). See the class description for an\n         *   example call.\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `textOrHtml`.\n         */\n        Autolinker.parse = function (textOrHtml, options) {\n            var autolinker = new Autolinker(options);\n            return autolinker.parse(textOrHtml);\n        };\n        /**\n         * Normalizes the {@link #urls} config into an Object with 3 properties:\n         * `schemeMatches`, `wwwMatches`, and `tldMatches`, all Booleans.\n         *\n         * See {@link #urls} config for details.\n         *\n         * @private\n         * @param {Boolean/Object} urls\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeUrlsCfg = function (urls) {\n            if (urls == null)\n                urls = true; // default to `true`\n            if (typeof urls === 'boolean') {\n                return { schemeMatches: urls, wwwMatches: urls, tldMatches: urls };\n            }\n            else { // object form\n                return {\n                    schemeMatches: typeof urls.schemeMatches === 'boolean' ? urls.schemeMatches : true,\n                    wwwMatches: typeof urls.wwwMatches === 'boolean' ? urls.wwwMatches : true,\n                    tldMatches: typeof urls.tldMatches === 'boolean' ? urls.tldMatches : true\n                };\n            }\n        };\n        /**\n         * Normalizes the {@link #stripPrefix} config into an Object with 2\n         * properties: `scheme`, and `www` - both Booleans.\n         *\n         * See {@link #stripPrefix} config for details.\n         *\n         * @private\n         * @param {Boolean/Object} stripPrefix\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeStripPrefixCfg = function (stripPrefix) {\n            if (stripPrefix == null)\n                stripPrefix = true; // default to `true`\n            if (typeof stripPrefix === 'boolean') {\n                return { scheme: stripPrefix, www: stripPrefix };\n            }\n            else { // object form\n                return {\n                    scheme: typeof stripPrefix.scheme === 'boolean' ? stripPrefix.scheme : true,\n                    www: typeof stripPrefix.www === 'boolean' ? stripPrefix.www : true\n                };\n            }\n        };\n        /**\n         * Normalizes the {@link #truncate} config into an Object with 2 properties:\n         * `length` (Number), and `location` (String).\n         *\n         * See {@link #truncate} config for details.\n         *\n         * @private\n         * @param {Number/Object} truncate\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeTruncateCfg = function (truncate) {\n            if (typeof truncate === 'number') {\n                return { length: truncate, location: 'end' };\n            }\n            else { // object, or undefined/null\n                return defaults(truncate || {}, {\n                    length: Number.POSITIVE_INFINITY,\n                    location: 'end'\n                });\n            }\n        };\n        /**\n         * Parses the input `textOrHtml` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches (without making any replacements).\n         *\n         * This method is used by the {@link #link} method, but can also be used to\n         * simply do parsing of the input in order to discover what kinds of links\n         * there are and how many.\n         *\n         * Example usage:\n         *\n         *     var autolinker = new Autolinker( {\n         *         urls: true,\n         *         email: true\n         *     } );\n         *\n         *     var matches = autolinker.parse( \"Hello google.com, I am asdf@asdf.com\" );\n         *\n         *     console.log( matches.length );           // 2\n         *     console.log( matches[ 0 ].getType() );   // 'url'\n         *     console.log( matches[ 0 ].getUrl() );    // 'google.com'\n         *     console.log( matches[ 1 ].getType() );   // 'email'\n         *     console.log( matches[ 1 ].getEmail() );  // 'asdf@asdf.com'\n         *\n         * @param {String} textOrHtml The HTML or text to find matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `textOrHtml`.\n         */\n        Autolinker.prototype.parse = function (textOrHtml) {\n            var _this = this;\n            var skipTagNames = ['a', 'style', 'script'], skipTagsStackCount = 0, // used to only Autolink text outside of anchor/script/style tags. We don't want to autolink something that is already linked inside of an <a> tag, for instance\n            matches = [];\n            // Find all matches within the `textOrHtml` (but not matches that are\n            // already nested within <a>, <style> and <script> tags)\n            parseHtml(textOrHtml, {\n                onOpenTag: function (tagName) {\n                    if (skipTagNames.indexOf(tagName) >= 0) {\n                        skipTagsStackCount++;\n                    }\n                },\n                onText: function (text, offset) {\n                    // Only process text nodes that are not within an <a>, <style> or <script> tag\n                    if (skipTagsStackCount === 0) {\n                        // \"Walk around\" common HTML entities. An '&nbsp;' (for example)\n                        // could be at the end of a URL, but we don't want to\n                        // include the trailing '&' in the URL. See issue #76\n                        // TODO: Handle HTML entities separately in parseHtml() and\n                        // don't emit them as \"text\" except for &amp; entities\n                        var htmlCharacterEntitiesRegex = /(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi;\n                        var textSplit = splitAndCapture(text, htmlCharacterEntitiesRegex);\n                        var currentOffset_1 = offset;\n                        textSplit.forEach(function (splitText, i) {\n                            // even number matches are text, odd numbers are html entities\n                            if (i % 2 === 0) {\n                                var textNodeMatches = _this.parseText(splitText, currentOffset_1);\n                                matches.push.apply(matches, textNodeMatches);\n                            }\n                            currentOffset_1 += splitText.length;\n                        });\n                    }\n                },\n                onCloseTag: function (tagName) {\n                    if (skipTagNames.indexOf(tagName) >= 0) {\n                        skipTagsStackCount = Math.max(skipTagsStackCount - 1, 0); // attempt to handle extraneous </a> tags by making sure the stack count never goes below 0\n                    }\n                },\n                onComment: function (offset) { },\n                onDoctype: function (offset) { },\n            });\n            // After we have found all matches, remove subsequent matches that\n            // overlap with a previous match. This can happen for instance with URLs,\n            // where the url 'google.com/#link' would match '#link' as a hashtag.\n            matches = this.compactMatches(matches);\n            // And finally, remove matches for match types that have been turned\n            // off. We needed to have all match types turned on initially so that\n            // things like hashtags could be filtered out if they were really just\n            // part of a URL match (for instance, as a named anchor).\n            matches = this.removeUnwantedMatches(matches);\n            return matches;\n        };\n        /**\n         * After we have found all matches, we need to remove matches that overlap\n         * with a previous match. This can happen for instance with URLs, where the\n         * url 'google.com/#link' would match '#link' as a hashtag. Because the\n         * '#link' part is contained in a larger match that comes before the HashTag\n         * match, we'll remove the HashTag match.\n         *\n         * @private\n         * @param {Autolinker.match.Match[]} matches\n         * @return {Autolinker.match.Match[]}\n         */\n        Autolinker.prototype.compactMatches = function (matches) {\n            // First, the matches need to be sorted in order of offset\n            matches.sort(function (a, b) { return a.getOffset() - b.getOffset(); });\n            for (var i = 0; i < matches.length - 1; i++) {\n                var match = matches[i], offset = match.getOffset(), matchedTextLength = match.getMatchedText().length, endIdx = offset + matchedTextLength;\n                if (i + 1 < matches.length) {\n                    // Remove subsequent matches that equal offset with current match\n                    if (matches[i + 1].getOffset() === offset) {\n                        var removeIdx = matches[i + 1].getMatchedText().length > matchedTextLength ? i : i + 1;\n                        matches.splice(removeIdx, 1);\n                        continue;\n                    }\n                    // Remove subsequent matches that overlap with the current match\n                    if (matches[i + 1].getOffset() < endIdx) {\n                        matches.splice(i + 1, 1);\n                    }\n                }\n            }\n            return matches;\n        };\n        /**\n         * Removes matches for matchers that were turned off in the options. For\n         * example, if {@link #hashtag hashtags} were not to be matched, we'll\n         * remove them from the `matches` array here.\n         *\n         * Note: we *must* use all Matchers on the input string, and then filter\n         * them out later. For example, if the options were `{ url: false, hashtag: true }`,\n         * we wouldn't want to match the text '#link' as a HashTag inside of the text\n         * 'google.com/#link'. The way the algorithm works is that we match the full\n         * URL first (which prevents the accidental HashTag match), and then we'll\n         * simply throw away the URL match.\n         *\n         * @private\n         * @param {Autolinker.match.Match[]} matches The array of matches to remove\n         *   the unwanted matches from. Note: this array is mutated for the\n         *   removals.\n         * @return {Autolinker.match.Match[]} The mutated input `matches` array.\n         */\n        Autolinker.prototype.removeUnwantedMatches = function (matches) {\n            if (!this.hashtag)\n                remove(matches, function (match) { return match.getType() === 'hashtag'; });\n            if (!this.email)\n                remove(matches, function (match) { return match.getType() === 'email'; });\n            if (!this.phone)\n                remove(matches, function (match) { return match.getType() === 'phone'; });\n            if (!this.mention)\n                remove(matches, function (match) { return match.getType() === 'mention'; });\n            if (!this.urls.schemeMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'scheme'; });\n            }\n            if (!this.urls.wwwMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'www'; });\n            }\n            if (!this.urls.tldMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'tld'; });\n            }\n            return matches;\n        };\n        /**\n         * Parses the input `text` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches.\n         *\n         * This method processes a **non-HTML string**, and is used to parse and\n         * match within the text nodes of an HTML string. This method is used\n         * internally by {@link #parse}.\n         *\n         * @private\n         * @param {String} text The text to find matches within (depending on if the\n         *   {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled). This must be a non-HTML string.\n         * @param {Number} [offset=0] The offset of the text node within the\n         *   original string. This is used when parsing with the {@link #parse}\n         *   method to generate correct offsets within the {@link Autolinker.match.Match}\n         *   instances, but may be omitted if calling this method publicly.\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `text`.\n         */\n        Autolinker.prototype.parseText = function (text, offset) {\n            if (offset === void 0) { offset = 0; }\n            offset = offset || 0;\n            var matchers = this.getMatchers(), matches = [];\n            for (var i = 0, numMatchers = matchers.length; i < numMatchers; i++) {\n                var textMatches = matchers[i].parseMatches(text);\n                // Correct the offset of each of the matches. They are originally\n                // the offset of the match within the provided text node, but we\n                // need to correct them to be relative to the original HTML input\n                // string (i.e. the one provided to #parse).\n                for (var j = 0, numTextMatches = textMatches.length; j < numTextMatches; j++) {\n                    textMatches[j].setOffset(offset + textMatches[j].getOffset());\n                }\n                matches.push.apply(matches, textMatches);\n            }\n            return matches;\n        };\n        /**\n         * Automatically links URLs, Email addresses, Phone numbers, Hashtags,\n         * and Mentions (Twitter, Instagram, Soundcloud) found in the given chunk of HTML. Does not link\n         * URLs found within HTML tags.\n         *\n         * For instance, if given the text: `You should go to http-colon-slashslash www.yahoo.com`,\n         * then the result will be `You should go to\n         * &lt;a href=\"http-colon-slashslash www.yahoo.com\"&gt;http-colon-slashslash www.yahoo.com&lt;/a&gt;`\n         *\n         * This method finds the text around any HTML elements in the input\n         * `textOrHtml`, which will be the text that is processed. Any original HTML\n         * elements will be left as-is, as well as the text that is already wrapped\n         * in anchor (&lt;a&gt;) tags.\n         *\n         * @param {String} textOrHtml The HTML or text to autolink matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone}, {@link #hashtag}, and {@link #mention} options are enabled).\n         * @return {String} The HTML, with matches automatically linked.\n         */\n        Autolinker.prototype.link = function (textOrHtml) {\n            if (!textOrHtml) {\n                return \"\";\n            } // handle `null` and `undefined`\n            var matches = this.parse(textOrHtml), newHtml = [], lastIndex = 0;\n            for (var i = 0, len = matches.length; i < len; i++) {\n                var match = matches[i];\n                newHtml.push(textOrHtml.substring(lastIndex, match.getOffset()));\n                newHtml.push(this.createMatchReturnVal(match));\n                lastIndex = match.getOffset() + match.getMatchedText().length;\n            }\n            newHtml.push(textOrHtml.substring(lastIndex)); // handle the text after the last match\n            return newHtml.join('');\n        };\n        /**\n         * Creates the return string value for a given match in the input string.\n         *\n         * This method handles the {@link #replaceFn}, if one was provided.\n         *\n         * @private\n         * @param {Autolinker.match.Match} match The Match object that represents\n         *   the match.\n         * @return {String} The string that the `match` should be replaced with.\n         *   This is usually the anchor tag string, but may be the `matchStr` itself\n         *   if the match is not to be replaced.\n         */\n        Autolinker.prototype.createMatchReturnVal = function (match) {\n            // Handle a custom `replaceFn` being provided\n            var replaceFnResult;\n            if (this.replaceFn) {\n                replaceFnResult = this.replaceFn.call(this.context, match); // Autolinker instance is the context\n            }\n            if (typeof replaceFnResult === 'string') {\n                return replaceFnResult; // `replaceFn` returned a string, use that\n            }\n            else if (replaceFnResult === false) {\n                return match.getMatchedText(); // no replacement for the match\n            }\n            else if (replaceFnResult instanceof HtmlTag) {\n                return replaceFnResult.toAnchorString();\n            }\n            else { // replaceFnResult === true, or no/unknown return value from function\n                // Perform Autolinker's default anchor tag generation\n                var anchorTag = match.buildTag(); // returns an Autolinker.HtmlTag instance\n                return anchorTag.toAnchorString();\n            }\n        };\n        /**\n         * Lazily instantiates and returns the {@link Autolinker.matcher.Matcher}\n         * instances for this Autolinker instance.\n         *\n         * @private\n         * @return {Autolinker.matcher.Matcher[]}\n         */\n        Autolinker.prototype.getMatchers = function () {\n            if (!this.matchers) {\n                var tagBuilder = this.getTagBuilder();\n                var matchers = [\n                    new HashtagMatcher({ tagBuilder: tagBuilder, serviceName: this.hashtag }),\n                    new EmailMatcher({ tagBuilder: tagBuilder }),\n                    new PhoneMatcher({ tagBuilder: tagBuilder }),\n                    new MentionMatcher({ tagBuilder: tagBuilder, serviceName: this.mention }),\n                    new UrlMatcher({ tagBuilder: tagBuilder, stripPrefix: this.stripPrefix, stripTrailingSlash: this.stripTrailingSlash, decodePercentEncoding: this.decodePercentEncoding })\n                ];\n                return (this.matchers = matchers);\n            }\n            else {\n                return this.matchers;\n            }\n        };\n        /**\n         * Returns the {@link #tagBuilder} instance for this Autolinker instance,\n         * lazily instantiating it if it does not yet exist.\n         *\n         * @private\n         * @return {Autolinker.AnchorTagBuilder}\n         */\n        Autolinker.prototype.getTagBuilder = function () {\n            var tagBuilder = this.tagBuilder;\n            if (!tagBuilder) {\n                tagBuilder = this.tagBuilder = new AnchorTagBuilder({\n                    newWindow: this.newWindow,\n                    truncate: this.truncate,\n                    className: this.className\n                });\n            }\n            return tagBuilder;\n        };\n        /**\n         * @static\n         * @property {String} version\n         *\n         * The Autolinker version number in the form major.minor.patch\n         *\n         * Ex: 0.25.1\n         */\n        Autolinker.version = '3.11.0';\n        /**\n         * For backwards compatibility with Autolinker 1.x, the AnchorTagBuilder\n         * class is provided as a static on the Autolinker class.\n         */\n        Autolinker.AnchorTagBuilder = AnchorTagBuilder;\n        /**\n         * For backwards compatibility with Autolinker 1.x, the HtmlTag class is\n         * provided as a static on the Autolinker class.\n         */\n        Autolinker.HtmlTag = HtmlTag;\n        /**\n         * For backwards compatibility with Autolinker 1.x, the Matcher classes are\n         * provided as statics on the Autolinker class.\n         */\n        Autolinker.matcher = {\n            Email: EmailMatcher,\n            Hashtag: HashtagMatcher,\n            Matcher: Matcher,\n            Mention: MentionMatcher,\n            Phone: PhoneMatcher,\n            Url: UrlMatcher\n        };\n        /**\n         * For backwards compatibility with Autolinker 1.x, the Match classes are\n         * provided as statics on the Autolinker class.\n         */\n        Autolinker.match = {\n            Email: EmailMatch,\n            Hashtag: HashtagMatch,\n            Match: Match,\n            Mention: MentionMatch,\n            Phone: PhoneMatch,\n            Url: UrlMatch\n        };\n        return Autolinker;\n    }());\n\n    return Autolinker;\n\n}));\n\n\n//# sourceMappingURL=Autolinker.js.map\n\nexport default tmp.Autolinker;\n","    /**\n     * Representation of <Camera> from KML\n     * @alias KmlCamera\n     * @constructor\n     *\n     * @param {Cartesian3} position camera position\n     * @param {HeadingPitchRoll} headingPitchRoll camera orientation\n     */\n    function KmlCamera(position, headingPitchRoll) {\n        this.position = position;\n        this.headingPitchRoll = headingPitchRoll;\n    }\nexport default KmlCamera;\n","    /**\n     * @alias KmlLookAt\n     * @constructor\n     *\n     * @param {Cartesian3} position camera position\n     * @param {HeadingPitchRange} headingPitchRange camera orientation\n     */\n    function KmlLookAt(position, headingPitchRange) {\n        this.position = position;\n        this.headingPitchRange = headingPitchRange;\n    }\nexport default KmlLookAt;\n","import defined from '../Core/defined.js';\nimport Event from '../Core/Event.js';\n    /**\n     * @alias KmlTour\n     * @constructor\n     *\n     * @param {String} name name parsed from KML\n     * @param {String} id id parsed from KML\n     * @param {Array} playlist array with KMLTourFlyTos, KMLTourWaits and KMLTourSoundCues\n     */\n    function KmlTour(name, id) {\n        /**\n         * Id of kml gx:Tour entry\n         * @type String\n         */\n        this.id = id;\n        /**\n         * Tour name\n         * @type String\n         */\n        this.name = name;\n        /**\n         * Index of current entry from playlist\n         * @type Number\n         */\n        this.playlistIndex = 0;\n        /**\n         * Array of playlist entries\n         * @type Array\n         */\n        this.playlist = [];\n        /**\n         * Event will be called when tour starts to play,\n         * before any playlist entry starts to play.\n         * @type Event\n         */\n        this.tourStart = new Event();\n        /**\n         * Event will be called when all playlist entries are\n         * played, or tour playback being canceled.\n         *\n         * If tour playback was terminated, event callback will\n         * be called with terminated=true parameter.\n         * @type Event\n         */\n        this.tourEnd = new Event();\n        /**\n         * Event will be called when entry from playlist starts to play.\n         *\n         * Event callback will be called with curent entry as first parameter.\n         * @type Event\n         */\n        this.entryStart = new Event();\n        /**\n         * Event will be called when entry from playlist ends to play.\n         *\n         * Event callback will be called with following parameters:\n         * 1. entry - entry\n         * 2. terminated - true if playback was terminated by calling {@link KmlTour#stop}\n         * @type Event\n         */\n        this.entryEnd = new Event();\n\n        this._activeEntries = [];\n    }\n\n    /**\n     * Add entry to this tour playlist.\n     *\n     * @param {KmlTourFlyTo|KmlTourWait} entry an entry to add to the playlist.\n     */\n    KmlTour.prototype.addPlaylistEntry = function(entry) {\n        this.playlist.push(entry);\n    };\n\n    /**\n     * Play this tour.\n     *\n     * @param {Viewer} viewer viewer widget.\n     * @param {Object} [cameraOptions] these options will be merged with {@link Camera#flyTo}\n     * options for FlyTo playlist entries.\n     */\n    KmlTour.prototype.play = function(viewer, cameraOptions) {\n        this.tourStart.raiseEvent();\n\n        var tour = this;\n        playEntry.call(this, viewer, cameraOptions, function(terminated) {\n            tour.playlistIndex = 0;\n            // Stop nonblocking entries\n            if (!terminated) {\n                cancelAllEntries(tour._activeEntries);\n            }\n            tour.tourEnd.raiseEvent(terminated);\n        });\n    };\n\n    /**\n     * Stop curently playing tour.\n     */\n    KmlTour.prototype.stop = function() {\n        cancelAllEntries(this._activeEntries);\n    };\n\n    // Stop all activeEntries.\n    function cancelAllEntries(activeEntries) {\n        for(var entry = activeEntries.pop(); entry !== undefined; entry = activeEntries.pop()) {\n            entry.stop();\n        }\n    }\n\n    // Play playlist entry.\n    // This function is called recursevly with playNext and iterates over all entries from playlist.\n    function playEntry(viewer, cameraOptions, allDone) {\n        var entry = this.playlist[this.playlistIndex];\n        if (entry) {\n            var _playNext = playNext.bind(this, viewer, cameraOptions, allDone);\n            this._activeEntries.push(entry);\n            this.entryStart.raiseEvent(entry);\n            if (entry.blocking) {\n                entry.play(_playNext, viewer.scene.camera, cameraOptions);\n            }\n            else {\n                var tour = this;\n                entry.play(function() {\n                    tour.entryEnd.raiseEvent(entry);\n                    var indx = tour._activeEntries.indexOf(entry);\n                    if (indx >= 0) {\n                        tour._activeEntries.splice(indx, 1);\n                    }\n                });\n                _playNext(viewer, cameraOptions, allDone);\n            }\n        }\n        else if(defined(allDone)) {\n            allDone(false);\n        }\n    }\n\n    // Increment playlistIndex and call playEntry if terminated isn't true.\n    function playNext(viewer, cameraOptions, allDone, terminated) {\n        var entry = this.playlist[this.playlistIndex];\n        this.entryEnd.raiseEvent(entry, terminated);\n\n        if (terminated) {\n            allDone(terminated);\n        }\n        else {\n            var indx = this._activeEntries.indexOf(entry);\n            if (indx >= 0) {\n                this._activeEntries.splice(indx, 1);\n            }\n            this.playlistIndex++;\n            playEntry.call(this, viewer, cameraOptions, allDone);\n        }\n    }\nexport default KmlTour;\n","import BoundingSphere from '../Core/BoundingSphere.js';\nimport combine from '../Core/combine.js';\nimport defined from '../Core/defined.js';\nimport EasingFunction from '../Core/EasingFunction.js';\n    /**\n     * @alias KmlTourFlyTo\n     * @constructor\n     *\n     * @param {Number} duration entry duration\n     * @param {String} flyToMode KML fly to mode: bounce, smooth, etc\n     * @param {KmlCamera|KmlLookAt} view KmlCamera or KmlLookAt\n     */\n    function KmlTourFlyTo(duration, flyToMode, view) {\n        this.type = 'KmlTourFlyTo';\n        this.blocking = true;\n        this.activeCamera = null;\n        this.activeCallback = null;\n\n        this.duration = duration;\n        this.view = view;\n        this.flyToMode = flyToMode;\n    }\n\n    /**\n     * Play this playlist entry\n     *\n     * @param {KmlTourFlyTo~DoneCallback} done function which will be called when playback ends\n     * @param {Camera} camera Cesium camera\n     * @param {Object} [cameraOptions] which will be merged with camera flyTo options. See {@link Camera#flyTo}\n     */\n    KmlTourFlyTo.prototype.play = function(done, camera, cameraOptions) {\n        this.activeCamera = camera;\n        if (defined(done) && done !== null) {\n            var self = this;\n            this.activeCallback = function(terminated) {\n                delete self.activeCallback;\n                delete self.activeCamera;\n                done(defined(terminated) ? false : terminated);\n            };\n        }\n\n        var options = this.getCameraOptions(cameraOptions);\n        if (this.view.headingPitchRoll) {\n            camera.flyTo(options);\n        }\n        else if (this.view.headingPitchRange) {\n            var target = new BoundingSphere(this.view.position);\n            camera.flyToBoundingSphere(target, options);\n        }\n    };\n\n    /**\n     * Stop execution of curent entry. Cancel camera flyTo\n     */\n    KmlTourFlyTo.prototype.stop = function() {\n        if (defined(this.activeCamera)) {\n            this.activeCamera.cancelFlight();\n        }\n        if (defined(this.activeCallback)) {\n            this.activeCallback(true);\n        }\n    };\n\n    /**\n     * Returns options for {@link Camera#flyTo} or {@link Camera#flyToBoundingSphere}\n     * depends on this.view type.\n     *\n     * @param {Object} cameraOptions options to merge with generated. See {@link Camera#flyTo}\n     * @returns {Object} {@link Camera#flyTo} or {@link Camera#flyToBoundingSphere} options\n     */\n    KmlTourFlyTo.prototype.getCameraOptions = function(cameraOptions) {\n        var options = {\n            duration: this.duration\n        };\n\n        if (defined(this.activeCallback)) {\n            options.complete = this.activeCallback;\n        }\n\n        if (this.flyToMode === 'smooth' ) {\n            options.easingFunction = EasingFunction.LINEAR_NONE;\n        }\n\n        if (this.view.headingPitchRoll) {\n            options.destination = this.view.position;\n            options.orientation = this.view.headingPitchRoll;\n        }\n        else if (this.view.headingPitchRange) {\n            options.offset = this.view.headingPitchRange;\n        }\n\n        if (defined(cameraOptions)) {\n            options = combine(options, cameraOptions);\n        }\n        return options;\n    };\n\n    /**\n     * A function that will be executed when the flight completes.\n     * @callback KmlTourFlyTo~DoneCallback\n     *\n     * @param {Boolean} terminated true if {@link KmlTourFlyTo#stop} was\n     * called before entry done playback.\n     */\nexport default KmlTourFlyTo;\n","import defined from '../Core/defined.js';\n    /**\n     * @alias KmlTourWait\n     * @constructor\n     *\n     * @param {Number} duration entry duration\n     */\n    function KmlTourWait(duration) {\n        this.type = 'KmlTourWait';\n        this.blocking = true;\n        this.duration = duration;\n\n        this.timeout = null;\n    }\n\n    /**\n     * Play this playlist entry\n     *\n     * @param {KmlTourWait~DoneCallback} done function which will be called when playback ends\n     */\n    KmlTourWait.prototype.play = function(done) {\n        var self = this;\n        this.activeCallback = done;\n        this.timeout = setTimeout(function() {\n            delete self.activeCallback;\n            done(false);\n        }, this.duration * 1000);\n    };\n\n    /**\n     * Stop execution of curent entry, cancel curent timeout\n     */\n    KmlTourWait.prototype.stop = function() {\n        clearTimeout(this.timeout);\n        if (defined(this.activeCallback)) {\n            this.activeCallback(true);\n        }\n    };\n\n    /**\n     * A function which will be called when playback ends.\n     *\n     * @callback KmlTourWait~DoneCallback\n     * @param {Boolean} terminated true if {@link KmlTourWait#stop} was\n     * called before entry done playback.\n     */\nexport default KmlTourWait;\n","import ArcType from '../Core/ArcType.js';\nimport AssociativeArray from '../Core/AssociativeArray.js';\nimport BoundingRectangle from '../Core/BoundingRectangle.js';\nimport Cartesian2 from '../Core/Cartesian2.js';\nimport Cartesian3 from '../Core/Cartesian3.js';\nimport Cartographic from '../Core/Cartographic.js';\nimport ClockRange from '../Core/ClockRange.js';\nimport ClockStep from '../Core/ClockStep.js';\nimport clone from '../Core/clone.js';\nimport Color from '../Core/Color.js';\nimport createGuid from '../Core/createGuid.js';\nimport Credit from '../Core/Credit.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport getExtensionFromUri from '../Core/getExtensionFromUri.js';\nimport getFilenameFromUri from '../Core/getFilenameFromUri.js';\nimport getTimestamp from '../Core/getTimestamp.js';\nimport HeadingPitchRange from '../Core/HeadingPitchRange.js';\nimport HeadingPitchRoll from '../Core/HeadingPitchRoll.js';\nimport Iso8601 from '../Core/Iso8601.js';\nimport JulianDate from '../Core/JulianDate.js';\nimport CesiumMath from '../Core/Math.js';\nimport NearFarScalar from '../Core/NearFarScalar.js';\nimport objectToQuery from '../Core/objectToQuery.js';\nimport oneTimeWarning from '../Core/oneTimeWarning.js';\nimport PinBuilder from '../Core/PinBuilder.js';\nimport PolygonHierarchy from '../Core/PolygonHierarchy.js';\nimport queryToObject from '../Core/queryToObject.js';\nimport Rectangle from '../Core/Rectangle.js';\nimport Resource from '../Core/Resource.js';\nimport RuntimeError from '../Core/RuntimeError.js';\nimport TimeInterval from '../Core/TimeInterval.js';\nimport TimeIntervalCollection from '../Core/TimeIntervalCollection.js';\nimport HeightReference from '../Scene/HeightReference.js';\nimport HorizontalOrigin from '../Scene/HorizontalOrigin.js';\nimport LabelStyle from '../Scene/LabelStyle.js';\nimport SceneMode from '../Scene/SceneMode.js';\nimport Autolinker from '../ThirdParty/Autolinker.js';\nimport Uri from '../ThirdParty/Uri.js';\nimport when from '../ThirdParty/when.js';\nimport zip from '../ThirdParty/zip.js';\nimport BillboardGraphics from './BillboardGraphics.js';\nimport CompositePositionProperty from './CompositePositionProperty.js';\nimport DataSource from './DataSource.js';\nimport DataSourceClock from './DataSourceClock.js';\nimport Entity from './Entity.js';\nimport EntityCluster from './EntityCluster.js';\nimport EntityCollection from './EntityCollection.js';\nimport KmlCamera from './KmlCamera.js';\nimport KmlLookAt from './KmlLookAt.js';\nimport KmlTour from './KmlTour.js';\nimport KmlTourFlyTo from './KmlTourFlyTo.js';\nimport KmlTourWait from './KmlTourWait.js';\nimport LabelGraphics from './LabelGraphics.js';\nimport PathGraphics from './PathGraphics.js';\nimport PolygonGraphics from './PolygonGraphics.js';\nimport PolylineGraphics from './PolylineGraphics.js';\nimport PositionPropertyArray from './PositionPropertyArray.js';\nimport RectangleGraphics from './RectangleGraphics.js';\nimport ReferenceProperty from './ReferenceProperty.js';\nimport SampledPositionProperty from './SampledPositionProperty.js';\nimport ScaledPositionProperty from './ScaledPositionProperty.js';\nimport TimeIntervalCollectionProperty from './TimeIntervalCollectionProperty.js';\nimport WallGraphics from './WallGraphics.js';\n\n    //This is by no means an exhaustive list of MIME types.\n    //The purpose of this list is to be able to accurately identify content embedded\n    //in KMZ files. Eventually, we can make this configurable by the end user so they can add\n    //there own content types if they have KMZ files that require it.\n    var MimeTypes = {\n        avi : 'video/x-msvideo',\n        bmp : 'image/bmp',\n        bz2 : 'application/x-bzip2',\n        chm : 'application/vnd.ms-htmlhelp',\n        css : 'text/css',\n        csv : 'text/csv',\n        doc : 'application/msword',\n        dvi : 'application/x-dvi',\n        eps : 'application/postscript',\n        flv : 'video/x-flv',\n        gif : 'image/gif',\n        gz : 'application/x-gzip',\n        htm : 'text/html',\n        html : 'text/html',\n        ico : 'image/vnd.microsoft.icon',\n        jnlp : 'application/x-java-jnlp-file',\n        jpeg : 'image/jpeg',\n        jpg : 'image/jpeg',\n        m3u : 'audio/x-mpegurl',\n        m4v : 'video/mp4',\n        mathml : 'application/mathml+xml',\n        mid : 'audio/midi',\n        midi : 'audio/midi',\n        mov : 'video/quicktime',\n        mp3 : 'audio/mpeg',\n        mp4 : 'video/mp4',\n        mp4v : 'video/mp4',\n        mpeg : 'video/mpeg',\n        mpg : 'video/mpeg',\n        odp : 'application/vnd.oasis.opendocument.presentation',\n        ods : 'application/vnd.oasis.opendocument.spreadsheet',\n        odt : 'application/vnd.oasis.opendocument.text',\n        ogg : 'application/ogg',\n        pdf : 'application/pdf',\n        png : 'image/png',\n        pps : 'application/vnd.ms-powerpoint',\n        ppt : 'application/vnd.ms-powerpoint',\n        ps : 'application/postscript',\n        qt : 'video/quicktime',\n        rdf : 'application/rdf+xml',\n        rss : 'application/rss+xml',\n        rtf : 'application/rtf',\n        svg : 'image/svg+xml',\n        swf : 'application/x-shockwave-flash',\n        text : 'text/plain',\n        tif : 'image/tiff',\n        tiff : 'image/tiff',\n        txt : 'text/plain',\n        wav : 'audio/x-wav',\n        wma : 'audio/x-ms-wma',\n        wmv : 'video/x-ms-wmv',\n        xml : 'application/xml',\n        zip : 'application/zip',\n\n        detectFromFilename : function(filename) {\n            var ext = filename.toLowerCase();\n            ext = getExtensionFromUri(ext);\n            return MimeTypes[ext];\n        }\n    };\n\n    var parser;\n    if (typeof DOMParser !== 'undefined') {\n        parser = new DOMParser();\n    }\n\n    var autolinker = new Autolinker({\n        stripPrefix : false,\n        email : false,\n        replaceFn : function(match) {\n            if (!match.protocolUrlMatch) {\n                //Prevent matching of non-explicit urls.\n                //i.e. foo.id won't match but http://foo.id will\n                return false;\n            }\n        }\n    });\n\n    var BILLBOARD_SIZE = 32;\n\n    var BILLBOARD_NEAR_DISTANCE = 2414016;\n    var BILLBOARD_NEAR_RATIO = 1.0;\n    var BILLBOARD_FAR_DISTANCE = 1.6093e+7;\n    var BILLBOARD_FAR_RATIO = 0.1;\n\n    var kmlNamespaces = [null, undefined, 'http://www.opengis.net/kml/2.2', 'http://earth.google.com/kml/2.2', 'http://earth.google.com/kml/2.1', 'http://earth.google.com/kml/2.0'];\n    var gxNamespaces = ['http://www.google.com/kml/ext/2.2'];\n    var atomNamespaces = ['http://www.w3.org/2005/Atom'];\n    var namespaces = {\n        kml : kmlNamespaces,\n        gx : gxNamespaces,\n        atom : atomNamespaces,\n        kmlgx : kmlNamespaces.concat(gxNamespaces)\n    };\n\n    // Ensure Specs/Data/KML/unsupported.kml is kept up to date with these supported types\n    var featureTypes = {\n        Document : processDocument,\n        Folder : processFolder,\n        Placemark : processPlacemark,\n        NetworkLink : processNetworkLink,\n        GroundOverlay : processGroundOverlay,\n        PhotoOverlay : processUnsupportedFeature,\n        ScreenOverlay : processUnsupportedFeature,\n        Tour : processTour\n    };\n\n    function DeferredLoading(dataSource) {\n        this._dataSource = dataSource;\n        this._deferred = when.defer();\n        this._stack = [];\n        this._promises = [];\n        this._timeoutSet = false;\n        this._used = false;\n\n        this._started = 0;\n        this._timeThreshold = 1000; // Initial load is 1 second\n    }\n\n    defineProperties(DeferredLoading.prototype, {\n        dataSource : {\n            get : function() {\n                return this._dataSource;\n            }\n        }\n    });\n\n    DeferredLoading.prototype.addNodes = function(nodes, processingData) {\n        this._stack.push({\n            nodes: nodes,\n            index: 0,\n            processingData: processingData\n        });\n        this._used = true;\n    };\n\n    DeferredLoading.prototype.addPromise = function(promise) {\n        this._promises.push(promise);\n    };\n\n    DeferredLoading.prototype.wait = function() {\n        // Case where we had a non-document/folder as the root\n        var deferred = this._deferred;\n        if (!this._used) {\n            deferred.resolve();\n        }\n\n        return when.join(deferred.promise, when.all(this._promises));\n    };\n\n    DeferredLoading.prototype.process = function() {\n        var isFirstCall = (this._stack.length === 1);\n        if (isFirstCall) {\n            this._started = KmlDataSource._getTimestamp();\n        }\n\n        return this._process(isFirstCall);\n    };\n\n    DeferredLoading.prototype._giveUpTime = function() {\n        if (this._timeoutSet) {\n            // Timeout was already set so just return\n            return;\n        }\n\n        this._timeoutSet = true;\n        this._timeThreshold = 50; // After the first load lower threshold to 0.5 seconds\n        var that = this;\n        setTimeout(function() {\n            that._timeoutSet = false;\n            that._started = KmlDataSource._getTimestamp();\n            that._process(true);\n        }, 0);\n    };\n\n    DeferredLoading.prototype._nextNode = function() {\n        var stack = this._stack;\n        var top = stack[stack.length-1];\n        var index = top.index;\n        var nodes = top.nodes;\n        if (index === nodes.length) {\n            return;\n        }\n        ++top.index;\n\n        return nodes[index];\n    };\n\n    DeferredLoading.prototype._pop = function() {\n        var stack = this._stack;\n        stack.pop();\n\n        // Return false if we are done\n        if (stack.length === 0) {\n            this._deferred.resolve();\n            return false;\n        }\n\n        return true;\n    };\n\n    DeferredLoading.prototype._process = function(isFirstCall) {\n        var dataSource = this.dataSource;\n        var processingData = this._stack[this._stack.length-1].processingData;\n\n        var child = this._nextNode();\n        while(defined(child)) {\n            var featureProcessor = featureTypes[child.localName];\n            if(defined(featureProcessor) &&\n               ((namespaces.kml.indexOf(child.namespaceURI) !== -1) || (namespaces.gx.indexOf(child.namespaceURI) !== -1))) {\n                featureProcessor(dataSource, child, processingData, this);\n\n                // Give up time and continue loading later\n                if (this._timeoutSet || (KmlDataSource._getTimestamp() > (this._started + this._timeThreshold))) {\n                    this._giveUpTime();\n                    return;\n                }\n            }\n\n            child = this._nextNode();\n        }\n\n        // If we are a recursive call from a subfolder, just return so the parent folder can continue processing\n        // If we aren't then make another call to processNodes because there is stuff still left in the queue\n        if (this._pop() && isFirstCall) {\n            this._process(true);\n        }\n    };\n\n    function isZipFile(blob) {\n        var magicBlob = blob.slice(0, Math.min(4, blob.size));\n        var deferred = when.defer();\n        var reader = new FileReader();\n        reader.addEventListener('load', function() {\n            deferred.resolve(new DataView(reader.result).getUint32(0, false) === 0x504b0304);\n        });\n        reader.addEventListener('error', function() {\n            deferred.reject(reader.error);\n        });\n        reader.readAsArrayBuffer(magicBlob);\n        return deferred.promise;\n    }\n\n    function readBlobAsText(blob) {\n        var deferred = when.defer();\n        var reader = new FileReader();\n        reader.addEventListener('load', function() {\n            deferred.resolve(reader.result);\n        });\n        reader.addEventListener('error', function() {\n            deferred.reject(reader.error);\n        });\n        reader.readAsText(blob);\n        return deferred.promise;\n    }\n\n    function insertNamespaces(text) {\n        var namespaceMap = {\n            xsi : 'http://www.w3.org/2001/XMLSchema-instance'\n        };\n        var firstPart, lastPart, reg, declaration;\n\n        for (var key in namespaceMap) {\n            if (namespaceMap.hasOwnProperty(key)) {\n                reg = RegExp('[< ]' + key + ':');\n                declaration = 'xmlns:' + key + '=';\n                if (reg.test(text) && text.indexOf(declaration) === -1) {\n                    if (!defined(firstPart)) {\n                        firstPart = text.substr(0, text.indexOf('<kml') + 4);\n                        lastPart = text.substr(firstPart.length);\n                    }\n                    firstPart += ' ' + declaration + '\"' + namespaceMap[key] + '\"';\n                }\n            }\n        }\n\n        if (defined(firstPart)) {\n            text = firstPart + lastPart;\n        }\n\n        return text;\n    }\n\n    function removeDuplicateNamespaces(text) {\n        var index = text.indexOf('xmlns:');\n        var endDeclaration = text.indexOf('>', index);\n        var namespace, startIndex, endIndex;\n\n        while ((index !== -1) && (index < endDeclaration)) {\n            namespace = text.slice(index, text.indexOf('\\\"', index));\n            startIndex = index;\n            index = text.indexOf(namespace, index + 1);\n            if (index !== -1) {\n                endIndex = text.indexOf('\\\"', (text.indexOf('\\\"', index) + 1));\n                text = text.slice(0, index -1) + text.slice(endIndex + 1, text.length);\n                index = text.indexOf('xmlns:', startIndex - 1);\n            } else {\n                index = text.indexOf('xmlns:', startIndex + 1);\n            }\n        }\n\n        return text;\n    }\n\n    function loadXmlFromZip(entry, uriResolver, deferred) {\n        entry.getData(new zip.TextWriter(), function(text) {\n            text = insertNamespaces(text);\n            text = removeDuplicateNamespaces(text);\n            uriResolver.kml = parser.parseFromString(text, 'application/xml');\n            deferred.resolve();\n        });\n    }\n\n    function loadDataUriFromZip(entry, uriResolver, deferred) {\n        var mimeType = defaultValue(MimeTypes.detectFromFilename(entry.filename), 'application/octet-stream');\n        entry.getData(new zip.Data64URIWriter(mimeType), function(dataUri) {\n            uriResolver[entry.filename] = dataUri;\n            deferred.resolve();\n        });\n    }\n\n    function embedDataUris(div, elementType, attributeName, uriResolver) {\n        var keys = uriResolver.keys;\n        var baseUri = new Uri('.');\n        var elements = div.querySelectorAll(elementType);\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var value = element.getAttribute(attributeName);\n            var uri = new Uri(value).resolve(baseUri).toString();\n            var index = keys.indexOf(uri);\n            if (index !== -1) {\n                var key = keys[index];\n                element.setAttribute(attributeName, uriResolver[key]);\n                if (elementType === 'a' && element.getAttribute('download') === null) {\n                    element.setAttribute('download', key);\n                }\n            }\n        }\n    }\n\n    function applyBasePath(div, elementType, attributeName, sourceResource) {\n        var elements = div.querySelectorAll(elementType);\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var value = element.getAttribute(attributeName);\n            var resource = resolveHref(value, sourceResource);\n            element.setAttribute(attributeName, resource.url);\n        }\n    }\n\n    // an optional context is passed to allow for some malformed kmls (those with multiple geometries with same ids) to still parse\n    // correctly, as they do in Google Earth.\n    function createEntity(node, entityCollection, context) {\n        var id = queryStringAttribute(node, 'id');\n        id = defined(id) && id.length !== 0 ? id : createGuid();\n        if (defined(context)) {\n            id = context + id;\n        }\n\n        // If we have a duplicate ID just generate one.\n        // This isn't valid KML but Google Earth handles this case.\n        var entity = entityCollection.getById(id);\n        if (defined(entity)) {\n            id = createGuid();\n            if (defined(context)) {\n                id = context + id;\n            }\n        }\n\n        entity = entityCollection.add(new Entity({id : id}));\n        if (!defined(entity.kml)) {\n            entity.addProperty('kml');\n            entity.kml = new KmlFeatureData();\n        }\n        return entity;\n    }\n\n    function isExtrudable(altitudeMode, gxAltitudeMode) {\n        return altitudeMode === 'absolute' || altitudeMode === 'relativeToGround' || gxAltitudeMode === 'relativeToSeaFloor';\n    }\n\n    function readCoordinate(value, ellipsoid) {\n        //Google Earth treats empty or missing coordinates as 0.\n        if (!defined(value)) {\n            return Cartesian3.fromDegrees(0, 0, 0, ellipsoid);\n        }\n\n        var digits = value.match(/[^\\s,\\n]+/g);\n        if (!defined(digits)) {\n            return Cartesian3.fromDegrees(0, 0, 0, ellipsoid);\n        }\n\n        var longitude = parseFloat(digits[0]);\n        var latitude = parseFloat(digits[1]);\n        var height = parseFloat(digits[2]);\n\n        longitude = isNaN(longitude) ? 0.0 : longitude;\n        latitude = isNaN(latitude) ? 0.0 : latitude;\n        height = isNaN(height) ? 0.0 : height;\n\n        return Cartesian3.fromDegrees(longitude, latitude, height, ellipsoid);\n    }\n\n    function readCoordinates(element, ellipsoid) {\n        if (!defined(element)) {\n            return undefined;\n        }\n\n        var tuples = element.textContent.match(/[^\\s\\n]+/g);\n        if (!defined(tuples)) {\n            return undefined;\n        }\n\n        var length = tuples.length;\n        var result = new Array(length);\n        var resultIndex = 0;\n        for (var i = 0; i < length; i++) {\n            result[resultIndex++] = readCoordinate(tuples[i], ellipsoid);\n        }\n        return result;\n    }\n\n    function queryNumericAttribute(node, attributeName) {\n        if (!defined(node)) {\n            return undefined;\n        }\n\n        var value = node.getAttribute(attributeName);\n        if (value !== null) {\n            var result = parseFloat(value);\n            return !isNaN(result) ? result : undefined;\n        }\n        return undefined;\n    }\n\n    function queryStringAttribute(node, attributeName) {\n        if (!defined(node)) {\n            return undefined;\n        }\n        var value = node.getAttribute(attributeName);\n        return value !== null ? value : undefined;\n    }\n\n    function queryFirstNode(node, tagName, namespace) {\n        if (!defined(node)) {\n            return undefined;\n        }\n        var childNodes = node.childNodes;\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === tagName && namespace.indexOf(child.namespaceURI) !== -1) {\n                return child;\n            }\n        }\n        return undefined;\n    }\n\n    function queryNodes(node, tagName, namespace) {\n        if (!defined(node)) {\n            return undefined;\n        }\n        var result = [];\n        var childNodes = node.getElementsByTagNameNS('*', tagName);\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === tagName && namespace.indexOf(child.namespaceURI) !== -1) {\n                result.push(child);\n            }\n        }\n        return result;\n    }\n\n    function queryChildNodes(node, tagName, namespace) {\n        if (!defined(node)) {\n            return [];\n        }\n        var result = [];\n        var childNodes = node.childNodes;\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === tagName && namespace.indexOf(child.namespaceURI) !== -1) {\n                result.push(child);\n            }\n        }\n        return result;\n    }\n\n    function queryNumericValue(node, tagName, namespace) {\n        var resultNode = queryFirstNode(node, tagName, namespace);\n        if (defined(resultNode)) {\n            var result = parseFloat(resultNode.textContent);\n            return !isNaN(result) ? result : undefined;\n        }\n        return undefined;\n    }\n\n    function queryStringValue(node, tagName, namespace) {\n        var result = queryFirstNode(node, tagName, namespace);\n        if (defined(result)) {\n            return result.textContent.trim();\n        }\n        return undefined;\n    }\n\n    function queryBooleanValue(node, tagName, namespace) {\n        var result = queryFirstNode(node, tagName, namespace);\n        if (defined(result)) {\n            var value = result.textContent.trim();\n            return value === '1' || /^true$/i.test(value);\n        }\n        return undefined;\n    }\n\n    function resolveHref(href, sourceResource, uriResolver) {\n        if (!defined(href)) {\n            return undefined;\n        }\n\n        var resource;\n        if (defined(uriResolver)) {\n            // To resolve issues with KML sources defined in Windows style paths.\n            href = href.replace(/\\\\/g, '/');\n            var blob = uriResolver[href];\n            if (defined(blob)) {\n                resource = new Resource({\n                    url: blob\n                });\n            } else {\n                // Needed for multiple levels of KML files in a KMZ\n                var baseUri = new Uri(sourceResource.getUrlComponent());\n                var uri = new Uri(href);\n                blob = uriResolver[uri.resolve(baseUri)];\n                if (defined(blob)) {\n                    resource = new Resource({\n                        url: blob\n                    });\n                }\n            }\n        }\n\n        if (!defined(resource)) {\n            resource = sourceResource.getDerivedResource({\n                url: href\n            });\n        }\n\n        return resource;\n    }\n\n    var colorOptions = {\n        maximumRed : undefined,\n        red : undefined,\n        maximumGreen : undefined,\n        green : undefined,\n        maximumBlue : undefined,\n        blue : undefined\n    };\n\n    function parseColorString(value, isRandom) {\n        if (!defined(value) || /^\\s*$/gm.test(value)) {\n            return undefined;\n        }\n\n        if (value[0] === '#') {\n            value = value.substring(1);\n        }\n\n        var alpha = parseInt(value.substring(0, 2), 16) / 255.0;\n        var blue = parseInt(value.substring(2, 4), 16) / 255.0;\n        var green = parseInt(value.substring(4, 6), 16) / 255.0;\n        var red = parseInt(value.substring(6, 8), 16) / 255.0;\n\n        if (!isRandom) {\n            return new Color(red, green, blue, alpha);\n        }\n\n        if (red > 0) {\n            colorOptions.maximumRed = red;\n            colorOptions.red = undefined;\n        } else {\n            colorOptions.maximumRed = undefined;\n            colorOptions.red = 0;\n        }\n        if (green > 0) {\n            colorOptions.maximumGreen = green;\n            colorOptions.green = undefined;\n        } else {\n            colorOptions.maximumGreen = undefined;\n            colorOptions.green = 0;\n        }\n        if (blue > 0) {\n            colorOptions.maximumBlue = blue;\n            colorOptions.blue = undefined;\n        } else {\n            colorOptions.maximumBlue = undefined;\n            colorOptions.blue = 0;\n        }\n        colorOptions.alpha = alpha;\n        return Color.fromRandom(colorOptions);\n    }\n\n    function queryColorValue(node, tagName, namespace) {\n        var value = queryStringValue(node, tagName, namespace);\n        if (!defined(value)) {\n            return undefined;\n        }\n        return parseColorString(value, queryStringValue(node, 'colorMode', namespace) === 'random');\n    }\n\n    function processTimeStamp(featureNode) {\n        var node = queryFirstNode(featureNode, 'TimeStamp', namespaces.kmlgx);\n        var whenString = queryStringValue(node, 'when', namespaces.kmlgx);\n\n        if (!defined(node) || !defined(whenString) || whenString.length === 0) {\n            return undefined;\n        }\n\n        //According to the KML spec, a TimeStamp represents a \"single moment in time\"\n        //However, since Cesium animates much differently than Google Earth, that doesn't\n        //Make much sense here.  Instead, we use the TimeStamp as the moment the feature\n        //comes into existence.  This works much better and gives a similar feel to\n        //GE's experience.\n        var when = JulianDate.fromIso8601(whenString);\n        var result = new TimeIntervalCollection();\n        result.addInterval(new TimeInterval({\n            start : when,\n            stop : Iso8601.MAXIMUM_VALUE\n        }));\n        return result;\n    }\n\n    function processTimeSpan(featureNode) {\n        var node = queryFirstNode(featureNode, 'TimeSpan', namespaces.kmlgx);\n        if (!defined(node)) {\n            return undefined;\n        }\n        var result;\n\n        var beginNode = queryFirstNode(node, 'begin', namespaces.kmlgx);\n        var beginDate = defined(beginNode) ? JulianDate.fromIso8601(beginNode.textContent) : undefined;\n\n        var endNode = queryFirstNode(node, 'end', namespaces.kmlgx);\n        var endDate = defined(endNode) ? JulianDate.fromIso8601(endNode.textContent) : undefined;\n\n        if (defined(beginDate) && defined(endDate)) {\n            if (JulianDate.lessThan(endDate, beginDate)) {\n                var tmp = beginDate;\n                beginDate = endDate;\n                endDate = tmp;\n            }\n            result = new TimeIntervalCollection();\n            result.addInterval(new TimeInterval({\n                start : beginDate,\n                stop : endDate\n            }));\n        } else if (defined(beginDate)) {\n            result = new TimeIntervalCollection();\n            result.addInterval(new TimeInterval({\n                start : beginDate,\n                stop : Iso8601.MAXIMUM_VALUE\n            }));\n        } else if (defined(endDate)) {\n            result = new TimeIntervalCollection();\n            result.addInterval(new TimeInterval({\n                start : Iso8601.MINIMUM_VALUE,\n                stop : endDate\n            }));\n        }\n\n        return result;\n    }\n\n    function createDefaultBillboard() {\n        var billboard = new BillboardGraphics();\n        billboard.width = BILLBOARD_SIZE;\n        billboard.height = BILLBOARD_SIZE;\n        billboard.scaleByDistance = new NearFarScalar(BILLBOARD_NEAR_DISTANCE, BILLBOARD_NEAR_RATIO, BILLBOARD_FAR_DISTANCE, BILLBOARD_FAR_RATIO);\n        billboard.pixelOffsetScaleByDistance = new NearFarScalar(BILLBOARD_NEAR_DISTANCE, BILLBOARD_NEAR_RATIO, BILLBOARD_FAR_DISTANCE, BILLBOARD_FAR_RATIO);\n        return billboard;\n    }\n\n    function createDefaultPolygon() {\n        var polygon = new PolygonGraphics();\n        polygon.outline = true;\n        polygon.outlineColor = Color.WHITE;\n        return polygon;\n    }\n\n    function createDefaultLabel() {\n        var label = new LabelGraphics();\n        label.translucencyByDistance = new NearFarScalar(3000000, 1.0, 5000000, 0.0);\n        label.pixelOffset = new Cartesian2(17, 0);\n        label.horizontalOrigin = HorizontalOrigin.LEFT;\n        label.font = '16px sans-serif';\n        label.style = LabelStyle.FILL_AND_OUTLINE;\n        return label;\n    }\n\n    function getIconHref(iconNode, dataSource, sourceResource, uriResolver, canRefresh) {\n        var href = queryStringValue(iconNode, 'href', namespaces.kml);\n        if (!defined(href) || (href.length === 0)) {\n            return undefined;\n        }\n\n        if (href.indexOf('root://icons/palette-') === 0) {\n            var palette = href.charAt(21);\n\n            // Get the icon number\n            var x = defaultValue(queryNumericValue(iconNode, 'x', namespaces.gx), 0);\n            var y = defaultValue(queryNumericValue(iconNode, 'y', namespaces.gx), 0);\n            x = Math.min(x / 32, 7);\n            y = 7 - Math.min(y / 32, 7);\n            var iconNum = (8 * y) + x;\n\n            href = 'https://maps.google.com/mapfiles/kml/pal' + palette + '/icon' + iconNum + '.png';\n        }\n\n        var hrefResource = resolveHref(href, sourceResource, uriResolver);\n\n        if (canRefresh) {\n            var refreshMode = queryStringValue(iconNode, 'refreshMode', namespaces.kml);\n            var viewRefreshMode = queryStringValue(iconNode, 'viewRefreshMode', namespaces.kml);\n            if (refreshMode === 'onInterval' || refreshMode === 'onExpire') {\n                oneTimeWarning('kml-refreshMode-' + refreshMode, 'KML - Unsupported Icon refreshMode: ' + refreshMode);\n            } else if (viewRefreshMode === 'onStop' || viewRefreshMode === 'onRegion') {\n                oneTimeWarning('kml-refreshMode-' + viewRefreshMode, 'KML - Unsupported Icon viewRefreshMode: ' + viewRefreshMode);\n            }\n\n            var viewBoundScale = defaultValue(queryStringValue(iconNode, 'viewBoundScale', namespaces.kml), 1.0);\n            var defaultViewFormat = (viewRefreshMode === 'onStop') ? 'BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]' : '';\n            var viewFormat = defaultValue(queryStringValue(iconNode, 'viewFormat', namespaces.kml), defaultViewFormat);\n            var httpQuery = queryStringValue(iconNode, 'httpQuery', namespaces.kml);\n            if (defined(viewFormat)) {\n                hrefResource.setQueryParameters(queryToObject(cleanupString(viewFormat)));\n            }\n            if (defined(httpQuery)) {\n                hrefResource.setQueryParameters(queryToObject(cleanupString(httpQuery)));\n            }\n\n            var ellipsoid = dataSource._ellipsoid;\n            processNetworkLinkQueryString(hrefResource, dataSource._camera, dataSource._canvas, viewBoundScale, dataSource._lastCameraView.bbox, ellipsoid);\n\n            return hrefResource;\n        }\n\n        return hrefResource;\n    }\n\n    function processBillboardIcon(dataSource, node, targetEntity, sourceResource, uriResolver) {\n        var scale = queryNumericValue(node, 'scale', namespaces.kml);\n        var heading = queryNumericValue(node, 'heading', namespaces.kml);\n        var color = queryColorValue(node, 'color', namespaces.kml);\n\n        var iconNode = queryFirstNode(node, 'Icon', namespaces.kml);\n        var icon = getIconHref(iconNode, dataSource, sourceResource, uriResolver, false);\n\n        // If icon tags are present but blank, we do not want to show an icon\n        if (defined(iconNode) && !defined(icon)) {\n            icon = false;\n        }\n\n        var x = queryNumericValue(iconNode, 'x', namespaces.gx);\n        var y = queryNumericValue(iconNode, 'y', namespaces.gx);\n        var w = queryNumericValue(iconNode, 'w', namespaces.gx);\n        var h = queryNumericValue(iconNode, 'h', namespaces.gx);\n\n        var hotSpotNode = queryFirstNode(node, 'hotSpot', namespaces.kml);\n        var hotSpotX = queryNumericAttribute(hotSpotNode, 'x');\n        var hotSpotY = queryNumericAttribute(hotSpotNode, 'y');\n        var hotSpotXUnit = queryStringAttribute(hotSpotNode, 'xunits');\n        var hotSpotYUnit = queryStringAttribute(hotSpotNode, 'yunits');\n\n        var billboard = targetEntity.billboard;\n        if (!defined(billboard)) {\n            billboard = createDefaultBillboard();\n            targetEntity.billboard = billboard;\n        }\n\n        billboard.image = icon;\n        billboard.scale = scale;\n        billboard.color = color;\n\n        if (defined(x) || defined(y) || defined(w) || defined(h)) {\n            billboard.imageSubRegion = new BoundingRectangle(x, y, w, h);\n        }\n\n        //GE treats a heading of zero as no heading\n        //You can still point north using a 360 degree angle (or any multiple of 360)\n        if (defined(heading) && heading !== 0) {\n            billboard.rotation = CesiumMath.toRadians(-heading);\n            billboard.alignedAxis = Cartesian3.UNIT_Z;\n        }\n\n        //Hotpot is the KML equivalent of pixel offset\n        //The hotspot origin is the lower left, but we leave\n        //our billboard origin at the center and simply\n        //modify the pixel offset to take this into account\n        scale = defaultValue(scale, 1.0);\n\n        var xOffset;\n        var yOffset;\n        if (defined(hotSpotX)) {\n            if (hotSpotXUnit === 'pixels') {\n                xOffset = -hotSpotX * scale;\n            } else if (hotSpotXUnit === 'insetPixels') {\n                xOffset = (hotSpotX - BILLBOARD_SIZE) * scale;\n            } else if (hotSpotXUnit === 'fraction') {\n                xOffset = -hotSpotX * BILLBOARD_SIZE * scale;\n            }\n            xOffset += BILLBOARD_SIZE * 0.5 * scale;\n        }\n\n        if (defined(hotSpotY)) {\n            if (hotSpotYUnit === 'pixels') {\n                yOffset = hotSpotY * scale;\n            } else if (hotSpotYUnit === 'insetPixels') {\n                yOffset = (-hotSpotY + BILLBOARD_SIZE) * scale;\n            } else if (hotSpotYUnit === 'fraction') {\n                yOffset = hotSpotY * BILLBOARD_SIZE * scale;\n            }\n\n            yOffset -= BILLBOARD_SIZE * 0.5 * scale;\n        }\n\n        if (defined(xOffset) || defined(yOffset)) {\n            billboard.pixelOffset = new Cartesian2(xOffset, yOffset);\n        }\n    }\n\n    function applyStyle(dataSource, styleNode, targetEntity, sourceResource, uriResolver) {\n        for (var i = 0, len = styleNode.childNodes.length; i < len; i++) {\n            var node = styleNode.childNodes.item(i);\n            if (node.localName === 'IconStyle') {\n                processBillboardIcon(dataSource, node, targetEntity, sourceResource, uriResolver);\n            } else if (node.localName === 'LabelStyle') {\n                var label = targetEntity.label;\n                if (!defined(label)) {\n                    label = createDefaultLabel();\n                    targetEntity.label = label;\n                }\n                label.scale = defaultValue(queryNumericValue(node, 'scale', namespaces.kml), label.scale);\n                label.fillColor = defaultValue(queryColorValue(node, 'color', namespaces.kml), label.fillColor);\n                label.text = targetEntity.name;\n            } else if (node.localName === 'LineStyle') {\n                var polyline = targetEntity.polyline;\n                if (!defined(polyline)) {\n                    polyline = new PolylineGraphics();\n                    targetEntity.polyline = polyline;\n                }\n                polyline.width = queryNumericValue(node, 'width', namespaces.kml);\n                polyline.material = queryColorValue(node, 'color', namespaces.kml);\n                if (defined(queryColorValue(node, 'outerColor', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:outerColor', 'KML - gx:outerColor is not supported in a LineStyle');\n                }\n                if (defined(queryNumericValue(node, 'outerWidth', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:outerWidth', 'KML - gx:outerWidth is not supported in a LineStyle');\n                }\n                if (defined(queryNumericValue(node, 'physicalWidth', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:physicalWidth', 'KML - gx:physicalWidth is not supported in a LineStyle');\n                }\n                if (defined(queryBooleanValue(node, 'labelVisibility', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:labelVisibility', 'KML - gx:labelVisibility is not supported in a LineStyle');\n                }\n            } else if (node.localName === 'PolyStyle') {\n                var polygon = targetEntity.polygon;\n                if (!defined(polygon)) {\n                    polygon = createDefaultPolygon();\n                    targetEntity.polygon = polygon;\n                }\n                polygon.material = defaultValue(queryColorValue(node, 'color', namespaces.kml), polygon.material);\n                polygon.fill = defaultValue(queryBooleanValue(node, 'fill', namespaces.kml), polygon.fill);\n                polygon.outline = defaultValue(queryBooleanValue(node, 'outline', namespaces.kml), polygon.outline);\n            } else if (node.localName === 'BalloonStyle') {\n                var bgColor = defaultValue(parseColorString(queryStringValue(node, 'bgColor', namespaces.kml)), Color.WHITE);\n                var textColor = defaultValue(parseColorString(queryStringValue(node, 'textColor', namespaces.kml)), Color.BLACK);\n                var text = queryStringValue(node, 'text', namespaces.kml);\n\n                //This is purely an internal property used in style processing,\n                //it never ends up on the final entity.\n                targetEntity.addProperty('balloonStyle');\n                targetEntity.balloonStyle = {\n                    bgColor : bgColor,\n                    textColor : textColor,\n                    text : text\n                };\n            } else if (node.localName === 'ListStyle') {\n                var listItemType = queryStringValue(node, 'listItemType', namespaces.kml);\n                if (listItemType === 'radioFolder' || listItemType === 'checkOffOnly') {\n                    oneTimeWarning('kml-listStyle-' + listItemType, 'KML - Unsupported ListStyle with listItemType: ' + listItemType);\n                }\n            }\n        }\n    }\n\n    //Processes and merges any inline styles for the provided node into the provided entity.\n    function computeFinalStyle(dataSource, placeMark, styleCollection, sourceResource, uriResolver) {\n        var result = new Entity();\n        var styleEntity;\n\n        //Google earth seems to always use the last inline Style/StyleMap only\n        var styleIndex = -1;\n        var childNodes = placeMark.childNodes;\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === 'Style' || child.localName === 'StyleMap') {\n                styleIndex = q;\n            }\n        }\n\n        if (styleIndex !== -1) {\n            var inlineStyleNode = childNodes[styleIndex];\n            if (inlineStyleNode.localName === 'Style') {\n                applyStyle(dataSource, inlineStyleNode, result, sourceResource, uriResolver);\n            } else { // StyleMap\n                var pairs = queryChildNodes(inlineStyleNode, 'Pair', namespaces.kml);\n                for (var p = 0; p < pairs.length; p++) {\n                    var pair = pairs[p];\n                    var key = queryStringValue(pair, 'key', namespaces.kml);\n                    if (key === 'normal') {\n                        var styleUrl = queryStringValue(pair, 'styleUrl', namespaces.kml);\n                        if (defined(styleUrl)) {\n                            styleEntity = styleCollection.getById(styleUrl);\n                            if (!defined(styleEntity)) {\n                                styleEntity = styleCollection.getById('#' + styleUrl);\n                            }\n                            if (defined(styleEntity)) {\n                                result.merge(styleEntity);\n                            }\n                        } else {\n                            var node = queryFirstNode(pair, 'Style', namespaces.kml);\n                            applyStyle(dataSource, node, result, sourceResource, uriResolver);\n                        }\n                    } else {\n                        oneTimeWarning('kml-styleMap-' + key, 'KML - Unsupported StyleMap key: ' + key);\n                    }\n                }\n            }\n        }\n\n        //Google earth seems to always use the first external style only.\n        var externalStyle = queryStringValue(placeMark, 'styleUrl', namespaces.kml);\n        if (defined(externalStyle)) {\n            var id = externalStyle;\n            if (externalStyle[0] !== '#' && externalStyle.indexOf('#') !== -1) {\n                var tokens = externalStyle.split('#');\n                var uri = tokens[0];\n                var resource = sourceResource.getDerivedResource({\n                    url: uri\n                });\n\n                id = resource.getUrlComponent() + '#' + tokens[1];\n            }\n\n            styleEntity = styleCollection.getById(id);\n            if (!defined(styleEntity)) {\n                styleEntity = styleCollection.getById('#' + id);\n            }\n            if (defined(styleEntity)) {\n                result.merge(styleEntity);\n            }\n        }\n\n        return result;\n    }\n\n    //Asynchronously processes an external style file.\n    function processExternalStyles(dataSource, resource, styleCollection) {\n        return resource.fetchXML().then(function(styleKml) {\n            return processStyles(dataSource, styleKml, styleCollection, resource, true);\n        });\n    }\n\n    //Processes all shared and external styles and stores\n    //their id into the provided styleCollection.\n    //Returns an array of promises that will resolve when\n    //each style is loaded.\n    function processStyles(dataSource, kml, styleCollection, sourceResource, isExternal, uriResolver) {\n        var i;\n        var id;\n        var styleEntity;\n\n        var node;\n        var styleNodes = queryNodes(kml, 'Style', namespaces.kml);\n        if (defined(styleNodes)) {\n            var styleNodesLength = styleNodes.length;\n            for (i = 0; i < styleNodesLength; i++) {\n                node = styleNodes[i];\n                id = queryStringAttribute(node, 'id');\n                if (defined(id)) {\n                    id = '#' + id;\n                    if (isExternal && defined(sourceResource)) {\n                        id = sourceResource.getUrlComponent() + id;\n                    }\n                    if (!defined(styleCollection.getById(id))) {\n                        styleEntity = new Entity({\n                            id : id\n                        });\n                        styleCollection.add(styleEntity);\n                        applyStyle(dataSource, node, styleEntity, sourceResource, uriResolver);\n                    }\n                }\n            }\n        }\n\n        var styleMaps = queryNodes(kml, 'StyleMap', namespaces.kml);\n        if (defined(styleMaps)) {\n            var styleMapsLength = styleMaps.length;\n            for (i = 0; i < styleMapsLength; i++) {\n                var styleMap = styleMaps[i];\n                id = queryStringAttribute(styleMap, 'id');\n                if (defined(id)) {\n                    var pairs = queryChildNodes(styleMap, 'Pair', namespaces.kml);\n                    for (var p = 0; p < pairs.length; p++) {\n                        var pair = pairs[p];\n                        var key = queryStringValue(pair, 'key', namespaces.kml);\n                        if (key === 'normal') {\n                            id = '#' + id;\n                            if (isExternal && defined(sourceResource)) {\n                                id = sourceResource.getUrlComponent() + id;\n                            }\n                            if (!defined(styleCollection.getById(id))) {\n                                styleEntity = styleCollection.getOrCreateEntity(id);\n\n                                var styleUrl = queryStringValue(pair, 'styleUrl', namespaces.kml);\n                                if (defined(styleUrl)) {\n                                    if (styleUrl[0] !== '#') {\n                                        styleUrl = '#' + styleUrl;\n                                    }\n\n                                    if (isExternal && defined(sourceResource)) {\n                                        styleUrl = sourceResource.getUrlComponent() + styleUrl;\n                                    }\n                                    var base = styleCollection.getById(styleUrl);\n\n                                    if (defined(base)) {\n                                        styleEntity.merge(base);\n                                    }\n                                } else {\n                                    node = queryFirstNode(pair, 'Style', namespaces.kml);\n                                    applyStyle(dataSource, node, styleEntity, sourceResource, uriResolver);\n                                }\n                            }\n                        } else {\n                            oneTimeWarning('kml-styleMap-' + key, 'KML - Unsupported StyleMap key: ' + key);\n                        }\n                    }\n                }\n            }\n        }\n\n        var promises = [];\n        var styleUrlNodes = kml.getElementsByTagName('styleUrl');\n        var styleUrlNodesLength = styleUrlNodes.length;\n        for (i = 0; i < styleUrlNodesLength; i++) {\n            var styleReference = styleUrlNodes[i].textContent;\n            if (styleReference[0] !== '#') {\n                //According to the spec, all local styles should start with a #\n                //and everything else is an external style that has a # seperating\n                //the URL of the document and the style.  However, Google Earth\n                //also accepts styleUrls without a # as meaning a local style.\n                var tokens = styleReference.split('#');\n                if (tokens.length === 2) {\n                    var uri = tokens[0];\n                    var resource = sourceResource.getDerivedResource({\n                        url: uri\n                    });\n\n                    promises.push(processExternalStyles(dataSource, resource, styleCollection));\n                }\n            }\n        }\n\n        return promises;\n    }\n\n    function createDropLine(entityCollection, entity, styleEntity) {\n        var entityPosition = new ReferenceProperty(entityCollection, entity.id, ['position']);\n        var surfacePosition = new ScaledPositionProperty(entity.position);\n        entity.polyline = defined(styleEntity.polyline) ? styleEntity.polyline.clone() : new PolylineGraphics();\n        entity.polyline.positions = new PositionPropertyArray([entityPosition, surfacePosition]);\n    }\n\n    function heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode) {\n        if (!defined(altitudeMode) && !defined(gxAltitudeMode) || altitudeMode === 'clampToGround') {\n            return HeightReference.CLAMP_TO_GROUND;\n        }\n\n        if (altitudeMode === 'relativeToGround') {\n            return HeightReference.RELATIVE_TO_GROUND;\n        }\n\n        if (altitudeMode === 'absolute') {\n            return HeightReference.NONE;\n        }\n\n        if (gxAltitudeMode === 'clampToSeaFloor') {\n            oneTimeWarning('kml-gx:altitudeMode-clampToSeaFloor', 'KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround.');\n            return HeightReference.CLAMP_TO_GROUND;\n        }\n\n        if (gxAltitudeMode === 'relativeToSeaFloor') {\n            oneTimeWarning('kml-gx:altitudeMode-relativeToSeaFloor', 'KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround.');\n            return HeightReference.RELATIVE_TO_GROUND;\n        }\n\n        if (defined(altitudeMode)) {\n            oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown <kml:altitudeMode>:' + altitudeMode + ', using <kml:altitudeMode>:CLAMP_TO_GROUND.');\n        } else {\n            oneTimeWarning('kml-gx:altitudeMode-unknown', 'KML - Unknown <gx:altitudeMode>:' + gxAltitudeMode + ', using <kml:altitudeMode>:CLAMP_TO_GROUND.');\n        }\n\n        // Clamp to ground is the default\n        return HeightReference.CLAMP_TO_GROUND;\n    }\n\n    function createPositionPropertyFromAltitudeMode(property, altitudeMode, gxAltitudeMode) {\n        if (gxAltitudeMode === 'relativeToSeaFloor' || altitudeMode === 'absolute' || altitudeMode === 'relativeToGround') {\n            //Just return the ellipsoid referenced property until we support MSL\n            return property;\n        }\n\n        if ((defined(altitudeMode) && altitudeMode !== 'clampToGround') || //\n            (defined(gxAltitudeMode) && gxAltitudeMode !== 'clampToSeaFloor')) {\n            oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + defaultValue(altitudeMode, gxAltitudeMode));\n        }\n\n        // Clamp to ground is the default\n        return new ScaledPositionProperty(property);\n    }\n\n    function createPositionPropertyArrayFromAltitudeMode(properties, altitudeMode, gxAltitudeMode, ellipsoid) {\n        if (!defined(properties)) {\n            return undefined;\n        }\n\n        if (gxAltitudeMode === 'relativeToSeaFloor' || altitudeMode === 'absolute' || altitudeMode === 'relativeToGround') {\n            //Just return the ellipsoid referenced property until we support MSL\n            return properties;\n        }\n\n        if ((defined(altitudeMode) && altitudeMode !== 'clampToGround') || //\n            (defined(gxAltitudeMode) && gxAltitudeMode !== 'clampToSeaFloor')) {\n            oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + defaultValue(altitudeMode, gxAltitudeMode));\n        }\n\n        // Clamp to ground is the default\n        var propertiesLength = properties.length;\n        for (var i = 0; i < propertiesLength; i++) {\n            var property = properties[i];\n            ellipsoid.scaleToGeodeticSurface(property, property);\n        }\n        return properties;\n    }\n\n    function processPositionGraphics(dataSource, entity, styleEntity, heightReference) {\n        var label = entity.label;\n        if (!defined(label)) {\n            label = defined(styleEntity.label) ? styleEntity.label.clone() : createDefaultLabel();\n            entity.label = label;\n        }\n        label.text = entity.name;\n\n        var billboard = entity.billboard;\n        if (!defined(billboard)) {\n            billboard = defined(styleEntity.billboard) ? styleEntity.billboard.clone() : createDefaultBillboard();\n            entity.billboard = billboard;\n        }\n\n        if (!defined(billboard.image)) {\n            billboard.image = dataSource._pinBuilder.fromColor(Color.YELLOW, 64);\n\n        // If there were empty <Icon> tags in the KML, then billboard.image was set to false above\n        // However, in this case, the false value would have been converted to a property afterwards\n        // Thus, we check if billboard.image is defined with value of false\n        } else if (!billboard.image.getValue()) {\n            billboard.image = undefined;\n        }\n\n        var scale = 1.0;\n        if (defined(billboard.scale)) {\n            scale = billboard.scale.getValue();\n            if (scale !== 0) {\n                label.pixelOffset = new Cartesian2((scale * 16) + 1, 0);\n            } else {\n                //Minor tweaks to better match Google Earth.\n                label.pixelOffset = undefined;\n                label.horizontalOrigin = undefined;\n            }\n        }\n\n        if (defined(heightReference) && dataSource._clampToGround) {\n            billboard.heightReference = heightReference;\n            label.heightReference = heightReference;\n        }\n    }\n\n    function processPathGraphics(entity, styleEntity) {\n        var path = entity.path;\n        if (!defined(path)) {\n            path = new PathGraphics();\n            path.leadTime = 0;\n            entity.path = path;\n        }\n\n        var polyline = styleEntity.polyline;\n        if (defined(polyline)) {\n            path.material = polyline.material;\n            path.width = polyline.width;\n        }\n    }\n\n    function processPoint(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var coordinatesString = queryStringValue(geometryNode, 'coordinates', namespaces.kml);\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var ellipsoid = dataSource._ellipsoid;\n        var position = readCoordinate(coordinatesString, ellipsoid);\n\n        entity.position = position;\n        processPositionGraphics(dataSource, entity, styleEntity, heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode));\n\n        if (extrude && isExtrudable(altitudeMode, gxAltitudeMode)) {\n            createDropLine(entityCollection, entity, styleEntity);\n        }\n\n        return true;\n    }\n\n    function processLineStringOrLinearRing(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var coordinatesNode = queryFirstNode(geometryNode, 'coordinates', namespaces.kml);\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var tessellate = queryBooleanValue(geometryNode, 'tessellate', namespaces.kml);\n        var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n        var zIndex = queryNumericValue(geometryNode, 'drawOrder', namespaces.gx);\n\n        var ellipsoid = dataSource._ellipsoid;\n        var coordinates = readCoordinates(coordinatesNode, ellipsoid);\n        var polyline = styleEntity.polyline;\n        if (canExtrude && extrude) {\n            var wall = new WallGraphics();\n            entity.wall = wall;\n            wall.positions = coordinates;\n            var polygon = styleEntity.polygon;\n\n            if (defined(polygon)) {\n                wall.fill = polygon.fill;\n                wall.material = polygon.material;\n            }\n\n            //Always outline walls so they show up in 2D.\n            wall.outline = true;\n            if (defined(polyline)) {\n                wall.outlineColor = defined(polyline.material) ? polyline.material.color : Color.WHITE;\n                wall.outlineWidth = polyline.width;\n            } else if (defined(polygon)) {\n                wall.outlineColor = defined(polygon.material) ? polygon.material.color : Color.WHITE;\n            }\n        } else if (dataSource._clampToGround && !canExtrude && tessellate) {\n            var polylineGraphics = new PolylineGraphics();\n            polylineGraphics.clampToGround = true;\n            entity.polyline = polylineGraphics;\n            polylineGraphics.positions = coordinates;\n            if (defined(polyline)) {\n                polylineGraphics.material = defined(polyline.material) ? polyline.material.color.getValue(Iso8601.MINIMUM_VALUE) : Color.WHITE;\n                polylineGraphics.width = defaultValue(polyline.width, 1.0);\n            } else {\n                polylineGraphics.material = Color.WHITE;\n                polylineGraphics.width = 1.0;\n            }\n            polylineGraphics.zIndex = zIndex;\n        } else {\n            if (defined(zIndex)) {\n                oneTimeWarning('kml-gx:drawOrder', 'KML - gx:drawOrder is not supported in LineStrings when clampToGround is false');\n            }\n\n            polyline = defined(polyline) ? polyline.clone() : new PolylineGraphics();\n            entity.polyline = polyline;\n            polyline.positions = createPositionPropertyArrayFromAltitudeMode(coordinates, altitudeMode, gxAltitudeMode, ellipsoid);\n            if (!tessellate || canExtrude) {\n                polyline.arcType = ArcType.NONE;\n            }\n        }\n\n        return true;\n    }\n\n    function processPolygon(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var outerBoundaryIsNode = queryFirstNode(geometryNode, 'outerBoundaryIs', namespaces.kml);\n        var linearRingNode = queryFirstNode(outerBoundaryIsNode, 'LinearRing', namespaces.kml);\n        var coordinatesNode = queryFirstNode(linearRingNode, 'coordinates', namespaces.kml);\n        var ellipsoid = dataSource._ellipsoid;\n        var coordinates = readCoordinates(coordinatesNode, ellipsoid);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n\n        var polygon = defined(styleEntity.polygon) ? styleEntity.polygon.clone() : createDefaultPolygon();\n\n        var polyline = styleEntity.polyline;\n        if (defined(polyline)) {\n            polygon.outlineColor = defined(polyline.material) ? polyline.material.color : Color.WHITE;\n            polygon.outlineWidth = polyline.width;\n        }\n        entity.polygon = polygon;\n\n        if (canExtrude) {\n            polygon.perPositionHeight = true;\n            polygon.extrudedHeight = extrude ? 0 : undefined;\n        } else if (!dataSource._clampToGround) {\n            polygon.height = 0;\n        }\n\n        if (defined(coordinates)) {\n            var hierarchy = new PolygonHierarchy(coordinates);\n            var innerBoundaryIsNodes = queryChildNodes(geometryNode, 'innerBoundaryIs', namespaces.kml);\n            for (var j = 0; j < innerBoundaryIsNodes.length; j++) {\n                linearRingNode = queryChildNodes(innerBoundaryIsNodes[j], 'LinearRing', namespaces.kml);\n                for (var k = 0; k < linearRingNode.length; k++) {\n                    coordinatesNode = queryFirstNode(linearRingNode[k], 'coordinates', namespaces.kml);\n                    coordinates = readCoordinates(coordinatesNode, ellipsoid);\n                    if (defined(coordinates)) {\n                        hierarchy.holes.push(new PolygonHierarchy(coordinates));\n                    }\n                }\n            }\n            polygon.hierarchy = hierarchy;\n        }\n\n        return true;\n    }\n\n    function processTrack(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var coordNodes = queryChildNodes(geometryNode, 'coord', namespaces.gx);\n        var angleNodes = queryChildNodes(geometryNode, 'angles', namespaces.gx);\n        var timeNodes = queryChildNodes(geometryNode, 'when', namespaces.kml);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n        var ellipsoid = dataSource._ellipsoid;\n\n        if (angleNodes.length > 0) {\n            oneTimeWarning('kml-gx:angles', 'KML - gx:angles are not supported in gx:Tracks');\n        }\n\n        var length = Math.min(coordNodes.length, timeNodes.length);\n        var coordinates = [];\n        var times = [];\n        for (var i = 0; i < length; i++) {\n            var position = readCoordinate(coordNodes[i].textContent, ellipsoid);\n            coordinates.push(position);\n            times.push(JulianDate.fromIso8601(timeNodes[i].textContent));\n        }\n        var property = new SampledPositionProperty();\n        property.addSamples(times, coordinates);\n        entity.position = property;\n        processPositionGraphics(dataSource, entity, styleEntity, heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode));\n        processPathGraphics(entity, styleEntity);\n\n        entity.availability = new TimeIntervalCollection();\n\n        if (timeNodes.length > 0) {\n            entity.availability.addInterval(new TimeInterval({\n                start : times[0],\n                stop : times[times.length - 1]\n            }));\n        }\n\n        if (canExtrude && extrude) {\n            createDropLine(entityCollection, entity, styleEntity);\n        }\n\n        return true;\n    }\n\n    function addToMultiTrack(times, positions, composite, availability, dropShowProperty, extrude, altitudeMode, gxAltitudeMode, includeEndPoints) {\n        var start = times[0];\n        var stop = times[times.length - 1];\n\n        var data = new SampledPositionProperty();\n        data.addSamples(times, positions);\n\n        composite.intervals.addInterval(new TimeInterval({\n            start : start,\n            stop : stop,\n            isStartIncluded : includeEndPoints,\n            isStopIncluded : includeEndPoints,\n            data : createPositionPropertyFromAltitudeMode(data, altitudeMode, gxAltitudeMode)\n        }));\n        availability.addInterval(new TimeInterval({\n            start : start,\n            stop : stop,\n            isStartIncluded : includeEndPoints,\n            isStopIncluded : includeEndPoints\n        }));\n        dropShowProperty.intervals.addInterval(new TimeInterval({\n            start : start,\n            stop : stop,\n            isStartIncluded : includeEndPoints,\n            isStopIncluded : includeEndPoints,\n            data : extrude\n        }));\n    }\n\n    function processMultiTrack(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        // Multitrack options do not work in GE as detailed in the spec,\n        // rather than altitudeMode being at the MultiTrack level,\n        // GE just defers all settings to the underlying track.\n\n        var interpolate = queryBooleanValue(geometryNode, 'interpolate', namespaces.gx);\n        var trackNodes = queryChildNodes(geometryNode, 'Track', namespaces.gx);\n\n        var times;\n        var lastStop;\n        var lastStopPosition;\n        var needDropLine = false;\n        var dropShowProperty = new TimeIntervalCollectionProperty();\n        var availability = new TimeIntervalCollection();\n        var composite = new CompositePositionProperty();\n        var ellipsoid = dataSource._ellipsoid;\n        for (var i = 0, len = trackNodes.length; i < len; i++) {\n            var trackNode = trackNodes[i];\n            var timeNodes = queryChildNodes(trackNode, 'when', namespaces.kml);\n            var coordNodes = queryChildNodes(trackNode, 'coord', namespaces.gx);\n            var altitudeMode = queryStringValue(trackNode, 'altitudeMode', namespaces.kml);\n            var gxAltitudeMode = queryStringValue(trackNode, 'altitudeMode', namespaces.gx);\n            var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n            var extrude = queryBooleanValue(trackNode, 'extrude', namespaces.kml);\n\n            var length = Math.min(coordNodes.length, timeNodes.length);\n\n            var positions = [];\n            times = [];\n            for (var x = 0; x < length; x++) {\n                var position = readCoordinate(coordNodes[x].textContent, ellipsoid);\n                positions.push(position);\n                times.push(JulianDate.fromIso8601(timeNodes[x].textContent));\n            }\n\n            if (interpolate) {\n                //If we are interpolating, then we need to fill in the end of\n                //the last track and the beginning of this one with a sampled\n                //property.  From testing in Google Earth, this property\n                //is never extruded and always absolute.\n                if (defined(lastStop)) {\n                    addToMultiTrack([lastStop, times[0]], [lastStopPosition, positions[0]], composite, availability, dropShowProperty, false, 'absolute', undefined, false);\n                }\n                lastStop = times[length - 1];\n                lastStopPosition = positions[positions.length - 1];\n            }\n\n            addToMultiTrack(times, positions, composite, availability, dropShowProperty, canExtrude && extrude, altitudeMode, gxAltitudeMode, true);\n            needDropLine = needDropLine || (canExtrude && extrude);\n        }\n\n        entity.availability = availability;\n        entity.position = composite;\n        processPositionGraphics(dataSource, entity, styleEntity);\n        processPathGraphics(entity, styleEntity);\n        if (needDropLine) {\n            createDropLine(entityCollection, entity, styleEntity);\n            entity.polyline.show = dropShowProperty;\n        }\n\n        return true;\n    }\n\n    var geometryTypes = {\n        Point : processPoint,\n        LineString : processLineStringOrLinearRing,\n        LinearRing : processLineStringOrLinearRing,\n        Polygon : processPolygon,\n        Track : processTrack,\n        MultiTrack : processMultiTrack,\n        MultiGeometry : processMultiGeometry,\n        Model : processUnsupportedGeometry\n    };\n\n    function processMultiGeometry(dataSource, entityCollection, geometryNode, entity, styleEntity, context) {\n        var childNodes = geometryNode.childNodes;\n        var hasGeometry = false;\n        for (var i = 0, len = childNodes.length; i < len; i++) {\n            var childNode = childNodes.item(i);\n            var geometryProcessor = geometryTypes[childNode.localName];\n            if (defined(geometryProcessor)) {\n                var childEntity = createEntity(childNode, entityCollection, context);\n                childEntity.parent = entity;\n                childEntity.name = entity.name;\n                childEntity.availability = entity.availability;\n                childEntity.description = entity.description;\n                childEntity.kml = entity.kml;\n                if (geometryProcessor(dataSource, entityCollection, childNode, childEntity, styleEntity)) {\n                    hasGeometry = true;\n                }\n            }\n        }\n\n        return hasGeometry;\n    }\n\n    function processUnsupportedGeometry(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        oneTimeWarning('kml-unsupportedGeometry', 'KML - Unsupported geometry: ' + geometryNode.localName);\n        return false;\n    }\n\n    function processExtendedData(node, entity) {\n        var extendedDataNode = queryFirstNode(node, 'ExtendedData', namespaces.kml);\n\n        if (!defined(extendedDataNode)) {\n            return undefined;\n        }\n\n        if (defined(queryFirstNode(extendedDataNode, 'SchemaData', namespaces.kml))) {\n            oneTimeWarning('kml-schemaData', 'KML - SchemaData is unsupported');\n        }\n        if (defined(queryStringAttribute(extendedDataNode, 'xmlns:prefix'))) {\n            oneTimeWarning('kml-extendedData', 'KML - ExtendedData with xmlns:prefix is unsupported');\n        }\n\n        var result = {};\n        var dataNodes = queryChildNodes(extendedDataNode, 'Data', namespaces.kml);\n        if (defined(dataNodes)) {\n            var length = dataNodes.length;\n            for (var i = 0; i < length; i++) {\n                var dataNode = dataNodes[i];\n                var name = queryStringAttribute(dataNode, 'name');\n                if (defined(name)) {\n                    result[name] = {\n                        displayName : queryStringValue(dataNode, 'displayName', namespaces.kml),\n                        value : queryStringValue(dataNode, 'value', namespaces.kml)\n                    };\n                }\n            }\n        }\n        entity.kml.extendedData = result;\n    }\n\n    var scratchDiv;\n    if (typeof document !== 'undefined') {\n        scratchDiv = document.createElement('div');\n    }\n\n    function processDescription(node, entity, styleEntity, uriResolver, sourceResource) {\n        var i;\n        var key;\n        var keys;\n\n        var kmlData = entity.kml;\n        var extendedData = kmlData.extendedData;\n        var description = queryStringValue(node, 'description', namespaces.kml);\n\n        var balloonStyle = defaultValue(entity.balloonStyle, styleEntity.balloonStyle);\n\n        var background = Color.WHITE;\n        var foreground = Color.BLACK;\n        var text = description;\n\n        if (defined(balloonStyle)) {\n            background = defaultValue(balloonStyle.bgColor, Color.WHITE);\n            foreground = defaultValue(balloonStyle.textColor, Color.BLACK);\n            text = defaultValue(balloonStyle.text, description);\n        }\n\n        var value;\n        if (defined(text)) {\n            text = text.replace('$[name]', defaultValue(entity.name, ''));\n            text = text.replace('$[description]', defaultValue(description, ''));\n            text = text.replace('$[address]', defaultValue(kmlData.address, ''));\n            text = text.replace('$[Snippet]', defaultValue(kmlData.snippet, ''));\n            text = text.replace('$[id]', entity.id);\n\n            //While not explicitly defined by the OGC spec, in Google Earth\n            //The appearance of geDirections adds the directions to/from links\n            //We simply replace this string with nothing.\n            text = text.replace('$[geDirections]', '');\n\n            if (defined(extendedData)) {\n                var matches = text.match(/\\$\\[.+?\\]/g);\n                if (matches !== null) {\n                    for (i = 0; i < matches.length; i++) {\n                        var token = matches[i];\n                        var propertyName = token.substr(2, token.length - 3);\n                        var isDisplayName = /\\/displayName$/.test(propertyName);\n                        propertyName = propertyName.replace(/\\/displayName$/, '');\n\n                        value = extendedData[propertyName];\n                        if (defined(value)) {\n                            value = isDisplayName ? value.displayName : value.value;\n                        }\n                        if (defined(value)) {\n                            text = text.replace(token, defaultValue(value, ''));\n                        }\n                    }\n                }\n            }\n        } else if (defined(extendedData)) {\n            //If no description exists, build a table out of the extended data\n            keys = Object.keys(extendedData);\n            if (keys.length > 0) {\n                text = '<table class=\"cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter\"><tbody>';\n                for (i = 0; i < keys.length; i++) {\n                    key = keys[i];\n                    value = extendedData[key];\n                    text += '<tr><th>' + defaultValue(value.displayName, key) + '</th><td>' + defaultValue(value.value, '') + '</td></tr>';\n                }\n                text += '</tbody></table>';\n            }\n        }\n\n        if (!defined(text)) {\n            //No description\n            return;\n        }\n\n        //Turns non-explicit links into clickable links.\n        text = autolinker.link(text);\n\n        //Use a temporary div to manipulate the links\n        //so that they open in a new window.\n        scratchDiv.innerHTML = text;\n        var links = scratchDiv.querySelectorAll('a');\n        for (i = 0; i < links.length; i++) {\n            links[i].setAttribute('target', '_blank');\n        }\n\n        //Rewrite any KMZ embedded urls\n        if (defined(uriResolver) && uriResolver.keys.length > 1) {\n            embedDataUris(scratchDiv, 'a', 'href', uriResolver);\n            embedDataUris(scratchDiv, 'img', 'src', uriResolver);\n        }\n\n        //Make relative urls absolute using the sourceResource\n        applyBasePath(scratchDiv, 'a', 'href', sourceResource);\n        applyBasePath(scratchDiv, 'img', 'src', sourceResource);\n\n        var tmp = '<div class=\"cesium-infoBox-description-lighter\" style=\"';\n        tmp += 'overflow:auto;';\n        tmp += 'word-wrap:break-word;';\n        tmp += 'background-color:' + background.toCssColorString() + ';';\n        tmp += 'color:' + foreground.toCssColorString() + ';';\n        tmp += '\">';\n        tmp += scratchDiv.innerHTML + '</div>';\n        scratchDiv.innerHTML = '';\n\n        //Set the final HTML as the description.\n        entity.description = tmp;\n    }\n\n    function processFeature(dataSource, featureNode, processingData) {\n        var entityCollection = processingData.entityCollection;\n        var parent = processingData.parentEntity;\n        var sourceResource = processingData.sourceResource;\n        var uriResolver = processingData.uriResolver;\n\n        var entity = createEntity(featureNode, entityCollection, processingData.context);\n        var kmlData = entity.kml;\n        var styleEntity = computeFinalStyle(dataSource, featureNode, processingData.styleCollection, sourceResource, uriResolver);\n\n        var name = queryStringValue(featureNode, 'name', namespaces.kml);\n        entity.name = name;\n        entity.parent = parent;\n\n        var availability = processTimeSpan(featureNode);\n        if (!defined(availability)) {\n            availability = processTimeStamp(featureNode);\n        }\n        entity.availability = availability;\n\n        mergeAvailabilityWithParent(entity);\n\n        // Per KML spec \"A Feature is visible only if it and all its ancestors are visible.\"\n        function ancestryIsVisible(parentEntity) {\n            if (!parentEntity) {\n                return true;\n            }\n            return parentEntity.show && ancestryIsVisible(parentEntity.parent);\n        }\n\n        var visibility = queryBooleanValue(featureNode, 'visibility', namespaces.kml);\n        entity.show = ancestryIsVisible(parent) && defaultValue(visibility, true);\n        //var open = queryBooleanValue(featureNode, 'open', namespaces.kml);\n\n        var authorNode = queryFirstNode(featureNode, 'author', namespaces.atom);\n        var author = kmlData.author;\n        author.name = queryStringValue(authorNode, 'name', namespaces.atom);\n        author.uri = queryStringValue(authorNode, 'uri', namespaces.atom);\n        author.email = queryStringValue(authorNode, 'email', namespaces.atom);\n\n        var linkNode = queryFirstNode(featureNode, 'link', namespaces.atom);\n        var link = kmlData.link;\n        link.href = queryStringAttribute(linkNode, 'href');\n        link.hreflang = queryStringAttribute(linkNode, 'hreflang');\n        link.rel = queryStringAttribute(linkNode, 'rel');\n        link.type = queryStringAttribute(linkNode, 'type');\n        link.title = queryStringAttribute(linkNode, 'title');\n        link.length = queryStringAttribute(linkNode, 'length');\n\n        kmlData.address = queryStringValue(featureNode, 'address', namespaces.kml);\n        kmlData.phoneNumber = queryStringValue(featureNode, 'phoneNumber', namespaces.kml);\n        kmlData.snippet = queryStringValue(featureNode, 'Snippet', namespaces.kml);\n\n        processExtendedData(featureNode, entity);\n        processDescription(featureNode, entity, styleEntity, uriResolver, sourceResource);\n\n        var ellipsoid = dataSource._ellipsoid;\n        processLookAt(featureNode, entity, ellipsoid);\n        processCamera(featureNode, entity, ellipsoid);\n\n        if (defined(queryFirstNode(featureNode, 'Region', namespaces.kml))) {\n            oneTimeWarning('kml-region', 'KML - Placemark Regions are unsupported');\n        }\n\n        return {\n            entity : entity,\n            styleEntity : styleEntity\n        };\n    }\n\n    function processDocument(dataSource, node, processingData, deferredLoading) {\n        deferredLoading.addNodes(node.childNodes, processingData);\n        deferredLoading.process();\n    }\n\n    function processFolder(dataSource, node, processingData, deferredLoading) {\n        var r = processFeature(dataSource, node, processingData);\n        var newProcessingData = clone(processingData);\n        newProcessingData.parentEntity = r.entity;\n        processDocument(dataSource, node, newProcessingData, deferredLoading);\n    }\n\n    function processPlacemark(dataSource, placemark, processingData, deferredLoading) {\n        var r = processFeature(dataSource, placemark, processingData);\n        var entity = r.entity;\n        var styleEntity = r.styleEntity;\n\n        var hasGeometry = false;\n        var childNodes = placemark.childNodes;\n        for (var i = 0, len = childNodes.length; i < len && !hasGeometry; i++) {\n            var childNode = childNodes.item(i);\n            var geometryProcessor = geometryTypes[childNode.localName];\n            if (defined(geometryProcessor)) {\n                // pass the placemark entity id as a context for case of defining multiple child entities together to handle case\n                // where some malformed kmls reuse the same id across placemarks, which works in GE, but is not technically to spec.\n                geometryProcessor(dataSource, processingData.entityCollection, childNode, entity, styleEntity, entity.id);\n                hasGeometry = true;\n            }\n        }\n\n        if (!hasGeometry) {\n            entity.merge(styleEntity);\n            processPositionGraphics(dataSource, entity, styleEntity);\n        }\n    }\n\n    var playlistNodeProcessors = {\n        FlyTo: processTourFlyTo,\n        Wait: processTourWait,\n        SoundCue: processTourUnsupportedNode,\n        AnimatedUpdate: processTourUnsupportedNode,\n        TourControl: processTourUnsupportedNode\n    };\n\n    function processTour(dataSource, node, processingData, deferredLoading) {\n        var name = queryStringValue(node, 'name', namespaces.kml);\n        var id = queryStringAttribute(node, 'id');\n        var tour = new KmlTour(name, id);\n\n        var playlistNode = queryFirstNode(node, 'Playlist', namespaces.gx);\n        if(playlistNode) {\n            var ellipsoid = dataSource._ellipsoid;\n            var childNodes = playlistNode.childNodes;\n            for(var i = 0; i < childNodes.length; i++) {\n                var entryNode = childNodes[i];\n                if (entryNode.localName) {\n                    var playlistNodeProcessor = playlistNodeProcessors[entryNode.localName];\n                    if (playlistNodeProcessor) {\n                        playlistNodeProcessor(tour, entryNode, ellipsoid);\n                    }\n                    else {\n                        console.log('Unknown KML Tour playlist entry type ' + entryNode.localName);\n                    }\n                }\n            }\n        }\n\n        if (!defined(dataSource.kmlTours)) {\n            dataSource.kmlTours = [];\n        }\n\n        dataSource.kmlTours.push(tour);\n    }\n\n    function processTourUnsupportedNode(tour, entryNode) {\n        oneTimeWarning('KML Tour unsupported node ' + entryNode.localName);\n    }\n\n    function processTourWait(tour, entryNode) {\n        var duration = queryNumericValue(entryNode, 'duration', namespaces.gx);\n        tour.addPlaylistEntry(new KmlTourWait(duration));\n    }\n\n    function processTourFlyTo(tour, entryNode, ellipsoid) {\n        var duration = queryNumericValue(entryNode, 'duration', namespaces.gx);\n        var flyToMode = queryStringValue(entryNode, 'flyToMode', namespaces.gx);\n\n        var t = {kml: {}};\n\n        processLookAt(entryNode, t, ellipsoid);\n        processCamera(entryNode, t, ellipsoid);\n\n        var view = t.kml.lookAt || t.kml.camera;\n\n        var flyto = new KmlTourFlyTo(duration, flyToMode, view);\n        tour.addPlaylistEntry(flyto);\n    }\n\n    function processCamera(featureNode, entity, ellipsoid) {\n        var camera = queryFirstNode(featureNode, 'Camera', namespaces.kml);\n        if(defined(camera)) {\n            var lon = defaultValue(queryNumericValue(camera, 'longitude', namespaces.kml), 0.0);\n            var lat = defaultValue(queryNumericValue(camera, 'latitude', namespaces.kml), 0.0);\n            var altitude = defaultValue(queryNumericValue(camera, 'altitude', namespaces.kml), 0.0);\n\n            var heading = defaultValue(queryNumericValue(camera, 'heading', namespaces.kml), 0.0);\n            var tilt = defaultValue(queryNumericValue(camera, 'tilt', namespaces.kml), 0.0);\n            var roll = defaultValue(queryNumericValue(camera, 'roll', namespaces.kml), 0.0);\n\n            var position = Cartesian3.fromDegrees(lon, lat, altitude, ellipsoid);\n            var hpr = HeadingPitchRoll.fromDegrees(heading, tilt - 90.0, roll);\n\n            entity.kml.camera = new KmlCamera(position, hpr);\n        }\n    }\n\n    function processLookAt(featureNode, entity, ellipsoid) {\n        var lookAt = queryFirstNode(featureNode, 'LookAt', namespaces.kml);\n        if(defined(lookAt)) {\n            var lon = defaultValue(queryNumericValue(lookAt, 'longitude', namespaces.kml), 0.0);\n            var lat = defaultValue(queryNumericValue(lookAt, 'latitude', namespaces.kml), 0.0);\n            var altitude = defaultValue(queryNumericValue(lookAt, 'altitude', namespaces.kml), 0.0);\n            var heading = queryNumericValue(lookAt, 'heading', namespaces.kml);\n            var tilt = queryNumericValue(lookAt, 'tilt', namespaces.kml);\n            var range = defaultValue(queryNumericValue(lookAt, 'range', namespaces.kml), 0.0);\n\n            tilt = CesiumMath.toRadians(defaultValue(tilt, 0.0));\n            heading = CesiumMath.toRadians(defaultValue(heading, 0.0));\n\n            var hpr = new HeadingPitchRange(heading, tilt - CesiumMath.PI_OVER_TWO, range);\n            var viewPoint = Cartesian3.fromDegrees(lon, lat, altitude, ellipsoid);\n\n            entity.kml.lookAt = new KmlLookAt(viewPoint, hpr);\n        }\n    }\n\n    function processGroundOverlay(dataSource, groundOverlay, processingData, deferredLoading) {\n        var r = processFeature(dataSource, groundOverlay, processingData);\n        var entity = r.entity;\n\n        var geometry;\n        var isLatLonQuad = false;\n\n        var ellipsoid = dataSource._ellipsoid;\n        var positions = readCoordinates(queryFirstNode(groundOverlay, 'LatLonQuad', namespaces.gx), ellipsoid);\n        var zIndex = queryNumericValue(groundOverlay, 'drawOrder', namespaces.kml);\n        if (defined(positions)) {\n            geometry = createDefaultPolygon();\n            geometry.hierarchy = new PolygonHierarchy(positions);\n            geometry.zIndex = zIndex;\n            entity.polygon = geometry;\n            isLatLonQuad = true;\n        } else {\n            geometry = new RectangleGraphics();\n            geometry.zIndex = zIndex;\n            entity.rectangle = geometry;\n\n            var latLonBox = queryFirstNode(groundOverlay, 'LatLonBox', namespaces.kml);\n            if (defined(latLonBox)) {\n                var west = queryNumericValue(latLonBox, 'west', namespaces.kml);\n                var south = queryNumericValue(latLonBox, 'south', namespaces.kml);\n                var east = queryNumericValue(latLonBox, 'east', namespaces.kml);\n                var north = queryNumericValue(latLonBox, 'north', namespaces.kml);\n\n                if (defined(west)) {\n                    west = CesiumMath.negativePiToPi(CesiumMath.toRadians(west));\n                }\n                if (defined(south)) {\n                    south = CesiumMath.clampToLatitudeRange(CesiumMath.toRadians(south));\n                }\n                if (defined(east)) {\n                    east = CesiumMath.negativePiToPi(CesiumMath.toRadians(east));\n                }\n                if (defined(north)) {\n                    north = CesiumMath.clampToLatitudeRange(CesiumMath.toRadians(north));\n                }\n                geometry.coordinates = new Rectangle(west, south, east, north);\n\n                var rotation = queryNumericValue(latLonBox, 'rotation', namespaces.kml);\n                if (defined(rotation)) {\n                    var rotationRadians = CesiumMath.toRadians(rotation);\n                    geometry.rotation = rotationRadians;\n                    geometry.stRotation = rotationRadians;\n                }\n            }\n        }\n\n        var iconNode = queryFirstNode(groundOverlay, 'Icon', namespaces.kml);\n        var href = getIconHref(iconNode, dataSource, processingData.sourceResource, processingData.uriResolver, true);\n        if (defined(href)) {\n            if (isLatLonQuad) {\n                oneTimeWarning('kml-gx:LatLonQuad', 'KML - gx:LatLonQuad Icon does not support texture projection.');\n            }\n            var x = queryNumericValue(iconNode, 'x', namespaces.gx);\n            var y = queryNumericValue(iconNode, 'y', namespaces.gx);\n            var w = queryNumericValue(iconNode, 'w', namespaces.gx);\n            var h = queryNumericValue(iconNode, 'h', namespaces.gx);\n\n            if (defined(x) || defined(y) || defined(w) || defined(h)) {\n                oneTimeWarning('kml-groundOverlay-xywh', 'KML - gx:x, gx:y, gx:w, gx:h aren\\'t supported for GroundOverlays');\n            }\n\n            geometry.material = href;\n            geometry.material.color = queryColorValue(groundOverlay, 'color', namespaces.kml);\n            geometry.material.transparent = true;\n        } else {\n            geometry.material = queryColorValue(groundOverlay, 'color', namespaces.kml);\n        }\n\n        var altitudeMode = queryStringValue(groundOverlay, 'altitudeMode', namespaces.kml);\n\n        if (defined(altitudeMode)) {\n            if (altitudeMode === 'absolute') {\n                //Use height above ellipsoid until we support MSL.\n                geometry.height = queryNumericValue(groundOverlay, 'altitude', namespaces.kml);\n                geometry.zIndex = undefined;\n            } else if (altitudeMode !== 'clampToGround') {\n                oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + altitudeMode);\n            }\n            // else just use the default of 0 until we support 'clampToGround'\n        } else {\n            altitudeMode = queryStringValue(groundOverlay, 'altitudeMode', namespaces.gx);\n            if (altitudeMode === 'relativeToSeaFloor') {\n                oneTimeWarning('kml-altitudeMode-relativeToSeaFloor', 'KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute.');\n                geometry.height = queryNumericValue(groundOverlay, 'altitude', namespaces.kml);\n                geometry.zIndex = undefined;\n            } else if (altitudeMode === 'clampToSeaFloor') {\n                oneTimeWarning('kml-altitudeMode-clampToSeaFloor', 'KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround.');\n            } else if (defined(altitudeMode)) {\n                oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + altitudeMode);\n            }\n        }\n    }\n\n    function processUnsupportedFeature(dataSource, node, processingData, deferredLoading) {\n        dataSource._unsupportedNode.raiseEvent(dataSource, processingData.parentEntity, node, processingData.entityCollection,\n            processingData.styleCollection, processingData.sourceResource, processingData.uriResolver);\n        oneTimeWarning('kml-unsupportedFeature-' + node.nodeName, 'KML - Unsupported feature: ' + node.nodeName);\n    }\n\n    var RefreshMode = {\n        INTERVAL : 0,\n        EXPIRE : 1,\n        STOP : 2\n    };\n\n    function cleanupString(s) {\n        if (!defined(s) || s.length === 0) {\n            return '';\n        }\n\n        var sFirst = s[0];\n        if (sFirst === '&' || sFirst === '?') {\n            s = s.substring(1);\n        }\n\n        return s;\n    }\n\n    var zeroRectangle = new Rectangle();\n    var scratchCartographic = new Cartographic();\n    var scratchCartesian2 = new Cartesian2();\n    var scratchCartesian3 = new Cartesian3();\n\n    function processNetworkLinkQueryString(resource, camera, canvas, viewBoundScale, bbox, ellipsoid) {\n        function fixLatitude(value) {\n            if (value < -CesiumMath.PI_OVER_TWO) {\n                return -CesiumMath.PI_OVER_TWO;\n            } else if (value > CesiumMath.PI_OVER_TWO) {\n                return CesiumMath.PI_OVER_TWO;\n            }\n            return value;\n        }\n\n        function fixLongitude(value) {\n            if (value > CesiumMath.PI) {\n                return value - CesiumMath.TWO_PI;\n            } else if (value < -CesiumMath.PI) {\n                return value + CesiumMath.TWO_PI;\n            }\n\n            return value;\n        }\n\n        var queryString = objectToQuery(resource.queryParameters);\n\n        // objectToQuery escapes [ and ], so fix that\n        queryString = queryString.replace(/%5B/g, '[').replace(/%5D/g, ']');\n\n        if (defined(camera) && camera._mode !== SceneMode.MORPHING) {\n            var centerCartesian;\n            var centerCartographic;\n\n            bbox = defaultValue(bbox, zeroRectangle);\n            if (defined(canvas)) {\n                scratchCartesian2.x = canvas.clientWidth * 0.5;\n                scratchCartesian2.y = canvas.clientHeight * 0.5;\n                centerCartesian = camera.pickEllipsoid(scratchCartesian2, ellipsoid, scratchCartesian3);\n            }\n\n            if (defined(centerCartesian)) {\n                centerCartographic = ellipsoid.cartesianToCartographic(centerCartesian, scratchCartographic);\n            } else {\n                centerCartographic = Rectangle.center(bbox, scratchCartographic);\n                centerCartesian = ellipsoid.cartographicToCartesian(centerCartographic);\n            }\n\n            if (defined(viewBoundScale) && !CesiumMath.equalsEpsilon(viewBoundScale, 1.0, CesiumMath.EPSILON9)) {\n                var newHalfWidth = bbox.width * viewBoundScale * 0.5;\n                var newHalfHeight = bbox.height * viewBoundScale * 0.5;\n                bbox = new Rectangle(fixLongitude(centerCartographic.longitude - newHalfWidth),\n                    fixLatitude(centerCartographic.latitude - newHalfHeight),\n                    fixLongitude(centerCartographic.longitude + newHalfWidth),\n                    fixLatitude(centerCartographic.latitude + newHalfHeight)\n                );\n            }\n\n            queryString = queryString.replace('[bboxWest]', CesiumMath.toDegrees(bbox.west).toString());\n            queryString = queryString.replace('[bboxSouth]', CesiumMath.toDegrees(bbox.south).toString());\n            queryString = queryString.replace('[bboxEast]', CesiumMath.toDegrees(bbox.east).toString());\n            queryString = queryString.replace('[bboxNorth]', CesiumMath.toDegrees(bbox.north).toString());\n\n            var lon = CesiumMath.toDegrees(centerCartographic.longitude).toString();\n            var lat = CesiumMath.toDegrees(centerCartographic.latitude).toString();\n            queryString = queryString.replace('[lookatLon]', lon);\n            queryString = queryString.replace('[lookatLat]', lat);\n            queryString = queryString.replace('[lookatTilt]', CesiumMath.toDegrees(camera.pitch).toString());\n            queryString = queryString.replace('[lookatHeading]', CesiumMath.toDegrees(camera.heading).toString());\n            queryString = queryString.replace('[lookatRange]', Cartesian3.distance(camera.positionWC, centerCartesian));\n            queryString = queryString.replace('[lookatTerrainLon]', lon);\n            queryString = queryString.replace('[lookatTerrainLat]', lat);\n            queryString = queryString.replace('[lookatTerrainAlt]', centerCartographic.height.toString());\n\n            ellipsoid.cartesianToCartographic(camera.positionWC, scratchCartographic);\n            queryString = queryString.replace('[cameraLon]', CesiumMath.toDegrees(scratchCartographic.longitude).toString());\n            queryString = queryString.replace('[cameraLat]', CesiumMath.toDegrees(scratchCartographic.latitude).toString());\n            queryString = queryString.replace('[cameraAlt]', CesiumMath.toDegrees(scratchCartographic.height).toString());\n\n            var frustum = camera.frustum;\n            var aspectRatio = frustum.aspectRatio;\n            var horizFov = '';\n            var vertFov = '';\n            if (defined(aspectRatio)) {\n                var fov = CesiumMath.toDegrees(frustum.fov);\n                if (aspectRatio > 1.0) {\n                    horizFov = fov;\n                    vertFov = fov / aspectRatio;\n                } else {\n                    vertFov = fov;\n                    horizFov = fov * aspectRatio;\n                }\n            }\n            queryString = queryString.replace('[horizFov]', horizFov.toString());\n            queryString = queryString.replace('[vertFov]', vertFov.toString());\n        } else {\n            queryString = queryString.replace('[bboxWest]', '-180');\n            queryString = queryString.replace('[bboxSouth]', '-90');\n            queryString = queryString.replace('[bboxEast]', '180');\n            queryString = queryString.replace('[bboxNorth]', '90');\n\n            queryString = queryString.replace('[lookatLon]', '');\n            queryString = queryString.replace('[lookatLat]', '');\n            queryString = queryString.replace('[lookatRange]', '');\n            queryString = queryString.replace('[lookatTilt]', '');\n            queryString = queryString.replace('[lookatHeading]', '');\n            queryString = queryString.replace('[lookatTerrainLon]', '');\n            queryString = queryString.replace('[lookatTerrainLat]', '');\n            queryString = queryString.replace('[lookatTerrainAlt]', '');\n\n            queryString = queryString.replace('[cameraLon]', '');\n            queryString = queryString.replace('[cameraLat]', '');\n            queryString = queryString.replace('[cameraAlt]', '');\n            queryString = queryString.replace('[horizFov]', '');\n            queryString = queryString.replace('[vertFov]', '');\n        }\n\n        if (defined(canvas)) {\n            queryString = queryString.replace('[horizPixels]', canvas.clientWidth);\n            queryString = queryString.replace('[vertPixels]', canvas.clientHeight);\n        } else {\n            queryString = queryString.replace('[horizPixels]', '');\n            queryString = queryString.replace('[vertPixels]', '');\n        }\n\n        queryString = queryString.replace('[terrainEnabled]', '1');\n        queryString = queryString.replace('[clientVersion]', '1');\n        queryString = queryString.replace('[kmlVersion]', '2.2');\n        queryString = queryString.replace('[clientName]', 'Cesium');\n        queryString = queryString.replace('[language]', 'English');\n\n        resource.setQueryParameters(queryToObject(queryString));\n    }\n\n    function processNetworkLink(dataSource, node, processingData, deferredLoading) {\n        var r = processFeature(dataSource, node, processingData);\n        var networkEntity = r.entity;\n\n        var sourceResource = processingData.sourceResource;\n        var uriResolver = processingData.uriResolver;\n\n        var link = queryFirstNode(node, 'Link', namespaces.kml);\n\n        if (!defined(link)) {\n            link = queryFirstNode(node, 'Url', namespaces.kml);\n        }\n        if (defined(link)) {\n            var href = queryStringValue(link, 'href', namespaces.kml);\n            var viewRefreshMode;\n            var viewBoundScale;\n            if (defined(href)) {\n                var newSourceUri = href;\n                href = resolveHref(href, sourceResource, processingData.uriResolver);\n\n                // We need to pass in the original path if resolveHref returns a data uri because the network link\n                //  references a document in a KMZ archive\n                if (/^data:/.test(href.getUrlComponent())) {\n                    // So if sourceUri isn't the kmz file, then its another kml in the archive, so resolve it\n                    if (!/\\.kmz/i.test(sourceResource.getUrlComponent())) {\n                        newSourceUri = sourceResource.getDerivedResource({\n                            url: newSourceUri\n                        });\n                    }\n                } else {\n                    newSourceUri = href.clone(); // Not a data uri so use the fully qualified uri\n                    viewRefreshMode = queryStringValue(link, 'viewRefreshMode', namespaces.kml);\n                    viewBoundScale = defaultValue(queryStringValue(link, 'viewBoundScale', namespaces.kml), 1.0);\n                    var defaultViewFormat = (viewRefreshMode === 'onStop') ? 'BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]' : '';\n                    var viewFormat = defaultValue(queryStringValue(link, 'viewFormat', namespaces.kml), defaultViewFormat);\n                    var httpQuery = queryStringValue(link, 'httpQuery', namespaces.kml);\n                    if (defined(viewFormat)) {\n                        href.setQueryParameters(queryToObject(cleanupString(viewFormat)));\n                    }\n                    if (defined(httpQuery)) {\n                        href.setQueryParameters(queryToObject(cleanupString(httpQuery)));\n                    }\n\n                    var ellipsoid = dataSource._ellipsoid;\n                    processNetworkLinkQueryString(href, dataSource._camera, dataSource._canvas, viewBoundScale, dataSource._lastCameraView.bbox, ellipsoid);\n                }\n\n                var options = {\n                    sourceUri : newSourceUri,\n                    uriResolver : uriResolver,\n                    context : networkEntity.id\n                };\n                var networkLinkCollection = new EntityCollection();\n                var promise = load(dataSource, networkLinkCollection, href, options).then(function(rootElement) {\n                    var entities = dataSource._entityCollection;\n                    var newEntities = networkLinkCollection.values;\n                    entities.suspendEvents();\n                    for (var i = 0; i < newEntities.length; i++) {\n                        var newEntity = newEntities[i];\n                        if (!defined(newEntity.parent)) {\n                            newEntity.parent = networkEntity;\n                            mergeAvailabilityWithParent(newEntity);\n                        }\n\n                        entities.add(newEntity);\n                    }\n                    entities.resumeEvents();\n\n                    // Add network links to a list if we need they will need to be updated\n                    var refreshMode = queryStringValue(link, 'refreshMode', namespaces.kml);\n                    var refreshInterval = defaultValue(queryNumericValue(link, 'refreshInterval', namespaces.kml), 0);\n                    if ((refreshMode === 'onInterval' && refreshInterval > 0 ) || (refreshMode === 'onExpire') || (viewRefreshMode === 'onStop')) {\n                        var networkLinkControl = queryFirstNode(rootElement, 'NetworkLinkControl', namespaces.kml);\n                        var hasNetworkLinkControl = defined(networkLinkControl);\n\n                        var now = JulianDate.now();\n                        var networkLinkInfo = {\n                            id : createGuid(),\n                            href : href,\n                            cookie : {},\n                            lastUpdated : now,\n                            updating : false,\n                            entity : networkEntity,\n                            viewBoundScale : viewBoundScale,\n                            needsUpdate : false,\n                            cameraUpdateTime : now\n                        };\n\n                        var minRefreshPeriod = 0;\n                        if (hasNetworkLinkControl) {\n                            networkLinkInfo.cookie = queryToObject(defaultValue(queryStringValue(networkLinkControl, 'cookie', namespaces.kml), ''));\n                            minRefreshPeriod = defaultValue(queryNumericValue(networkLinkControl, 'minRefreshPeriod', namespaces.kml), 0);\n                        }\n\n                        if (refreshMode === 'onInterval') {\n                            if (hasNetworkLinkControl) {\n                                refreshInterval = Math.max(minRefreshPeriod, refreshInterval);\n                            }\n                            networkLinkInfo.refreshMode = RefreshMode.INTERVAL;\n                            networkLinkInfo.time = refreshInterval;\n                        } else if (refreshMode === 'onExpire') {\n                            var expires;\n                            if (hasNetworkLinkControl) {\n                                expires = queryStringValue(networkLinkControl, 'expires', namespaces.kml);\n                            }\n                            if (defined(expires)) {\n                                try {\n                                    var date = JulianDate.fromIso8601(expires);\n                                    var diff = JulianDate.secondsDifference(date, now);\n                                    if (diff > 0 && diff < minRefreshPeriod) {\n                                        JulianDate.addSeconds(now, minRefreshPeriod, date);\n                                    }\n                                    networkLinkInfo.refreshMode = RefreshMode.EXPIRE;\n                                    networkLinkInfo.time = date;\n                                } catch (e) {\n                                    oneTimeWarning('kml-refreshMode-onInterval-onExpire', 'KML - NetworkLinkControl expires is not a valid date');\n                                }\n                            } else {\n                                oneTimeWarning('kml-refreshMode-onExpire', 'KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element');\n                            }\n                        } else if (dataSource._camera) { // Only allow onStop refreshes if we have a camera\n                            networkLinkInfo.refreshMode = RefreshMode.STOP;\n                            networkLinkInfo.time = defaultValue(queryNumericValue(link, 'viewRefreshTime', namespaces.kml), 0);\n                        } else {\n                            oneTimeWarning('kml-refrehMode-onStop-noCamera', 'A NetworkLink with viewRefreshMode=onStop requires a camera be passed in when creating the KmlDataSource');\n                        }\n\n                        if (defined(networkLinkInfo.refreshMode)) {\n                            dataSource._networkLinks.set(networkLinkInfo.id, networkLinkInfo);\n                        }\n                    } else if (viewRefreshMode === 'onRegion') {\n                        oneTimeWarning('kml-refrehMode-onRegion', 'KML - Unsupported viewRefreshMode: onRegion');\n                    }\n                }).otherwise(function(error) {\n                    oneTimeWarning('An error occured during loading ' + href.url);\n                    dataSource._error.raiseEvent(dataSource, error);\n                });\n\n                deferredLoading.addPromise(promise);\n            }\n        }\n    }\n\n    function processFeatureNode(dataSource, node, processingData, deferredLoading) {\n        var featureProcessor = featureTypes[node.localName];\n        if (defined(featureProcessor)) {\n            return featureProcessor(dataSource, node, processingData, deferredLoading);\n        }\n\n        return processUnsupportedFeature(dataSource, node, processingData, deferredLoading);\n    }\n\n    function loadKml(dataSource, entityCollection, kml, sourceResource, uriResolver, context) {\n        entityCollection.removeAll();\n\n        var documentElement = kml.documentElement;\n        var document = documentElement.localName === 'Document' ? documentElement : queryFirstNode(documentElement, 'Document', namespaces.kml);\n        var name = queryStringValue(document, 'name', namespaces.kml);\n        if (!defined(name)) {\n            name = getFilenameFromUri(sourceResource.getUrlComponent());\n        }\n\n        // Only set the name from the root document\n        if (!defined(dataSource._name)) {\n            dataSource._name = name;\n        }\n\n        var deferredLoading = new KmlDataSource._DeferredLoading(dataSource);\n        var styleCollection = new EntityCollection(dataSource);\n        return when.all(processStyles(dataSource, kml, styleCollection, sourceResource, false, uriResolver)).then(function() {\n            var element = kml.documentElement;\n            if (element.localName === 'kml') {\n                var childNodes = element.childNodes;\n                for (var i = 0; i < childNodes.length; i++) {\n                    var tmp = childNodes[i];\n                    if (defined(featureTypes[tmp.localName])) {\n                        element = tmp;\n                        break;\n                    }\n                }\n            }\n\n            var processingData = {\n                parentEntity: undefined,\n                entityCollection: entityCollection,\n                styleCollection: styleCollection,\n                sourceResource: sourceResource,\n                uriResolver: uriResolver,\n                context: context\n            };\n\n            entityCollection.suspendEvents();\n            processFeatureNode(dataSource, element, processingData, deferredLoading);\n            entityCollection.resumeEvents();\n\n            return deferredLoading.wait()\n                .then(function() {\n                    return kml.documentElement;\n                });\n        });\n    }\n\n    function loadKmz(dataSource, entityCollection, blob, sourceResource) {\n        var deferred = when.defer();\n        zip.createReader(new zip.BlobReader(blob), function(reader) {\n            reader.getEntries(function(entries) {\n                var promises = [];\n                var uriResolver = {};\n                var docEntry;\n                var docDefer;\n                for (var i = 0; i < entries.length; i++) {\n                    var entry = entries[i];\n                    if (!entry.directory) {\n                        var innerDefer = when.defer();\n                        promises.push(innerDefer.promise);\n                        if (/\\.kml$/i.test(entry.filename)) {\n                            // We use the first KML document we come across\n                            //  https://developers.google.com/kml/documentation/kmzarchives\n                            // Unless we come across a .kml file at the root of the archive because GE does this\n                            if (!defined(docEntry) || !/\\//i.test(entry.filename)) {\n                                if (defined(docEntry)) {\n                                    // We found one at the root so load the initial kml as a data uri\n                                    loadDataUriFromZip(docEntry, uriResolver, docDefer);\n                                }\n                                docEntry = entry;\n                                docDefer = innerDefer;\n                            } else {\n                                // Wasn't the first kml and wasn't at the root\n                                loadDataUriFromZip(entry, uriResolver, innerDefer);\n                            }\n                        } else {\n                            loadDataUriFromZip(entry, uriResolver, innerDefer);\n                        }\n                    }\n                }\n\n                // Now load the root KML document\n                if (defined(docEntry)) {\n                    loadXmlFromZip(docEntry, uriResolver, docDefer);\n                }\n                when.all(promises).then(function() {\n                    reader.close();\n                    if (!defined(uriResolver.kml)) {\n                        deferred.reject(new RuntimeError('KMZ file does not contain a KML document.'));\n                        return;\n                    }\n                    uriResolver.keys = Object.keys(uriResolver);\n                    return loadKml(dataSource, entityCollection, uriResolver.kml, sourceResource, uriResolver);\n                }).then(deferred.resolve).otherwise(deferred.reject);\n            });\n        }, function(e) {\n            deferred.reject(e);\n        });\n\n        return deferred.promise;\n    }\n\n    function load(dataSource, entityCollection, data, options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        var sourceUri = options.sourceUri;\n        var uriResolver = options.uriResolver;\n        var context = options.context;\n\n        var promise = data;\n        if (typeof data === 'string' || (data instanceof Resource)) {\n            data = Resource.createIfNeeded(data);\n            promise = data.fetchBlob();\n            sourceUri = defaultValue(sourceUri, data.clone());\n\n            // Add resource credits to our list of credits to display\n            var resourceCredits = dataSource._resourceCredits;\n            var credits = data.credits;\n            if (defined(credits)) {\n                var length = credits.length;\n                for (var i = 0; i < length; i++) {\n                    resourceCredits.push(credits[i]);\n                }\n            }\n        } else {\n            sourceUri = defaultValue(sourceUri, Resource.DEFAULT.clone());\n        }\n\n        sourceUri = Resource.createIfNeeded(sourceUri);\n\n        return when(promise)\n            .then(function(dataToLoad) {\n                if (dataToLoad instanceof Blob) {\n                    return isZipFile(dataToLoad).then(function(isZip) {\n                        if (isZip) {\n                            return loadKmz(dataSource, entityCollection, dataToLoad, sourceUri);\n                        }\n                        return readBlobAsText(dataToLoad).then(function(text) {\n                            //There's no official way to validate if a parse was successful.\n                            //The following check detects the error on various browsers.\n\n                            //Insert missing namespaces\n                            text = insertNamespaces(text);\n\n                            //Remove Duplicate Namespaces\n                            text = removeDuplicateNamespaces(text);\n\n                            //IE raises an exception\n                            var kml;\n                            var error;\n                            try {\n                                kml = parser.parseFromString(text, 'application/xml');\n                            } catch (e) {\n                                error = e.toString();\n                            }\n\n                            //The parse succeeds on Chrome and Firefox, but the error\n                            //handling is different in each.\n                            if (defined(error) || kml.body || kml.documentElement.tagName === 'parsererror') {\n                                //Firefox has error information as the firstChild nodeValue.\n                                var msg = defined(error) ? error : kml.documentElement.firstChild.nodeValue;\n\n                                //Chrome has it in the body text.\n                                if (!msg) {\n                                    msg = kml.body.innerText;\n                                }\n\n                                //Return the error\n                                throw new RuntimeError(msg);\n                            }\n                            return loadKml(dataSource, entityCollection, kml, sourceUri, uriResolver, context);\n                        });\n                    });\n                }\n                return loadKml(dataSource, entityCollection, dataToLoad, sourceUri, uriResolver, context);\n            })\n            .otherwise(function(error) {\n                dataSource._error.raiseEvent(dataSource, error);\n                console.log(error);\n                return when.reject(error);\n            });\n    }\n\n    /**\n     * A {@link DataSource} which processes Keyhole Markup Language 2.2 (KML).\n     * <p>\n     * KML support in Cesium is incomplete, but a large amount of the standard,\n     * as well as Google's <code>gx</code> extension namespace, is supported. See Github issue\n     * {@link https://github.com/AnalyticalGraphicsInc/cesium/issues/873|#873} for a\n     * detailed list of what is and isn't support. Cesium will also write information to the\n     * console when it encounters most unsupported features.\n     * </p>\n     * <p>\n     * Non visual feature data, such as <code>atom:author</code> and <code>ExtendedData</code>\n     * is exposed via an instance of {@link KmlFeatureData}, which is added to each {@link Entity}\n     * under the <code>kml</code> property.\n     * </p>\n     *\n     * @alias KmlDataSource\n     * @constructor\n     *\n     * @param {Object} options An object with the following properties:\n     * @param {Camera} options.camera The camera that is used for viewRefreshModes and sending camera properties to network links.\n     * @param {Canvas} options.canvas The canvas that is used for sending viewer properties to network links.\n     * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     *\n     * @see {@link http://www.opengeospatial.org/standards/kml/|Open Geospatial Consortium KML Standard}\n     * @see {@link https://developers.google.com/kml/|Google KML Documentation}\n     *\n     * @demo {@link https://sandcastle.cesium.com/index.html?src=KML.html|Cesium Sandcastle KML Demo}\n     *\n     * @example\n     * var viewer = new Cesium.Viewer('cesiumContainer');\n     * viewer.dataSources.add(Cesium.KmlDataSource.load('../../SampleData/facilities.kmz',\n     *      {\n     *           camera: viewer.scene.camera,\n     *           canvas: viewer.scene.canvas\n     *      })\n     * );\n     */\n    function KmlDataSource(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        var camera = options.camera;\n        var canvas = options.canvas;\n\n        \n\n        this._changed = new Event();\n        this._error = new Event();\n        this._loading = new Event();\n        this._refresh = new Event();\n        this._unsupportedNode = new Event();\n\n        this._clock = undefined;\n        this._entityCollection = new EntityCollection(this);\n        this._name = undefined;\n        this._isLoading = false;\n        this._pinBuilder = new PinBuilder();\n        this._networkLinks = new AssociativeArray();\n        this._entityCluster = new EntityCluster();\n\n        this._canvas = canvas;\n        this._camera = camera;\n        this._lastCameraView = {\n            position : defined(camera) ? Cartesian3.clone(camera.positionWC) : undefined,\n            direction : defined(camera) ? Cartesian3.clone(camera.directionWC) : undefined,\n            up : defined(camera) ? Cartesian3.clone(camera.upWC) : undefined,\n            bbox : defined(camera) ? camera.computeViewRectangle() : Rectangle.clone(Rectangle.MAX_VALUE)\n        };\n\n        this._ellipsoid = defaultValue(options.ellipsoid, Ellipsoid.WGS84);\n\n        // User specified credit\n        var credit = options.credit;\n        if (typeof credit === 'string') {\n            credit = new Credit(credit);\n        }\n        this._credit = credit;\n\n        // Create a list of Credit's from the resource that the user can't remove\n        this._resourceCredits = [];\n    }\n\n    /**\n     * Creates a Promise to a new instance loaded with the provided KML data.\n     *\n     * @param {Resource|String|Document|Blob} data A url, parsed KML document, or Blob containing binary KMZ data or a parsed KML document.\n     * @param {Object} options An object with the following properties:\n     * @param {Camera} options.camera The camera that is used for viewRefreshModes and sending camera properties to network links.\n     * @param {Canvas} options.canvas The canvas that is used for sending viewer properties to network links.\n     * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links and other KML network features.\n     * @param {Boolean} [options.clampToGround=false] true if we want the geometry features (Polygons, LineStrings and LinearRings) clamped to the ground.\n     * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     *\n     * @returns {Promise.<KmlDataSource>} A promise that will resolve to a new KmlDataSource instance once the KML is loaded.\n     */\n    KmlDataSource.load = function(data, options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        var dataSource = new KmlDataSource(options);\n        return dataSource.load(data, options);\n    };\n\n    defineProperties(KmlDataSource.prototype, {\n        /**\n         * Gets or sets a human-readable name for this instance.\n         * This will be automatically be set to the KML document name on load.\n         * @memberof KmlDataSource.prototype\n         * @type {String}\n         */\n        name : {\n            get : function() {\n                return this._name;\n            },\n            set : function(value) {\n                if (this._name !== value) {\n                    this._name = value;\n                    this._changed.raiseEvent(this);\n                }\n            }\n        },\n        /**\n         * Gets the clock settings defined by the loaded KML. This represents the total\n         * availability interval for all time-dynamic data. If the KML does not contain\n         * time-dynamic data, this value is undefined.\n         * @memberof KmlDataSource.prototype\n         * @type {DataSourceClock}\n         */\n        clock : {\n            get : function() {\n                return this._clock;\n            }\n        },\n        /**\n         * Gets the collection of {@link Entity} instances.\n         * @memberof KmlDataSource.prototype\n         * @type {EntityCollection}\n         */\n        entities : {\n            get : function() {\n                return this._entityCollection;\n            }\n        },\n        /**\n         * Gets a value indicating if the data source is currently loading data.\n         * @memberof KmlDataSource.prototype\n         * @type {Boolean}\n         */\n        isLoading : {\n            get : function() {\n                return this._isLoading;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the underlying data changes.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        changedEvent : {\n            get : function() {\n                return this._changed;\n            }\n        },\n        /**\n         * Gets an event that will be raised if an error is encountered during processing.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        errorEvent : {\n            get : function() {\n                return this._error;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source either starts or stops loading.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        loadingEvent : {\n            get : function() {\n                return this._loading;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source refreshes a network link.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        refreshEvent : {\n            get : function() {\n                return this._refresh;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source finds an unsupported node type.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        unsupportedNodeEvent : {\n            get : function() {\n                return this._unsupportedNode;\n            }\n        },\n        /**\n         * Gets whether or not this data source should be displayed.\n         * @memberof KmlDataSource.prototype\n         * @type {Boolean}\n         */\n        show : {\n            get : function() {\n                return this._entityCollection.show;\n            },\n            set : function(value) {\n                this._entityCollection.show = value;\n            }\n        },\n\n        /**\n         * Gets or sets the clustering options for this data source. This object can be shared between multiple data sources.\n         *\n         * @memberof KmlDataSource.prototype\n         * @type {EntityCluster}\n         */\n        clustering : {\n            get : function() {\n                return this._entityCluster;\n            },\n            set : function(value) {\n                \n                this._entityCluster = value;\n            }\n        },\n        /**\n         * Gets the credit that will be displayed for the data source\n         * @memberof KmlDataSource.prototype\n         * @type {Credit}\n         */\n        credit : {\n            get : function() {\n                return this._credit;\n            }\n        }\n    });\n\n    /**\n     * Asynchronously loads the provided KML data, replacing any existing data.\n     *\n     * @param {Resource|String|Document|Blob} data A url, parsed KML document, or Blob containing binary KMZ data or a parsed KML document.\n     * @param {Object} [options] An object with the following properties:\n     * @param {Resource|String} [options.sourceUri] Overrides the url to use for resolving relative links and other KML network features.\n     * @param {Boolean} [options.clampToGround=false] true if we want the geometry features (Polygons, LineStrings and LinearRings) clamped to the ground. If true, lines will use corridors so use Entity.corridor instead of Entity.polyline.\n     * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n     *\n     * @returns {Promise.<KmlDataSource>} A promise that will resolve to this instances once the KML is loaded.\n     */\n    KmlDataSource.prototype.load = function(data, options) {\n        \n\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        DataSource.setLoading(this, true);\n\n        var oldName = this._name;\n        this._name = undefined;\n        this._clampToGround = defaultValue(options.clampToGround, false);\n\n        var that = this;\n        return load(this, this._entityCollection, data, options).then(function() {\n            var clock;\n\n            var availability = that._entityCollection.computeAvailability();\n\n            var start = availability.start;\n            var stop = availability.stop;\n            var isMinStart = JulianDate.equals(start, Iso8601.MINIMUM_VALUE);\n            var isMaxStop = JulianDate.equals(stop, Iso8601.MAXIMUM_VALUE);\n            if (!isMinStart || !isMaxStop) {\n                var date;\n\n                //If start is min time just start at midnight this morning, local time\n                if (isMinStart) {\n                    date = new Date();\n                    date.setHours(0, 0, 0, 0);\n                    start = JulianDate.fromDate(date);\n                }\n\n                //If stop is max value just stop at midnight tonight, local time\n                if (isMaxStop) {\n                    date = new Date();\n                    date.setHours(24, 0, 0, 0);\n                    stop = JulianDate.fromDate(date);\n                }\n\n                clock = new DataSourceClock();\n                clock.startTime = start;\n                clock.stopTime = stop;\n                clock.currentTime = JulianDate.clone(start);\n                clock.clockRange = ClockRange.LOOP_STOP;\n                clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n                clock.multiplier = Math.round(Math.min(Math.max(JulianDate.secondsDifference(stop, start) / 60, 1), 3.15569e7));\n            }\n\n            var changed = false;\n            if (clock !== that._clock) {\n                that._clock = clock;\n                changed = true;\n            }\n\n            if (oldName !== that._name) {\n                changed = true;\n            }\n\n            if (changed) {\n                that._changed.raiseEvent(that);\n            }\n\n            DataSource.setLoading(that, false);\n\n            return that;\n        }).otherwise(function(error) {\n            DataSource.setLoading(that, false);\n            that._error.raiseEvent(that, error);\n            console.log(error);\n            return when.reject(error);\n        });\n    };\n\n    function mergeAvailabilityWithParent(child) {\n        var parent = child.parent;\n        if (defined(parent)) {\n            var parentAvailability = parent.availability;\n            if (defined(parentAvailability)) {\n                var childAvailability = child.availability;\n                if (defined(childAvailability)) {\n                    childAvailability.intersect(parentAvailability);\n                } else {\n                    child.availability = parentAvailability;\n                }\n            }\n        }\n    }\n\n    function getNetworkLinkUpdateCallback(dataSource, networkLink, newEntityCollection, networkLinks, processedHref) {\n        return function(rootElement) {\n            if (!networkLinks.contains(networkLink.id)) {\n                // Got into the odd case where a parent network link was updated while a child\n                //  network link update was in flight, so just throw it away.\n                return;\n            }\n            var remove = false;\n            var networkLinkControl = queryFirstNode(rootElement, 'NetworkLinkControl', namespaces.kml);\n            var hasNetworkLinkControl = defined(networkLinkControl);\n\n            var minRefreshPeriod = 0;\n            if (hasNetworkLinkControl) {\n                if (defined(queryFirstNode(networkLinkControl, 'Update', namespaces.kml))) {\n                    oneTimeWarning('kml-networkLinkControl-update', 'KML - NetworkLinkControl updates aren\\'t supported.');\n                    networkLink.updating = false;\n                    networkLinks.remove(networkLink.id);\n                    return;\n                }\n                networkLink.cookie = queryToObject(defaultValue(queryStringValue(networkLinkControl, 'cookie', namespaces.kml), ''));\n                minRefreshPeriod = defaultValue(queryNumericValue(networkLinkControl, 'minRefreshPeriod', namespaces.kml), 0);\n            }\n\n            var now = JulianDate.now();\n            var refreshMode = networkLink.refreshMode;\n            if (refreshMode === RefreshMode.INTERVAL) {\n                if (defined(networkLinkControl)) {\n                    networkLink.time = Math.max(minRefreshPeriod, networkLink.time);\n                }\n            } else if (refreshMode === RefreshMode.EXPIRE) {\n                var expires;\n                if (defined(networkLinkControl)) {\n                    expires = queryStringValue(networkLinkControl, 'expires', namespaces.kml);\n                }\n                if (defined(expires)) {\n                    try {\n                        var date = JulianDate.fromIso8601(expires);\n                        var diff = JulianDate.secondsDifference(date, now);\n                        if (diff > 0 && diff < minRefreshPeriod) {\n                            JulianDate.addSeconds(now, minRefreshPeriod, date);\n                        }\n                        networkLink.time = date;\n                    } catch (e) {\n                        oneTimeWarning('kml-networkLinkControl-expires', 'KML - NetworkLinkControl expires is not a valid date');\n                        remove = true;\n                    }\n                } else {\n                    oneTimeWarning('kml-refreshMode-onExpire', 'KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element');\n                    remove = true;\n                }\n            }\n\n            var networkLinkEntity = networkLink.entity;\n            var entityCollection = dataSource._entityCollection;\n            var newEntities = newEntityCollection.values;\n\n            function removeChildren(entity) {\n                entityCollection.remove(entity);\n                var children = entity._children;\n                var count = children.length;\n                for (var i = 0; i < count; ++i) {\n                    removeChildren(children[i]);\n                }\n            }\n\n            // Remove old entities\n            entityCollection.suspendEvents();\n            var entitiesCopy = entityCollection.values.slice();\n            var i;\n            for (i = 0; i < entitiesCopy.length; ++i) {\n                var entityToRemove = entitiesCopy[i];\n                if (entityToRemove.parent === networkLinkEntity) {\n                    entityToRemove.parent = undefined;\n                    removeChildren(entityToRemove);\n                }\n            }\n            entityCollection.resumeEvents();\n\n            // Add new entities\n            entityCollection.suspendEvents();\n            for (i = 0; i < newEntities.length; i++) {\n                var newEntity = newEntities[i];\n                if (!defined(newEntity.parent)) {\n                    newEntity.parent = networkLinkEntity;\n                    mergeAvailabilityWithParent(newEntity);\n                }\n                entityCollection.add(newEntity);\n            }\n            entityCollection.resumeEvents();\n\n            // No refresh information remove it, otherwise update lastUpdate time\n            if (remove) {\n                networkLinks.remove(networkLink.id);\n            } else {\n                networkLink.lastUpdated = now;\n            }\n\n            var availability = entityCollection.computeAvailability();\n\n            var start = availability.start;\n            var stop = availability.stop;\n            var isMinStart = JulianDate.equals(start, Iso8601.MINIMUM_VALUE);\n            var isMaxStop = JulianDate.equals(stop, Iso8601.MAXIMUM_VALUE);\n            if (!isMinStart || !isMaxStop) {\n                var clock = dataSource._clock;\n\n                if (clock.startTime !== start || clock.stopTime !== stop) {\n                    clock.startTime = start;\n                    clock.stopTime = stop;\n                    dataSource._changed.raiseEvent(dataSource);\n                }\n            }\n\n            networkLink.updating = false;\n            networkLink.needsUpdate = false;\n            dataSource._refresh.raiseEvent(dataSource, processedHref.getUrlComponent(true));\n        };\n    }\n\n    var entitiesToIgnore = new AssociativeArray();\n\n    /**\n     * Updates any NetworkLink that require updating\n     * @function\n     *\n     * @param {JulianDate} time The simulation time.\n     * @returns {Boolean} True if this data source is ready to be displayed at the provided time, false otherwise.\n     */\n    KmlDataSource.prototype.update = function(time) {\n        var networkLinks = this._networkLinks;\n        if (networkLinks.length === 0) {\n            return true;\n        }\n\n        var now = JulianDate.now();\n        var that = this;\n\n        entitiesToIgnore.removeAll();\n\n        function recurseIgnoreEntities(entity) {\n            var children = entity._children;\n            var count = children.length;\n            for (var i = 0; i < count; ++i) {\n                var child = children[i];\n                entitiesToIgnore.set(child.id, child);\n                recurseIgnoreEntities(child);\n            }\n        }\n\n        var cameraViewUpdate = false;\n        var lastCameraView = this._lastCameraView;\n        var camera = this._camera;\n        if (defined(camera) &&\n            !(camera.positionWC.equalsEpsilon(lastCameraView.position, CesiumMath.EPSILON7) &&\n            camera.directionWC.equalsEpsilon(lastCameraView.direction, CesiumMath.EPSILON7) &&\n            camera.upWC.equalsEpsilon(lastCameraView.up, CesiumMath.EPSILON7))) {\n\n            // Camera has changed so update the last view\n            lastCameraView.position = Cartesian3.clone(camera.positionWC);\n            lastCameraView.direction = Cartesian3.clone(camera.directionWC);\n            lastCameraView.up = Cartesian3.clone(camera.upWC);\n            lastCameraView.bbox = camera.computeViewRectangle();\n            cameraViewUpdate = true;\n        }\n\n        var newNetworkLinks = new AssociativeArray();\n        var changed = false;\n        networkLinks.values.forEach(function(networkLink) {\n            var entity = networkLink.entity;\n            if (entitiesToIgnore.contains(entity.id)) {\n                return;\n            }\n\n            if (!networkLink.updating) {\n                var doUpdate = false;\n                if (networkLink.refreshMode === RefreshMode.INTERVAL) {\n                    if (JulianDate.secondsDifference(now, networkLink.lastUpdated) > networkLink.time) {\n                        doUpdate = true;\n                    }\n                }\n                else if (networkLink.refreshMode === RefreshMode.EXPIRE) {\n                    if (JulianDate.greaterThan(now, networkLink.time)) {\n                        doUpdate = true;\n                    }\n\n                } else if (networkLink.refreshMode === RefreshMode.STOP) {\n                    if (cameraViewUpdate) {\n                        networkLink.needsUpdate = true;\n                        networkLink.cameraUpdateTime = now;\n                    }\n\n                    if (networkLink.needsUpdate && JulianDate.secondsDifference(now, networkLink.cameraUpdateTime) >= networkLink.time) {\n                        doUpdate = true;\n                    }\n                }\n\n                if (doUpdate) {\n                    recurseIgnoreEntities(entity);\n                    networkLink.updating = true;\n                    var newEntityCollection = new EntityCollection();\n                    var href = networkLink.href.clone();\n\n                    href.setQueryParameters(networkLink.cookie);\n                    var ellipsoid = defaultValue(that._ellipsoid, Ellipsoid.WGS84);\n                    processNetworkLinkQueryString(href, that._camera, that._canvas, networkLink.viewBoundScale, lastCameraView.bbox, ellipsoid);\n\n                    load(that, newEntityCollection, href, {context : entity.id})\n                        .then(getNetworkLinkUpdateCallback(that, networkLink, newEntityCollection, newNetworkLinks, href))\n                        .otherwise(function(error) {\n                            var msg = 'NetworkLink ' + networkLink.href + ' refresh failed: ' + error;\n                            console.log(msg);\n                            that._error.raiseEvent(that, msg);\n                        });\n                    changed = true;\n                }\n            }\n            newNetworkLinks.set(networkLink.id, networkLink);\n        });\n\n        if (changed) {\n            this._networkLinks = newNetworkLinks;\n            this._changed.raiseEvent(this);\n        }\n\n        return true;\n    };\n\n    /**\n     * Contains KML Feature data loaded into the <code>Entity.kml</code> property by {@link KmlDataSource}.\n     * @alias KmlFeatureData\n     * @constructor\n     */\n    function KmlFeatureData() {\n        /**\n         * Gets the atom syndication format author field.\n         * @type Object\n         */\n        this.author = {\n            /**\n             * Gets the name.\n             * @type String\n             * @alias author.name\n             * @memberof! KmlFeatureData#\n             * @property author.name\n             */\n            name : undefined,\n            /**\n             * Gets the URI.\n             * @type String\n             * @alias author.uri\n             * @memberof! KmlFeatureData#\n             * @property author.uri\n             */\n            uri : undefined,\n            /**\n             * Gets the email.\n             * @type String\n             * @alias author.email\n             * @memberof! KmlFeatureData#\n             * @property author.email\n             */\n            email : undefined\n        };\n\n        /**\n         * Gets the link.\n         * @type Object\n         */\n        this.link = {\n            /**\n             * Gets the href.\n             * @type String\n             * @alias link.href\n             * @memberof! KmlFeatureData#\n             * @property link.href\n             */\n            href : undefined,\n            /**\n             * Gets the language of the linked resource.\n             * @type String\n             * @alias link.hreflang\n             * @memberof! KmlFeatureData#\n             * @property link.hreflang\n             */\n            hreflang : undefined,\n            /**\n             * Gets the link relation.\n             * @type String\n             * @alias link.rel\n             * @memberof! KmlFeatureData#\n             * @property link.rel\n             */\n            rel : undefined,\n            /**\n             * Gets the link type.\n             * @type String\n             * @alias link.type\n             * @memberof! KmlFeatureData#\n             * @property link.type\n             */\n            type : undefined,\n            /**\n             * Gets the link title.\n             * @type String\n             * @alias link.title\n             * @memberof! KmlFeatureData#\n             * @property link.title\n             */\n            title : undefined,\n            /**\n             * Gets the link length.\n             * @type String\n             * @alias link.length\n             * @memberof! KmlFeatureData#\n             * @property link.length\n             */\n            length : undefined\n        };\n\n        /**\n         * Gets the unstructured address field.\n         * @type String\n         */\n        this.address = undefined;\n        /**\n         * Gets the phone number.\n         * @type String\n         */\n        this.phoneNumber = undefined;\n        /**\n         * Gets the snippet.\n         * @type String\n         */\n        this.snippet = undefined;\n        /**\n         * Gets the extended data, parsed into a JSON object.\n         * Currently only the <code>Data</code> property is supported.\n         * <code>SchemaData</code> and custom data are ignored.\n         * @type String\n         */\n        this.extendedData = undefined;\n    }\n\n    // For testing\n    KmlDataSource._DeferredLoading = DeferredLoading;\n    KmlDataSource._getTimestamp = getTimestamp;\n\nexport default KmlDataSource;\n"],"sourceRoot":""}